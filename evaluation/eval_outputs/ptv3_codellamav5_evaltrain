Processing 0th question: What is the total number of credits earned by students in each program? on database: advising
Generation: SELECT {program.name, program.program_id}, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY {} ORDER BY total_credits DESC NULLS LAST

Error executing query: SELECT {program.name, program.program_id}, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY {} ORDER BY total_credits DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {program.name, program.program_id}, SUM(student.total...
               ^

[SQL: SELECT {program.name, program.program_id}, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY {} ORDER BY total_credits DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
0: Exact Match: False, Subset Match: False


Processing 1th question: Which flight has the shortest duration between departure and arrival times? Convert to integer minutes. on database: atis
Generation: SELECT {flight.flight_id, flight.flight_number}, (arrival_time - departure_time) / 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1

Error executing query: SELECT {flight.flight_id, flight.flight_number}, (arrival_time - departure_time) / 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {flight.flight_id, flight.flight_number}, (arrival_ti...
               ^

[SQL: SELECT {flight.flight_id, flight.flight_number}, (arrival_time - departure_time) / 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
1: Exact Match: False, Subset Match: False


Processing 2th question: Which airports have the shortest minimum connect time, sorted in ascending order? Show the minimum connect time. on database: atis
Generation: SELECT {airport.airport_name, airport.airport_code}, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST

Error executing query: SELECT {airport.airport_name, airport.airport_code}, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {airport.airport_name, airport.airport_code}, airport...
               ^

[SQL: SELECT {airport.airport_name, airport.airport_code}, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
2: Exact Match: False, Subset Match: False


Processing 3th question: What are the names of all the courses offered by the department of Computer Science? on database: advising
Generation: SELECT name FROM course WHERE department = 'Computer Science'


Generated Query Results (Normalized):
                               name
0             Distributed Databases
1  Introduction to Computer Science

Gold Query Results (Normalized):
                               name
0             Distributed Databases
1  Introduction to Computer Science
3: Exact Match: True, Subset Match: True


Processing 4th question: Please provide a list of business names in New York and their average ratings ordered by the highest average rating first. on database: yelp
Generation: SELECT {business.name, business.business_id}, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%New York%' GROUP BY {} ORDER BY average_rating DESC NULLS LAST

Error executing query: SELECT {business.name, business.business_id}, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%New York%' GROUP BY {} ORDER BY average_rating DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {business.name, business.business_id}, AVG(review.rat...
               ^

[SQL: SELECT {business.name, business.business_id}, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%%New York%%' GROUP BY {} ORDER BY average_rating DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
4: Exact Match: False, Subset Match: False


Processing 5th question: What is the average length of rivers in each country? on database: geography
Generation: SELECT river.country_name, AVG(river.length) AS average_length FROM river GROUP BY river.country_name ORDER BY average_length DESC NULLS LAST


Generated Query Results (Normalized):
   average_length   country_name
0           100.0          Italy
1           200.0  United States
2           300.0          China
3           400.0         Canada
4           500.0         Brazil
5           600.0        Vietnam
6           800.0        Germany
7           800.0         Russia
8          1000.0          Egypt

Gold Query Results (Normalized):
   average_length   country_name
0           100.0          Italy
1           200.0  United States
2           300.0          China
3           400.0         Canada
4           500.0         Brazil
5           600.0        Vietnam
6           800.0        Germany
7           800.0         Russia
8          1000.0          Egypt
5: Exact Match: True, Subset Match: True


Processing 6th question: How long has it been in days since the last admitted student? Give the answer as an integer. on database: advising
Generation: SELECT CAST(CURRENT_DATE - student.admit_term AS INTEGER) AS days_since_last_admission FROM student ORDER BY student.admit_term DESC LIMIT 1


Generated Query Results (Normalized):
   days_since_last_admission
0                       2159

Gold Query Results (Normalized):
   days_since_last_admission
0                       2159
6: Exact Match: True, Subset Match: True


Processing 7th question: What are the top 2 most frequently used device types for user sessions and their respective counts? on database: ewallet
Generation: SELECT device_type, COUNT(*) AS count FROM consumer_div.user_sessions GROUP BY device_type ORDER BY count DESC LIMIT 2


Generated Query Results (Normalized):
   count device_type
0      8  mobile_app
1     15     web_app

Gold Query Results (Normalized):
   count device_type
0      8  mobile_app
1     15     web_app
7: Exact Match: True, Subset Match: True


Processing 8th question: Which flights operate on Mondays and Wednesdays? Give me the relevant flight numbers on database: atis
Generation: SELECT flight.flight_number FROM flight WHERE flight.flight_days ILIKE '%Monday%' INTERSECT SELECT flight.flight_number FROM flight WHERE flight.flight_days ILIKE '%Wednesday%'

Generated query returned no results.
8: Exact Match: False, Subset Match: False


Processing 9th question: Which rivers traverse at least 3 cities/landmarks? on database: geography
Generation: SELECT river.river_name FROM river WHERE river.traverse ILIKE '%(%)'

Generated query returned no results.
9: Exact Match: False, Subset Match: False


Processing 10th question: What is the ratio of the total number of publications to the total number of keywords within each domain ID? Show all domain IDs. on database: academic
Generation: SELECT domain.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS ratio FROM domain JOIN domain_publication ON domain.did = domain_publication.did JOIN domain_keyword ON domain.did = domain_keyword.did GROUP BY domain.did ORDER BY ratio DESC NULLS LAST


Generated Query Results (Normalized):
   did  ratio
0    1    1.0
1    2    1.0

Gold Query Results (Normalized):
   did  ratio
0    1    1.0
1    2    1.0
10: Exact Match: True, Subset Match: True


Processing 11th question: What are the top 3 most frequently used coupon codes? Return the coupon code, total number of redemptions, and total amount redeemed. on database: ewallet
Generation: SELECT c.code, COUNT(*) AS total_redemptions, SUM(t.amount) AS total_amount_redeemed FROM consumer_div.coupons c JOIN consumer_div.wallet_transactions_daily t ON c.cid = t.coupon_id GROUP BY c.code ORDER BY total_redemptions DESC LIMIT 3


Generated Query Results (Normalized):
           code  total_amount_redeemed  total_redemptions
0  DINEDISCOUNT                  52.75                  2
1        GLOWUP                 125.00                  2
2        TECH20                  36.00                  2

Gold Query Results (Normalized):
           code  total_amount_redeemed  total_redemptions
0  DINEDISCOUNT                  52.75                  2
1        GLOWUP                 125.00                  2
2        TECH20                  36.00                  2
11: Exact Match: True, Subset Match: True


Processing 12th question: What are the names of the authors who wrote the paper with the title "The Effects of Climate Change on Agriculture"? on database: scholar
Generation: SELECT {author.authorname} FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title ILIKE '%The Effects of Climate Change on Agriculture%'

Error executing query: SELECT {author.authorname} FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title ILIKE '%The Effects of Climate Change on Agriculture%'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.authorname} FROM author JOIN writes ON author...
               ^

[SQL: SELECT {author.authorname} FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title ILIKE '%%The Effects of Climate Change on Agriculture%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
12: Exact Match: False, Subset Match: False


Processing 13th question: What is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers? on database: scholar
Generation: SELECT CAST(COUNT(DISTINCT CASE WHEN writes.numpapers >= 3 THEN writes.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN writes.numpapers < 3 THEN writes.authorid END), 0) AS ratio FROM writes

Error executing query: SELECT CAST(COUNT(DISTINCT CASE WHEN writes.numpapers >= 3 THEN writes.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN writes.numpapers < 3 THEN writes.authorid END), 0) AS ratio FROM writes
Error: (psycopg2.errors.UndefinedColumn) column writes.numpapers does not exist
LINE 1: SELECT CAST(COUNT(DISTINCT CASE WHEN writes.numpapers >= 3 T...
                                             ^

[SQL: SELECT CAST(COUNT(DISTINCT CASE WHEN writes.numpapers >= 3 THEN writes.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN writes.numpapers < 3 THEN writes.authorid END), 0) AS ratio FROM writes]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
13: Exact Match: False, Subset Match: False


Processing 14th question: Which authors have written publications in both the domain "Machine Learning" and the domain "Data Science"? on database: academic
Generation: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%Machine Learning%' INTERSECT SELECT domain.did FROM domain WHERE domain.name ILIKE '%Data Science%')

Error executing query: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%Machine Learning%' INTERSECT SELECT domain.did FROM domain WHERE domain.name ILIKE '%Data Science%')
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.name, author.aid} FROM author WHERE author.ai...
               ^

[SQL: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%%Machine Learning%%' INTERSECT SELECT domain.did FROM domain WHERE domain.name ILIKE '%%Data Science%%')]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
14: Exact Match: False, Subset Match: False


Processing 15th question: What is the monthly average transaction price for successful transactions in the 1st quarter of 2023? on database: broker_context
Generation: SELECT EXTRACT(MONTH FROM sbTxDateTime) AS month, AVG(sbTxPrice) AS avg_price FROM sbTransaction WHERE sbTxStatus = 'success' AND sbTxDateTime >= '2023-01-01' AND sbTxDateTime < '2023-04-01' GROUP BY month ORDER BY month

Error executing query: SELECT EXTRACT(MONTH FROM sbTxDateTime) AS month, AVG(sbTxPrice) AS avg_price FROM sbTransaction WHERE sbTxStatus = 'success' AND sbTxDateTime >= '2023-01-01' AND sbTxDateTime < '2023-04-01' GROUP BY month ORDER BY month
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
15: Exact Match: False, Subset Match: False


Processing 16th question: What are the top 3 businesses in terms of review count? on database: yelp
Generation: SELECT {business.name, business.business_id}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3

Error executing query: SELECT {business.name, business.business_id}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {business.name, business.business_id}, business.revie...
               ^

[SQL: SELECT {business.name, business.business_id}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
16: Exact Match: False, Subset Match: False


Processing 17th question: Which lakes have the largest areas in square kilometers, ordered from largest to smallest? on database: geography
Generation: SELECT lake.lake_name, lake.area FROM lake ORDER BY lake.area DESC NULLS LAST


Generated Query Results (Normalized):
     area        lake_name
0  1200.0     Lake Qinghai
1  1000.0    Lake Superior
2   900.0      Lake Baikal
3   800.0    Lake Victoria
4   700.0      Lake Malawi
5   600.0  Lake Tanganyika
6   500.0    Lake Michigan
7   400.0     Lake Ontario
8   300.0       Lake Huron
9   200.0        Lake Erie

Gold Query Results (Normalized):
     area        lake_name
0  1200.0     Lake Qinghai
1  1000.0    Lake Superior
2   900.0      Lake Baikal
3   800.0    Lake Victoria
4   700.0      Lake Malawi
5   600.0  Lake Tanganyika
6   500.0    Lake Michigan
7   400.0     Lake Ontario
8   300.0       Lake Huron
9   200.0        Lake Erie
17: Exact Match: True, Subset Match: True


Processing 18th question: show all placebo treatment id, start and end date, where there concomitant_meds were started within 2 weeks of starting the treatment. also return the start and end dates of all concomitant drug usage. on database: derm_treatment
Generation: SELECT t.treatment_id, t.start_dt, t.end_dt, c.start_dt, c.end_dt FROM treatments t JOIN concomitant_meds c ON t.treatment_id = c.treatment_id WHERE c.start_dt BETWEEN t.start_dt AND t.start_dt + INTERVAL '2 weeks'

Error executing query: SELECT t.treatment_id, t.start_dt, t.end_dt, c.start_dt, c.end_dt FROM treatments t JOIN concomitant_meds c ON t.treatment_id = c.treatment_id WHERE c.start_dt BETWEEN t.start_dt AND t.start_dt + INTERVAL '2 weeks'
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: text >= date
LINE 1: ... t.treatment_id = c.treatment_id WHERE c.start_dt BETWEEN t....
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT t.treatment_id, t.start_dt, t.end_dt, c.start_dt, c.end_dt FROM treatments t JOIN concomitant_meds c ON t.treatment_id = c.treatment_id WHERE c.start_dt BETWEEN t.start_dt AND t.start_dt + INTERVAL '2 weeks']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
18: Exact Match: False, Subset Match: False


Processing 19th question: What is the average cost of a one-way trip for each airport pair in the fare table? on database: atis
Generation: SELECT {from_airport, to_airport}, AVG(one_direction_cost) AS average_cost FROM fare GROUP BY {from_airport, to_airport} ORDER BY average_cost DESC NULLS LAST

Error executing query: SELECT {from_airport, to_airport}, AVG(one_direction_cost) AS average_cost FROM fare GROUP BY {from_airport, to_airport} ORDER BY average_cost DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {from_airport, to_airport}, AVG(one_direction_cost) A...
               ^

[SQL: SELECT {from_airport, to_airport}, AVG(one_direction_cost) AS average_cost FROM fare GROUP BY {from_airport, to_airport} ORDER BY average_cost DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
19: Exact Match: False, Subset Match: False


Processing 20th question: Return the ticker ID and symbol of tickers that do not have any daily price records. on database: broker_context
Generation: SELECT t.sbTickerId, t.sbTickerSymbol FROM sbTicker t LEFT JOIN sbDailyPrice d ON t.sbTickerId = d.sbDpTickerId WHERE d.sbDpTickerId IS NULL

Error executing query: SELECT t.sbTickerId, t.sbTickerSymbol FROM sbTicker t LEFT JOIN sbDailyPrice d ON t.sbTickerId = d.sbDpTickerId WHERE d.sbDpTickerId IS NULL
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
20: Exact Match: False, Subset Match: False


Processing 21th question: What is the total cost of all round-trip fares from New York (JFK) to Los Angeles? on database: atis
Generation: SELECT SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare WHERE fare.from_airport = 'JFK' AND fare.to_airport = 'LAX'


Generated Query Results (Normalized):
   total_round_trip_cost
0                  400.0

Gold Query Results (Normalized):
   total_round_trip_cost
0                  400.0
21: Exact Match: True, Subset Match: True


Processing 22th question: What is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase? on database: scholar
Generation: SELECT CAST(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) > 1) AS FLOAT) / NULLIF(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) = 1) AS FLOAT), 0) AS FLOAT) AS ratio

Error executing query: SELECT CAST(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) > 1) AS FLOAT) / NULLIF(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) = 1) AS FLOAT), 0) AS FLOAT) AS ratio
Error: (psycopg2.errors.SyntaxError) syntax error at or near "AS"
LINE 1: ...UP BY paperkeyphrase.paperid HAVING COUNT(*) > 1) AS FLOAT) ...
                                                             ^

[SQL: SELECT CAST(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) > 1) AS FLOAT) / NULLIF(COUNT(CASE WHEN paperkeyphrase.keyphraseid IN (SELECT keyphraseid FROM paperkeyphrase GROUP BY paperkeyphrase.paperid HAVING COUNT(*) = 1) AS FLOAT), 0) AS FLOAT) AS ratio]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
22: Exact Match: False, Subset Match: False


Processing 23th question: What is the name of the instructor who has taught the most courses, and how many courses have they taught? on database: advising
Generation: SELECT {instructor.name, instructor.instructor_id}, COUNT(DISTINCT course.course_id) AS num_courses FROM instructor JOIN offering_instructor ON instructor.instructor_id = offering_instructor.instructor_id JOIN course ON offering_instructor.offering_id = course.course_id GROUP BY {} ORDER BY num_courses DESC NULLS LAST LIMIT 1

Error executing query: SELECT {instructor.name, instructor.instructor_id}, COUNT(DISTINCT course.course_id) AS num_courses FROM instructor JOIN offering_instructor ON instructor.instructor_id = offering_instructor.instructor_id JOIN course ON offering_instructor.offering_id = course.course_id GROUP BY {} ORDER BY num_courses DESC NULLS LAST LIMIT 1
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {instructor.name, instructor.instructor_id}, COUNT(DI...
               ^

[SQL: SELECT {instructor.name, instructor.instructor_id}, COUNT(DISTINCT course.course_id) AS num_courses FROM instructor JOIN offering_instructor ON instructor.instructor_id = offering_instructor.instructor_id JOIN course ON offering_instructor.offering_id = course.course_id GROUP BY {} ORDER BY num_courses DESC NULLS LAST LIMIT 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
23: Exact Match: False, Subset Match: False


Processing 24th question: For each paper that cites other papers, how many other papers does it cite? Sort by the number of papers cited in descending order on database: scholar
Generation: SELECT cite.citingpaperid, COUNT(cite.citedpaperid) AS num_cited_papers FROM cite GROUP BY cite.citingpaperid ORDER BY num_cited_papers DESC NULLS LAST


Generated Query Results (Normalized):
   citingpaperid  num_cited_papers
0              3                 3
1              4                 2
2              1                 2
3              5                 1
4              2                 1

Gold Query Results (Normalized):
   citingpaperid  num_cited_papers
0              5                 1
1              4                 2
2              3                 3
3              2                 1
4              1                 2

Gold Query Results (Normalized):
   citingpaperid  num_cited_papers
0              5                 1
1              4                 2
2              3                 3
3              2                 1
4              1                 2

Gold Query Results (Normalized):
   citingpaperid  num_cited_papers
0              3                 3
1              4                 2
2              1                 2
3              5                 1
4              2                 1
24: Exact Match: True, Subset Match: True


Processing 25th question: what is average age of all registered male patients with private insurance currently? on database: derm_treatment
Generation: SELECT AVG(age) FROM patients WHERE gender = 'male' AND ins_type = 'private' AND date_of_registration <= CURRENT_DATE

Error executing query: SELECT AVG(age) FROM patients WHERE gender = 'male' AND ins_type = 'private' AND date_of_registration <= CURRENT_DATE
Error: (psycopg2.errors.UndefinedColumn) column "age" does not exist
LINE 1: SELECT AVG(age) FROM patients WHERE gender = 'male' AND ins_...
                   ^

[SQL: SELECT AVG(age) FROM patients WHERE gender = 'male' AND ins_type = 'private' AND date_of_registration <= CURRENT_DATE]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
25: Exact Match: False, Subset Match: False


Processing 26th question: Return the number of payments made on weekends to the vendor named 'Utility Company' on database: car_dealership
Generation: SELECT COUNT(*) AS weekend_payments FROM payments_made WHERE vendor_name ILIKE '%Utility Company%' AND EXTRACT(DOW FROM payment_date) IN (0, 6)


Generated Query Results (Normalized):
   weekend_payments
0                 1

Gold Query Results (Normalized):
   weekend_payments
0                 1
26: Exact Match: True, Subset Match: True


Processing 27th question: What are the top 3 diagnoses by maximum itch VAS score at day 100 and number of distinct patients? Return the diagnosis name, number of patients, and maximum itch score. on database: derm_treatment
Generation: SELECT d.diag_name, COUNT(DISTINCT t.patient_id) AS num_patients, MAX(o.day100_itch_vas) AS max_itch_score FROM treatments t JOIN diagnoses d ON t.diag_id = d.diag_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE o.day100_itch_vas IS NOT NULL GROUP BY d.diag_name ORDER BY max_itch_score DESC LIMIT 3


Generated Query Results (Normalized):
                     diag_name  max_itch_score  num_patients
0              Other psoriasis              40             2
1  Other psoriatic arthropathy              70             1
2           Psoriasis vulgaris              40             3

Gold Query Results (Normalized):
                     diag_name  max_itch_score  num_patients
0              Other psoriasis              40             2
1  Other psoriatic arthropathy              70             1
2           Psoriasis vulgaris              40             3
27: Exact Match: True, Subset Match: True


Processing 28th question: How does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well. on database: academic
Generation: SELECT publication.year, CAST(COUNT(publication.pid) AS FLOAT) / NULLIF(COUNT(journal.jid), 0) AS ratio, COUNT(publication.pid) AS publications, COUNT(journal.jid) AS journals FROM publication JOIN journal ON publication.jid = journal.jid GROUP BY publication.year ORDER BY publication.year


Generated Query Results (Normalized):
   journals  publications  ratio  year
0         2             2    1.0  2020
1         3             3    1.0  2021

Gold Query Results (Normalized):
   journals  publications  ratio  year
0         2             2    1.0  2020
1         3             3    1.0  2021
28: Exact Match: True, Subset Match: True


Processing 29th question: Return the drug IDs and names of drugs that have not been used in any treatments. on database: derm_treatment
Generation: SELECT d.drug_id, d.drug_name FROM drugs d LEFT JOIN treatments t ON d.drug_id = t.drug_id WHERE t.drug_id IS NULL


Generated Query Results (Normalized):
   drug_id   drug_name
0        7  Biologic-Y
1        8   Smallitol
2        9   Topicalin
3       10  Biologic-Z

Gold Query Results (Normalized):
   drug_id   drug_name
0        7  Biologic-Y
1        8   Smallitol
2        9   Topicalin
3       10  Biologic-Z
29: Exact Match: True, Subset Match: True


Processing 30th question: Return the distinct list of ticker IDs that have daily price records on or after Apr 1, 2023. on database: broker_context
Generation: SELECT DISTINCT t.sbTickerId FROM sbTicker t JOIN sbDailyPrice d ON t.sbTickerId = d.sbDpTickerId WHERE d.sbDpDate >= '2023-04-01'

Error executing query: SELECT DISTINCT t.sbTickerId FROM sbTicker t JOIN sbDailyPrice d ON t.sbTickerId = d.sbDpTickerId WHERE d.sbDpDate >= '2023-04-01'
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
30: Exact Match: False, Subset Match: False


Processing 31th question: What is the title of the publication that has received the highest number of citations? on database: academic
Generation: SELECT title FROM publication ORDER BY citation_num DESC LIMIT 1


Generated Query Results (Normalized):
                                          title
0  The Effects of Climate Change on Agriculture

Gold Query Results (Normalized):
                                          title
0  The Effects of Climate Change on Agriculture
31: Exact Match: True, Subset Match: True


Processing 32th question: What is the total population in cities by country? on database: geography
Generation: SELECT city.country_name, SUM(city.population) AS total_population FROM city GROUP BY city.country_name ORDER BY total_population DESC NULLS LAST


Generated Query Results (Normalized):
     country_name  total_population
0          Brazil         3000000.0
1          Canada          800000.0
2           India         1200000.0
3           Japan          700000.0
4          Mexico          600000.0
5  United Kingdom          900000.0
6   United States         9500000.0

Gold Query Results (Normalized):
     country_name  total_population
0          Brazil         3000000.0
1          Canada          800000.0
2           India         1200000.0
3           Japan          700000.0
4          Mexico          600000.0
5  United Kingdom          900000.0
6   United States         9500000.0
32: Exact Match: True, Subset Match: True


Processing 33th question: What is the total number of check-ins for each day of the week for the business with ID "abc123"? on database: yelp
Generation: SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.business_id = 'abc123' GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST


Generated Query Results (Normalized):
       day  total_checkins
0   Monday            10.0
1  Tuesday            13.0

Gold Query Results (Normalized):
       day  total_checkins
0   Monday            10.0
1  Tuesday            13.0
33: Exact Match: True, Subset Match: True


Processing 34th question: How many papers are associated with the keyphrase "machine learning" and were published in the journal named "IEEE Transactions on Pattern Analysis and Machine Intelligence"? on database: scholar
Generation: SELECT COUNT(DISTINCT paper.paperid) AS number_of_papers FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN keyphrase ON paper.paperid = paperkeyphrase.paperid JOIN writes ON paper.paperid = writes.paperid JOIN author ON writes.authorid = author.authorid JOIN venue ON paper.venueid = venue.venueid WHERE keyphrase.keyphrasename ILIKE '%machine learning%' AND journal.journalname ILIKE '%IEEE Transactions on Pattern Analysis and Machine Intelligence%'

Error executing query: SELECT COUNT(DISTINCT paper.paperid) AS number_of_papers FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN keyphrase ON paper.paperid = paperkeyphrase.paperid JOIN writes ON paper.paperid = writes.paperid JOIN author ON writes.authorid = author.authorid JOIN venue ON paper.venueid = venue.venueid WHERE keyphrase.keyphrasename ILIKE '%machine learning%' AND journal.journalname ILIKE '%IEEE Transactions on Pattern Analysis and Machine Intelligence%'
Error: (psycopg2.errors.UndefinedTable) missing FROM-clause entry for table "paperkeyphrase"
LINE 1: ...urnal.journalid JOIN keyphrase ON paper.paperid = paperkeyph...
                                                             ^

[SQL: SELECT COUNT(DISTINCT paper.paperid) AS number_of_papers FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN keyphrase ON paper.paperid = paperkeyphrase.paperid JOIN writes ON paper.paperid = writes.paperid JOIN author ON writes.authorid = author.authorid JOIN venue ON paper.venueid = venue.venueid WHERE keyphrase.keyphrasename ILIKE '%%machine learning%%' AND journal.journalname ILIKE '%%IEEE Transactions on Pattern Analysis and Machine Intelligence%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
34: Exact Match: False, Subset Match: False


Processing 35th question: How many check-ins occurred on Mondays at businesses in the state of California? on database: yelp
Generation: SELECT COUNT(*) AS checkins FROM checkin AS c JOIN business AS b ON c.business_id = b.business_id WHERE b.state = 'CA' AND c.day = 'Monday'


Generated Query Results (Normalized):
   checkins
0         1

Gold Query Results (Normalized):
   checkins
0         1
35: Exact Match: True, Subset Match: True


Processing 36th question: What are the top 2 categories of businesses with the highest average rating? on database: yelp
Generation: SELECT {category.category_name, category.id} FROM category JOIN business ON business.business_id = category.business_id JOIN review ON review.business_id = business.business_id GROUP BY {} ORDER BY AVG(review.rating) DESC NULLS LAST LIMIT 2

Error executing query: SELECT {category.category_name, category.id} FROM category JOIN business ON business.business_id = category.business_id JOIN review ON review.business_id = business.business_id GROUP BY {} ORDER BY AVG(review.rating) DESC NULLS LAST LIMIT 2
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {category.category_name, category.id} FROM category J...
               ^

[SQL: SELECT {category.category_name, category.id} FROM category JOIN business ON business.business_id = category.business_id JOIN review ON review.business_id = business.business_id GROUP BY {} ORDER BY AVG(review.rating) DESC NULLS LAST LIMIT 2]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
36: Exact Match: False, Subset Match: False


Processing 37th question: Return the name and average rating for each business in new york on database: yelp
Generation: SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%new york%' GROUP BY business.name ORDER BY average_rating DESC NULLS LAST


Generated Query Results (Normalized):
   average_rating           name
0           3.775   Peter’s Cafe
1           4.000   Sashays Cafe
2           4.600  Lily’s Bakery

Gold Query Results (Normalized):
   average_rating           name
0           3.775   Peter’s Cafe
1           4.000   Sashays Cafe
2           4.600  Lily’s Bakery
37: Exact Match: True, Subset Match: True


Processing 38th question: What is the ratio of papers published in the year 2020 to the total number of papers in the database? on database: scholar
Generation: SELECT CAST(COUNT(CASE WHEN paper.year = 2020 THEN 1 END) AS FLOAT) / NULLIF(COUNT(paper.paperid), 0) AS ratio FROM paper


Generated Query Results (Normalized):
   ratio
0    0.6

Gold Query Results (Normalized):
   ratio
0    0.6
38: Exact Match: True, Subset Match: True


Processing 39th question: Which airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops in ascending order? on database: atis
Generation: SELECT {airline.airline_name, airline.airline_code}, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops ASC NULLS LAST

Error executing query: SELECT {airline.airline_name, airline.airline_code}, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops ASC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {airline.airline_name, airline.airline_code}, flight....
               ^

[SQL: SELECT {airline.airline_name, airline.airline_code}, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops ASC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
39: Exact Match: False, Subset Match: False


Processing 40th question: What are the top 5 combinations of customer state and ticker type by number of transactions? Return the customer state, ticker type and number of transactions. on database: broker_context
Generation: SELECT c.sbCustState, t.sbTickerType, COUNT(*) AS num_transactions FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId JOIN sbTicker ticker ON t.sbTxTickerId = ticker.sbTickerId GROUP BY c.sbCustState, t.sbTickerType ORDER BY num_transactions DESC LIMIT 5

Error executing query: SELECT c.sbCustState, t.sbTickerType, COUNT(*) AS num_transactions FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId JOIN sbTicker ticker ON t.sbTxTickerId = ticker.sbTickerId GROUP BY c.sbCustState, t.sbTickerType ORDER BY num_transactions DESC LIMIT 5
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
40: Exact Match: False, Subset Match: False


Processing 41th question: List the restaurants starting from the best ratings to the lowest on database: restaurants
Generation: SELECT {restaurant.name, restaurant.id} FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST

Error executing query: SELECT {restaurant.name, restaurant.id} FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {restaurant.name, restaurant.id} FROM restaurant ORDE...
               ^

[SQL: SELECT {restaurant.name, restaurant.id} FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
41: Exact Match: False, Subset Match: False


Processing 42th question: Return the distinct list of customer IDs who have made a 'buy' transaction. on database: broker_context
Generation: SELECT DISTINCT sbTxCustId FROM sbTransaction WHERE sbTxType = 'buy'

Error executing query: SELECT DISTINCT sbTxCustId FROM sbTransaction WHERE sbTxType = 'buy'
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
42: Exact Match: False, Subset Match: False


Processing 43th question: How many restaurants are there in each city? Order the results by the number of restaurants in descending order. on database: restaurants
Generation: SELECT COUNT(DISTINCT location.restaurant_id), location.city_name FROM location GROUP BY location.city_name ORDER BY COUNT(DISTINCT location.restaurant_id) DESC NULLS LAST


Generated Query Results (Normalized):
       city_name  count
0    Los Angeles      3
1          Miami      2
2       New York      3
3  San Francisco      3

Gold Query Results (Normalized):
       city_name  count
0  San Francisco      3
1       New York      3
2          Miami      2
3    Los Angeles      3
43: Exact Match: False, Subset Match: True


Processing 44th question: What is the minimum amount of time required for a connecting flight at JFK Airport? on database: atis
Generation: SELECT minimum_connect_time FROM airport WHERE airport_code = 'JFK'


Generated Query Results (Normalized):
   minimum_connect_time
0                    23

Gold Query Results (Normalized):
   minimum_connect_time
0                    23
44: Exact Match: True, Subset Match: True


Processing 45th question: What is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco? Match food_type case insensitively on database: restaurants
Generation: SELECT CAST(SUM(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant WHERE LOWER(restaurant.city_name) ILIKE '%san francisco%'


Generated Query Results (Normalized):
   ratio
0    0.5

Gold Query Results (Normalized):
   ratio
0    0.5
45: Exact Match: True, Subset Match: True


Processing 46th question: Which courses have been taken by students in the Computer Science program? on database: advising
Generation: SELECT {course.name, course.course_id} FROM course JOIN program_course ON course.course_id = program_course.course_id JOIN program ON program_course.program_id = program.program_id WHERE program.name ILIKE '%Computer Science%'

Error executing query: SELECT {course.name, course.course_id} FROM course JOIN program_course ON course.course_id = program_course.course_id JOIN program ON program_course.program_id = program.program_id WHERE program.name ILIKE '%Computer Science%'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {course.name, course.course_id} FROM course JOIN prog...
               ^

[SQL: SELECT {course.name, course.course_id} FROM course JOIN program_course ON course.course_id = program_course.course_id JOIN program ON program_course.program_id = program.program_id WHERE program.name ILIKE '%%Computer Science%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
46: Exact Match: False, Subset Match: False


Processing 47th question: What is the highest point in each state and what is the population density of that state? on database: geography
Generation: SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST


Generated Query Results (Normalized):
    density   state_name
0    1000.0   California
1    1000.0      England
2    1000.0      Florida
3    1000.0    Guangdong
4    1000.0  Maharashtra
5    1000.0     Michigan
6    1000.0     New York
7    1000.0         Ohio
8    1000.0      Ontario
9    1000.0    Sao Paulo
10   1000.0        Texas
11   1000.0        Tokyo

Gold Query Results (Normalized):
    density   state_name
0    1000.0   California
1    1000.0      England
2    1000.0      Florida
3    1000.0    Guangdong
4    1000.0  Maharashtra
5    1000.0     Michigan
6    1000.0     New York
7    1000.0         Ohio
8    1000.0      Ontario
9    1000.0    Sao Paulo
10   1000.0        Texas
11   1000.0        Tokyo
47: Exact Match: True, Subset Match: True


Processing 48th question: Which states have the highest population density in people per square kilometer, ordered from highest to lowest? on database: geography
Generation: SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST


Generated Query Results (Normalized):
    density   state_name
0    1000.0        Tokyo
1    1000.0        Texas
2    1000.0    Sao Paulo
3    1000.0      Ontario
4    1000.0         Ohio
5    1000.0     New York
6    1000.0     Michigan
7    1000.0  Maharashtra
8    1000.0    Guangdong
9    1000.0      Florida
10   1000.0      England
11   1000.0   California

Gold Query Results (Normalized):
    density   state_name
0    1000.0        Tokyo
1    1000.0        Texas
2    1000.0    Sao Paulo
3    1000.0      Ontario
4    1000.0         Ohio
5    1000.0     New York
6    1000.0     Michigan
7    1000.0  Maharashtra
8    1000.0    Guangdong
9    1000.0      Florida
10   1000.0      England
11   1000.0   California
48: Exact Match: True, Subset Match: True


Processing 49th question: How many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications. on database: academic
Generation: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS number_of_publications FROM conference JOIN publication ON conference.cid = publication.cid GROUP BY {} ORDER BY number_of_publications DESC NULLS LAST

Error executing query: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS number_of_publications FROM conference JOIN publication ON conference.cid = publication.cid GROUP BY {} ORDER BY number_of_publications DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {conference.name, conference.cid}, COUNT(DISTINCT pub...
               ^

[SQL: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS number_of_publications FROM conference JOIN publication ON conference.cid = publication.cid GROUP BY {} ORDER BY number_of_publications DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
49: Exact Match: False, Subset Match: False


Processing 50th question: Return users (user ID and username) who have not received any notifications on database: ewallet
Generation: SELECT u.uid, u.username FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id WHERE n.id IS NULL


Generated Query Results (Normalized):
   uid    username
0   11  lisa_jones

Gold Query Results (Normalized):
   uid    username
0   11  lisa_jones
50: Exact Match: True, Subset Match: True


Processing 51th question: How many rivers flow through each country? on database: geography
Generation: SELECT river.country_name, COUNT(DISTINCT river.river_name) AS number_of_rivers FROM river GROUP BY river.country_name ORDER BY number_of_rivers DESC NULLS LAST


Generated Query Results (Normalized):
    country_name  number_of_rivers
0         Brazil                 1
1         Canada                 1
2          China                 1
3          Egypt                 1
4        Germany                 2
5          Italy                 1
6         Russia                 1
7  United States                 1
8        Vietnam                 1

Gold Query Results (Normalized):
    country_name  number_of_rivers
0         Brazil                 1
1         Canada                 1
2          China                 1
3          Egypt                 1
4        Germany                 2
5          Italy                 1
6         Russia                 1
7  United States                 1
8        Vietnam                 1
51: Exact Match: True, Subset Match: True


Processing 52th question: Return the distinct list of merchant IDs that have received money from a transaction. Consider all transaction types in the results you return, but only include the merchant ids in your final answer. on database: ewallet
Generation: SELECT DISTINCT t.merchant_id FROM wallet_transactions_daily t WHERE t.receiver_type = 2

Error executing query: SELECT DISTINCT t.merchant_id FROM wallet_transactions_daily t WHERE t.receiver_type = 2
Error: (psycopg2.errors.UndefinedTable) relation "wallet_transactions_daily" does not exist
LINE 1: SELECT DISTINCT t.merchant_id FROM wallet_transactions_daily...
                                           ^

[SQL: SELECT DISTINCT t.merchant_id FROM wallet_transactions_daily t WHERE t.receiver_type = 2]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
52: Exact Match: False, Subset Match: False


Processing 53th question: What is the total count of restaurants in each city? on database: restaurants
Generation: SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS total_count FROM location GROUP BY location.city_name ORDER BY total_count DESC NULLS LAST


Generated Query Results (Normalized):
       city_name  total_count
0    Los Angeles            3
1          Miami            2
2       New York            3
3  San Francisco            3

Gold Query Results (Normalized):
       city_name  total_count
0    Los Angeles            3
1          Miami            2
2       New York            3
3  San Francisco            3
53: Exact Match: True, Subset Match: True


Processing 54th question: What is the proportion of flights with stops out of all flights for each airline code? on database: atis
Generation: SELECT flight.airline_code, CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(1), 0) AS proportion_with_stops FROM flight GROUP BY flight.airline_code ORDER BY proportion_with_stops DESC NULLS LAST


Generated Query Results (Normalized):
  airline_code  proportion_with_stops
0           AA               0.333333
1           AS               0.000000
2           F9               1.000000
3           HA               0.000000
4           UA               0.500000
5           VX               1.000000
6           WN               1.000000

Gold Query Results (Normalized):
  airline_code  proportion_with_stops
0           AA               0.333333
1           AS               0.000000
2           F9               1.000000
3           HA               0.000000
4           UA               0.500000
5           VX               1.000000
6           WN               1.000000
54: Exact Match: True, Subset Match: True


Processing 55th question: Who were the top 3 sales representatives by total revenue in the past 3 months, inclusive of today's date? Return their first name, last name, total number of sales and total revenue. Note that revenue refers to the sum of sale_price in the sales table. on database: car_dealership
Generation: SELECT s.first_name, s.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY s.salesperson_id ORDER BY total_revenue DESC LIMIT 3

Error executing query: SELECT s.first_name, s.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY s.salesperson_id ORDER BY total_revenue DESC LIMIT 3
Error: (psycopg2.errors.UndefinedColumn) column s.first_name does not exist
LINE 1: SELECT s.first_name, s.last_name, COUNT(s.id) AS total_sales...
               ^
HINT:  Perhaps you meant to reference the column "sp.first_name".

[SQL: SELECT s.first_name, s.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY s.salesperson_id ORDER BY total_revenue DESC LIMIT 3]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
55: Exact Match: False, Subset Match: False


Processing 56th question: Which authors belong to the same domain as Martin? on database: academic
Generation: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%Martin%'))

Error executing query: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%Martin%'))
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.name, author.aid} FROM author WHERE author.ai...
               ^

[SQL: SELECT {author.name, author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM domain WHERE domain.name ILIKE '%%Martin%%'))]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
56: Exact Match: False, Subset Match: False


Processing 57th question: Which authors have published the most papers, ordered by the number of papers they have published in descending order? on database: scholar
Generation: SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS num_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY num_papers DESC NULLS LAST

Error executing query: SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS num_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY num_papers DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.authorname, author.authorid}, COUNT(DISTINCT ...
               ^

[SQL: SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS num_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY num_papers DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
57: Exact Match: False, Subset Match: False


Processing 58th question: What are the longest rivers in meters, ordered from longest to shortest? on database: geography
Generation: SELECT river.river_name, river.length FROM river ORDER BY river.length DESC NULLS LAST


Generated Query Results (Normalized):
   length   river_name
0    1000         Nile
1     900        Rhine
2     800        Volga
3     700       Danube
4     600       Mekong
5     500       Amazon
6     400        Yukon
7     300      Yangtze
8     200  Mississippi
9     100           Po

Gold Query Results (Normalized):
   length   river_name
0    1000         Nile
1     900        Rhine
2     800        Volga
3     700       Danube
4     600       Mekong
5     500       Amazon
6     400        Yukon
7     300      Yangtze
8     200  Mississippi
9     100           Po
58: Exact Match: True, Subset Match: True


Processing 59th question: show me the daily total amount of payments received in the whole of the previous ISO week not including the current week, split by the payment_method on database: car_dealership
Generation: SELECT payment_method, SUM(payment_amount) AS total_amount, EXTRACT(DOW FROM payment_date) AS day_of_week FROM payments_received WHERE payment_date < CURRENT_DATE AND payment_date >= CURRENT_DATE - INTERVAL '1 week' GROUP BY payment_method, day_of_week ORDER BY total_amount DESC


Generated Query Results (Normalized):
   day_of_week payment_method  total_amount
0          0.0     debit_card       26500.0
1          2.0    credit_card       43500.0
2          4.0    credit_card       37500.0
3          4.0      financing       17200.0
4          6.0     debit_card       24000.0

Gold Query Results (Normalized):
   day_of_week payment_method  total_amount
0          0.0     debit_card       26500.0
1          2.0    credit_card       43500.0
2          4.0    credit_card       37500.0
3          4.0      financing       17200.0
4          6.0     debit_card       24000.0
59: Exact Match: True, Subset Match: True


Processing 60th question: Which flight ids to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order? on database: atis
Generation: SELECT flight.flight_id FROM flight WHERE flight.from_airport = 'ORD' ORDER BY flight.arrival_time - flight.departure_time ASC NULLS LAST


Generated Query Results (Normalized):
   flight_id
0          1
1          2
2          3
3          4
4          5

Gold Query Results (Normalized):
   flight_id
0          1
1          2
2          3
3          4
4          5
60: Exact Match: True, Subset Match: True


Processing 61th question: Return the distinct list of customer IDs that have made a purchase, based on joining the customers and sales tables. on database: car_dealership
Generation: SELECT DISTINCT c.id AS customer_id FROM customers c JOIN sales s ON c.id = s.customer_id


Generated Query Results (Normalized):
    customer_id
0             1
1             2
2             3
3             4
4             5
5             6
6             7
7             8
8             9
9            10
10           11
11           12

Gold Query Results (Normalized):
    customer_id
0             1
1             2
2             3
3             4
4             5
5             6
6             7
7             8
8             9
9            10
10           11
11           12
61: Exact Match: True, Subset Match: True


Processing 62th question: Get the ratio of population per area for each state on database: geography
Generation: SELECT state.state_name, CAST(state.population AS FLOAT) / NULLIF(state.area, 0) AS population_per_area FROM state


Generated Query Results (Normalized):
    population_per_area   state_name
0              0.900000      England
1              1.400000        Tokyo
2              6.666667    Guangdong
3              8.181818         Ohio
4              8.333333    Sao Paulo
5             10.000000   California
6             10.000000      Florida
7             10.000000     New York
8             10.000000      Ontario
9             10.000000        Texas
10            13.333333     Michigan
11            16.666667  Maharashtra

Gold Query Results (Normalized):
    population_per_area   state_name
0              0.900000      England
1              1.400000        Tokyo
2              6.666667    Guangdong
3              8.181818         Ohio
4              8.333333    Sao Paulo
5             10.000000   California
6             10.000000      Florida
7             10.000000     New York
8             10.000000      Ontario
9             10.000000        Texas
10            13.333333     Michigan
11            16.666667  Maharashtra
62: Exact Match: True, Subset Match: True


Processing 63th question: What is the ratio of one-way trip costs to round-trip costs for each fare? on database: atis
Generation: SELECT fare.fare_id, CAST(fare.one_direction_cost AS FLOAT) / NULLIF(fare.round_trip_cost, 0) AS one_way_to_round_trip_ratio FROM fare


Generated Query Results (Normalized):
   fare_id  one_way_to_round_trip_ratio
0        1                     0.666667
1        2                     0.535714
2        3                     0.600000
3        4                     0.714286
4        5                     0.550000
5        6                     0.542857
6        7                     0.525000
7        8                     0.575000
8        9                     0.600000
9       10                     0.540000

Gold Query Results (Normalized):
   fare_id  one_way_to_round_trip_ratio
0        1                     0.666667
1        2                     0.535714
2        3                     0.600000
3        4                     0.714286
4        5                     0.550000
5        6                     0.542857
6        7                     0.525000
7        8                     0.575000
8        9                     0.600000
9       10                     0.540000
63: Exact Match: True, Subset Match: True


Processing 64th question: What was the average transaction daily and monthly limit for the earliest setting snapshot in 2023? on database: ewallet
Generation: SELECT AVG(tx_limit_daily), AVG(tx_limit_monthly) FROM consumer_div.user_setting_snapshot WHERE snapshot_date = (SELECT MIN(snapshot_date) FROM consumer_div.user_setting_snapshot WHERE snapshot_date >= '2023-01-01'::DATE)


Generated Query Results (Normalized):
   avg_0   avg_1
0  501.0  1750.0

Gold Query Results (Normalized):
   avg_0   avg_1
0  501.0  1750.0
64: Exact Match: True, Subset Match: True


Processing 65th question: How many reviews were posted for each business id in the year 2021? on database: yelp
Generation: SELECT review.business_id, COUNT(*) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.business_id ORDER BY review_count DESC NULLS LAST


Generated Query Results (Normalized):
  business_id  review_count
0      abc123             1
1      def456             2
2      ghi789             2
3      jkl012             1
4      mno345             1
5      uvw456             1
6      xyz123             1

Gold Query Results (Normalized):
  business_id  review_count
0      abc123             1
1      def456             2
2      ghi789             2
3      jkl012             1
4      mno345             1
5      uvw456             1
6      xyz123             1
65: Exact Match: True, Subset Match: True


Processing 66th question: How many papers cite each paper in the dataset named "COVID-19 Research"? on database: scholar
Generation: SELECT citedpaperid, COUNT(*) AS num_citations FROM cite WHERE citedpaperid IN (SELECT paperid FROM paperdataset WHERE datasetid IN (SELECT datasetid FROM dataset WHERE datasetname ILIKE '%COVID-19 Research%')) GROUP BY citedpaperid ORDER BY num_citations DESC NULLS LAST


Generated Query Results (Normalized):
   citedpaperid  num_citations
0             4              2

Gold Query Results (Normalized):
   citedpaperid  num_citations
0             4              2
66: Exact Match: True, Subset Match: True


Processing 67th question: What cities have more than one restaurants with the same name, and how many of them are there? Return the city name, restaurant name, and restaurant count on database: restaurants
Generation: SELECT {location.city_name, restaurant.name, COUNT(*) AS restaurant_count} FROM location JOIN restaurant ON location.city_name = restaurant.city_name WHERE restaurant.name <> '' GROUP BY location.city_name, restaurant.name HAVING COUNT(*) > 1

Error executing query: SELECT {location.city_name, restaurant.name, COUNT(*) AS restaurant_count} FROM location JOIN restaurant ON location.city_name = restaurant.city_name WHERE restaurant.name <> '' GROUP BY location.city_name, restaurant.name HAVING COUNT(*) > 1
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {location.city_name, restaurant.name, COUNT(*) AS res...
               ^

[SQL: SELECT {location.city_name, restaurant.name, COUNT(*) AS restaurant_count} FROM location JOIN restaurant ON location.city_name = restaurant.city_name WHERE restaurant.name <> '' GROUP BY location.city_name, restaurant.name HAVING COUNT(*) > 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
67: Exact Match: False, Subset Match: False


Processing 68th question: What are the top 5 drugs by number of treatments and average drug amount per treatment? Return the drug name, number of treatments, and average drug amount. on database: derm_treatment
Generation: SELECT d.drug_name, COUNT(*) AS num_treatments, AVG(t.tot_drug_amt) AS avg_drug_amt FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id GROUP BY d.drug_name ORDER BY num_treatments DESC, avg_drug_amt DESC LIMIT 5


Generated Query Results (Normalized):
   avg_drug_amt   drug_name  num_treatments
0    150.000000  Biologic-X               4
1    178.333333     Medicol               6
2    206.666667    Drugalin               6
3    307.500000     Topizol               4
4    580.000000    Topicort               3

Gold Query Results (Normalized):
   avg_drug_amt   drug_name  num_treatments
0    150.000000  Biologic-X               4
1    178.333333     Medicol               6
2    206.666667    Drugalin               6
3    307.500000     Topizol               4
4    580.000000    Topicort               3
68: Exact Match: True, Subset Match: True


Processing 69th question: What is the average rating of restaurants in each region? Order the results by the region name. on database: restaurants
Generation: SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN location ON geographic.city_name = location.city_name JOIN restaurant ON location.restaurant_id = restaurant.id GROUP BY geographic.region ORDER BY geographic.region


Generated Query Results (Normalized):
   average_rating      region
0            4.15  California
1            4.50     Florida
2            4.30    New York

Gold Query Results (Normalized):
   average_rating      region
0            4.15  California
1            4.50     Florida
2            4.30    New York
69: Exact Match: True, Subset Match: True


Processing 70th question: How does the average ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers? on database: atis
Generation: SELECT aircraft.manufacturer, AVG(aircraft.cruising_speed::FLOAT / NULLIF(aircraft.pay_load, 0)) AS avg_ratio
FROM aircraft
GROUP BY aircraft.manufacturer
ORDER BY avg_ratio DESC NULLS LAST


Generated Query Results (Normalized):
   avg_ratio manufacturer
0   0.009441       Airbus
1   0.010742       Boeing
2   0.036133      Embraer
3   0.084762   Bombardier

Gold Query Results (Normalized):
   avg_ratio manufacturer
0   0.009441       Airbus
1   0.010742       Boeing
2   0.036133      Embraer
3   0.084762   Bombardier
70: Exact Match: True, Subset Match: True


Processing 71th question: What are the names of the businesses in the database, ordered alphabetically? on database: yelp
Generation: SELECT name FROM business ORDER BY name


Generated Query Results (Normalized):
            name
0   Anna’s Diner
1   Izza’s Pizza
2    Joe’s Pizza
3  Lily’s Bakery
4  Mark’s Bistro
5   Peter’s Cafe
6   Sashays Cafe

Gold Query Results (Normalized):
            name
0   Anna’s Diner
1   Izza’s Pizza
2    Joe’s Pizza
3  Lily’s Bakery
4  Mark’s Bistro
5   Peter’s Cafe
6   Sashays Cafe
71: Exact Match: True, Subset Match: True


Processing 72th question: What is the ratio of publications to authors in the database? on database: academic
Generation: SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS ratio FROM publication JOIN author ON publication.aid = author.aid

Error executing query: SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS ratio FROM publication JOIN author ON publication.aid = author.aid
Error: (psycopg2.errors.UndefinedColumn) column publication.aid does not exist
LINE 1: ...aid), 0) AS ratio FROM publication JOIN author ON publicatio...
                                                             ^

[SQL: SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS ratio FROM publication JOIN author ON publication.aid = author.aid]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
72: Exact Match: False, Subset Match: False


Processing 73th question: Which restaurants serve Italian cuisine or are located in New York? Order the results by the restaurant name. on database: restaurants
Generation: SELECT {restaurant.name, restaurant.id} FROM restaurant WHERE restaurant.food_type ILIKE '%Italian%' OR restaurant.city_name ILIKE '%New York%' ORDER BY restaurant.name

Error executing query: SELECT {restaurant.name, restaurant.id} FROM restaurant WHERE restaurant.food_type ILIKE '%Italian%' OR restaurant.city_name ILIKE '%New York%' ORDER BY restaurant.name
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {restaurant.name, restaurant.id} FROM restaurant WHER...
               ^

[SQL: SELECT {restaurant.name, restaurant.id} FROM restaurant WHERE restaurant.food_type ILIKE '%%Italian%%' OR restaurant.city_name ILIKE '%%New York%%' ORDER BY restaurant.name]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
73: Exact Match: False, Subset Match: False


Processing 74th question: What is the total number of check-ins for each business in the state of California? on database: yelp
Generation: SELECT business.business_id, business.name, SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' GROUP BY business.business_id, business.name ORDER BY total_checkins DESC NULLS LAST


Generated Query Results (Normalized):
  business_id           name  total_checkins
0      abc123    Joe’s Pizza            23.0
1      ghi789   Anna’s Diner            23.0
2      jkl012  Mark’s Bistro            51.0
3      xyz123   Izza’s Pizza            10.0

Gold Query Results (Normalized):
  business_id           name  total_checkins
0      abc123    Joe’s Pizza            23.0
1      ghi789   Anna’s Diner            23.0
2      jkl012  Mark’s Bistro            51.0
3      xyz123   Izza’s Pizza            10.0
74: Exact Match: True, Subset Match: True


Processing 75th question: How many papers were published in the journal "nature" in the year 2020? on database: scholar
Generation: SELECT COUNT(*) AS number_of_papers FROM paper WHERE journalname ILIKE '%nature%' AND year = 2020

Error executing query: SELECT COUNT(*) AS number_of_papers FROM paper WHERE journalname ILIKE '%nature%' AND year = 2020
Error: (psycopg2.errors.UndefinedColumn) column "journalname" does not exist
LINE 1: ...ECT COUNT(*) AS number_of_papers FROM paper WHERE journalnam...
                                                             ^

[SQL: SELECT COUNT(*) AS number_of_papers FROM paper WHERE journalname ILIKE '%%nature%%' AND year = 2020]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
75: Exact Match: False, Subset Match: False


Processing 76th question: How many meals are served in each compartment, sorted by the number of meals in descending order? on database: atis
Generation: SELECT food_service.compartment, COUNT(food_service.meal_code) AS meal_count FROM food_service GROUP BY food_service.compartment ORDER BY meal_count DESC NULLS LAST


Generated Query Results (Normalized):
   compartment  meal_count
0  First Class           3
1      Economy           3

Gold Query Results (Normalized):
   compartment  meal_count
0  First Class           3
1      Economy           3
76: Exact Match: True, Subset Match: True


Processing 77th question: What is the total number of citations received by each author? on database: academic
Generation: SELECT {author.name, author.aid}, SUM(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY {} ORDER BY total_citations DESC NULLS LAST

Error executing query: SELECT {author.name, author.aid}, SUM(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY {} ORDER BY total_citations DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.name, author.aid}, SUM(publication.citation_n...
               ^

[SQL: SELECT {author.name, author.aid}, SUM(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY {} ORDER BY total_citations DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
77: Exact Match: False, Subset Match: False


Processing 78th question: What is the ratio of the number of courses with projects to the number of courses with exams in each semester id? on database: advising
Generation: SELECT course_offering.semester, CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM course JOIN course_offering ON course.course_id = course_offering.course_id GROUP BY course_offering.semester ORDER BY course_offering.semester


Generated Query Results (Normalized):
   ratio  semester
0    0.5         2
1    0.5         4
2    2.0         1
3    2.0         3

Gold Query Results (Normalized):
   ratio  semester
0    0.5         2
1    0.5         4
2    2.0         1
3    2.0         3
78: Exact Match: True, Subset Match: True


Processing 79th question: What is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York? on database: restaurants
Generation: SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM restaurant WHERE city_name ILIKE '%New York%'


Generated Query Results (Normalized):
   ratio
0    2.0

Gold Query Results (Normalized):
   ratio
0    2.0
79: Exact Match: True, Subset Match: True


Processing 80th question: What is the total number of publications in each journal, ordered by the number of publications in descending order? on database: academic
Generation: SELECT journal.name, COUNT(publication.pid) AS total_publications FROM journal JOIN publication ON journal.jid = publication.jid GROUP BY journal.name ORDER BY total_publications DESC NULLS LAST


Generated Query Results (Normalized):
                                          name  total_publications
0                                       Nature                   3
1         Journal of Machine Learning Research                   1
2  Journal of Artificial Intelligence Research                   1

Gold Query Results (Normalized):
                                          name  total_publications
0                                       Nature                   3
1         Journal of Machine Learning Research                   1
2  Journal of Artificial Intelligence Research                   1
80: Exact Match: True, Subset Match: True


Processing 81th question: What is the total count of check-ins for each business id? on database: yelp
Generation: SELECT checkin.business_id, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.business_id ORDER BY total_checkins DESC NULLS LAST


Generated Query Results (Normalized):
  business_id  total_checkins
0      abc123            23.0
1      def456            34.0
2      ghi789            23.0
3      jkl012            51.0
4      mno345            49.0
5      uvw456             2.0
6      xyz123            10.0

Gold Query Results (Normalized):
  business_id  total_checkins
0      abc123            23.0
1      def456            34.0
2      ghi789            23.0
3      jkl012            51.0
4      mno345            49.0
5      uvw456             2.0
6      xyz123            10.0
81: Exact Match: True, Subset Match: True


Processing 82th question: Return the salesperson ID, first name and last name for salespersons that have no sales records, by doing a left join from the salespersons to sales table. on database: car_dealership
Generation: SELECT s.id, s.first_name, s.last_name FROM salespersons s LEFT JOIN sales sa ON s.id = sa.salesperson_id WHERE sa.id IS NULL


Generated Query Results (Normalized):
  first_name  id  last_name
0      David   5     Wilson
1      James   9    Jackson
2   Jennifer  12      Davis
3    Jessica  13  Rodriguez
4     Olivia   8     Thomas
5     Robert  11    Johnson
6     Sophia  10      White

Gold Query Results (Normalized):
  first_name  id  last_name
0      David   5     Wilson
1      James   9    Jackson
2   Jennifer  12      Davis
3    Jessica  13  Rodriguez
4     Olivia   8     Thomas
5     Robert  11    Johnson
6     Sophia  10      White
82: Exact Match: True, Subset Match: True


Processing 83th question: What are the easiness scores for courses in the "Computer Science" department? Show both courses and scores. on database: advising
Generation: SELECT {course.name, course.course_id}, course.easiness_score FROM course WHERE course.department ILIKE '%Computer Science%'

Error executing query: SELECT {course.name, course.course_id}, course.easiness_score FROM course WHERE course.department ILIKE '%Computer Science%'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {course.name, course.course_id}, course.easiness_scor...
               ^

[SQL: SELECT {course.name, course.course_id}, course.easiness_score FROM course WHERE course.department ILIKE '%%Computer Science%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
83: Exact Match: False, Subset Match: False


Processing 84th question: Which airlines offer flights with a stopover in Dallas? on database: atis
Generation: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code JOIN airport ON flight.from_airport = airport.airport_code JOIN airport_service ON airport.airport_code = airport_service.airport_code WHERE airport_service.city_code = 'DAL' AND airport_service.direction = 'D'

Error executing query: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code JOIN airport ON flight.from_airport = airport.airport_code JOIN airport_service ON airport.airport_code = airport_service.airport_code WHERE airport_service.city_code = 'DAL' AND airport_service.direction = 'D'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT DISTINCT {airline.airline_name, airline.airline_code}...
                        ^

[SQL: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code JOIN airport ON flight.from_airport = airport.airport_code JOIN airport_service ON airport.airport_code = airport_service.airport_code WHERE airport_service.city_code = 'DAL' AND airport_service.direction = 'D']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
84: Exact Match: False, Subset Match: False


Processing 85th question: How many treatments for diagnoses containing 'psoriasis' (match with wildcards case-insensitively) involve drugs that have been FDA-approved and the treatments have ended within the last 6 months from today? on database: derm_treatment
Generation: SELECT COUNT(*) AS num_treatments FROM treatments t JOIN diagnoses d ON t.diag_id = d.diag_id JOIN drugs dr ON t.drug_id = dr.drug_id WHERE d.diag_name ILIKE '%psoriasis%' AND dr.fda_appr_dt IS NOT NULL AND t.end_dt >= CURRENT_DATE - INTERVAL '6 months'


Generated Query Results (Normalized):
   num_treatments
0               2

Gold Query Results (Normalized):
   num_treatments
0               2
85: Exact Match: True, Subset Match: True


Processing 86th question: What is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams? on database: advising
Generation: SELECT CAST(SUM(CASE WHEN c.has_exams THEN c.num_enrolled ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN NOT c.has_exams THEN c.num_enrolled ELSE 0 END), 0) AS ratio FROM course c


Generated Query Results (Normalized):
   ratio
0    3.0

Gold Query Results (Normalized):
   ratio
0    3.0
86: Exact Match: True, Subset Match: True


Processing 87th question: What are the aircraft codes for all aircraft with a cruising speed of over 200 mph? sort the aircraft codes in ascending order. on database: atis
Generation: SELECT aircraft.aircraft_code FROM aircraft WHERE aircraft.cruising_speed > 200 ORDER BY aircraft.aircraft_code


Generated Query Results (Normalized):
  aircraft_code
0          A320
1          A330
2          A350
3          A380
4          B737
5          B747
6          B777
7          B787
8        CRJ200
9          E190

Gold Query Results (Normalized):
  aircraft_code
0          A320
1          A330
2          A350
3          A380
4          B737
5          B747
6          B777
7          B787
8        CRJ200
9          E190
87: Exact Match: True, Subset Match: True


Processing 88th question: What are the top 5 countries by total transaction amount in the past 30 days, inclusive of 30 days ago? Return the country name, number of transactions and total transaction amount. on database: broker_context
Generation: SELECT c.sbCustCountry, COUNT(*) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE t.sbTxDateTime >= CURRENT_DATE - INTERVAL '30 days' GROUP BY c.sbCustCountry ORDER BY total_amount DESC LIMIT 5

Error executing query: SELECT c.sbCustCountry, COUNT(*) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE t.sbTxDateTime >= CURRENT_DATE - INTERVAL '30 days' GROUP BY c.sbCustCountry ORDER BY total_amount DESC LIMIT 5
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
88: Exact Match: False, Subset Match: False


Processing 89th question: How many restaurants are there in each region? on database: restaurants
Generation: SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region


Generated Query Results (Normalized):
   number_of_restaurants      region
0                      2     Florida
1                      3    New York
2                      6  California

Gold Query Results (Normalized):
   number_of_restaurants      region
0                      2     Florida
1                      3    New York
2                      6  California
89: Exact Match: True, Subset Match: True


Processing 90th question: Lowest daily closest price for symbol `VTI` in the past 7 days on database: broker_context
Generation: SELECT sbDpDate, sbDpLow FROM sbDailyPrice WHERE sbDpTickerId = (SELECT sbTickerId FROM sbTicker WHERE sbTickerSymbol = 'VTI') AND sbDpDate >= CURRENT_DATE - INTERVAL '7 days' ORDER BY sbDpDate LIMIT 1

Error executing query: SELECT sbDpDate, sbDpLow FROM sbDailyPrice WHERE sbDpTickerId = (SELECT sbTickerId FROM sbTicker WHERE sbTickerSymbol = 'VTI') AND sbDpDate >= CURRENT_DATE - INTERVAL '7 days' ORDER BY sbDpDate LIMIT 1
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
90: Exact Match: False, Subset Match: False


Processing 91th question: Which states have fewer than a hundred thousand people? on database: geography
Generation: SELECT state_name FROM state WHERE population < 100000


Generated Query Results (Normalized):
  state_name
0    England
1       Ohio
2    Ontario
3  Sao Paulo
4      Texas
5      Tokyo

Gold Query Results (Normalized):
  state_name
0    England
1       Ohio
2    Ontario
3  Sao Paulo
4      Texas
5      Tokyo
91: Exact Match: True, Subset Match: True


Processing 92th question: List the last name, year of registration, and first treatment (date and id) by doctors who were registered 2 years ago. on database: derm_treatment
Generation: SELECT d.last_name, d.year_reg, t.start_dt, t.treatment_id FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE d.year_reg < CURRENT_DATE - INTERVAL '2 years' ORDER BY d.last_name, t.start_dt

Error executing query: SELECT d.last_name, d.year_reg, t.start_dt, t.treatment_id FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE d.year_reg < CURRENT_DATE - INTERVAL '2 years' ORDER BY d.last_name, t.start_dt
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: integer < timestamp without time zone
LINE 1: ...atments t ON d.doc_id = t.doc_id WHERE d.year_reg < CURRENT_...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT d.last_name, d.year_reg, t.start_dt, t.treatment_id FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE d.year_reg < CURRENT_DATE - INTERVAL '2 years' ORDER BY d.last_name, t.start_dt]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
92: Exact Match: False, Subset Match: False


Processing 93th question: What is the ratio of publications presented in conferences to publications published in journals? on database: academic
Generation: SELECT CAST(COUNT(DISTINCT CASE WHEN cid IS NOT NULL THEN pid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN jid IS NOT NULL THEN pid END), 0) AS ratio FROM publication


Generated Query Results (Normalized):
   ratio
0    1.0

Gold Query Results (Normalized):
   ratio
0    1.0
93: Exact Match: True, Subset Match: True


Processing 94th question: What are the titles of the papers published in the year 2020, ordered alphabetically? on database: scholar
Generation: SELECT paper.title FROM paper WHERE paper.year = 2020 ORDER BY paper.title


Generated Query Results (Normalized):
                                          title
0        A Study on Machine Learning Algorithms
1                    COVID-19 Impact on Society
2  The Effects of Climate Change on Agriculture

Gold Query Results (Normalized):
                                          title
0        A Study on Machine Learning Algorithms
1                    COVID-19 Impact on Society
2  The Effects of Climate Change on Agriculture
94: Exact Match: True, Subset Match: True


Processing 95th question: What is the ratio of helpfulness scores to clarity scores for each course ID? on database: advising
Generation: SELECT course.course_id, CAST(course.helpfulness_score AS FLOAT) / NULLIF(course.clarity_score, 0) AS ratio FROM course


Generated Query Results (Normalized):
   course_id  ratio
0          1   0.80
1          2   0.75
2          3   1.25
3          4   2.50

Gold Query Results (Normalized):
   course_id  ratio
0          1   0.80
1          2   0.75
2          3   1.25
3          4   2.50
95: Exact Match: True, Subset Match: True


Processing 96th question: What are the top 5 countries by number of customers? Return the country name and number of customers. on database: broker_context
Generation: SELECT sbCustCountry, COUNT(*) AS num_customers FROM sbCustomer GROUP BY sbCustCountry ORDER BY num_customers DESC LIMIT 5

Error executing query: SELECT sbCustCountry, COUNT(*) AS num_customers FROM sbCustomer GROUP BY sbCustCountry ORDER BY num_customers DESC LIMIT 5
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
96: Exact Match: False, Subset Match: False


Processing 97th question: How many reviews were written for businesses located in California in the last 10 months? on database: yelp
Generation: SELECT COUNT(*) AS review_count FROM review r JOIN business b ON r.business_id = b.business_id WHERE b.state = 'CA' AND r.month ILIKE '%2020-09%' OR r.month ILIKE '%2020-10%' OR r.month ILIKE '%2020-11%' OR r.month ILIKE '%2020-12%' OR r.month ILIKE '%2021-01%' OR r.month ILIKE '%2021-02%' OR r.month ILIKE '%2021-03%' OR r.month ILIKE '%2021-04%' OR r.month ILIKE '%2021-05%'


Generated Query Results (Normalized):
   review_count
0             0

Gold Query Results (Normalized):
   review_count
0             0
97: Exact Match: True, Subset Match: True


Processing 98th question: What is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD) for each airline, sorted in descending order by average cost? on database: atis
Generation: SELECT fare.fare_airline, AVG(fare.round_trip_cost) AS average_cost
FROM fare
WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD'
GROUP BY fare.fare_airline
ORDER BY average_cost DESC NULLS LAST


Generated Query Results (Normalized):
   average_cost fare_airline
0         500.0           VX
1         400.0           HA

Gold Query Results (Normalized):
   average_cost fare_airline
0         500.0           VX
1         400.0           HA
98: Exact Match: True, Subset Match: True


Processing 99th question: Count the number of flight departures for each month? on database: atis
Generation: SELECT month.month_name, COUNT(flight.flight_id) AS num_departures FROM flight JOIN month ON flight.flight_days ILIKE '%' || month.month_name || '%' GROUP BY month.month_name ORDER BY num_departures DESC NULLS LAST

Generated query returned no results.
99: Exact Match: False, Subset Match: False


Processing 100th question: Which users did not get a notification within the first year of signing up? Return their usernames, emails and signup dates. on database: ewallet
Generation: SELECT u.username, u.email, u.created_at FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id WHERE n.id IS NULL AND u.created_at < CURRENT_DATE - INTERVAL '1 year'


Generated Query Results (Normalized):
           created_at                 email    username
0 2023-09-05 15:20:00  lisa.jones@email.com  lisa_jones

Gold Query Results (Normalized):
           created_at                 email    username
0 2023-09-05 15:20:00  lisa.jones@email.com  lisa_jones
100: Exact Match: True, Subset Match: True


Processing 101th question: What are the publications written by authors from the 'Sociology' domain and presented at conferences in the year 2020? on database: academic
Generation: SELECT {publication.title, publication.pid} FROM publication JOIN domain_author ON domain_author.aid = writes.aid JOIN domain ON domain_author.did = domain.did WHERE domain.name ILIKE '%Sociology%' AND publication.year = 2020 AND publication.cid = domain_conference.cid

Error executing query: SELECT {publication.title, publication.pid} FROM publication JOIN domain_author ON domain_author.aid = writes.aid JOIN domain ON domain_author.did = domain.did WHERE domain.name ILIKE '%Sociology%' AND publication.year = 2020 AND publication.cid = domain_conference.cid
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {publication.title, publication.pid} FROM publication...
               ^

[SQL: SELECT {publication.title, publication.pid} FROM publication JOIN domain_author ON domain_author.aid = writes.aid JOIN domain ON domain_author.did = domain.did WHERE domain.name ILIKE '%%Sociology%%' AND publication.year = 2020 AND publication.cid = domain_conference.cid]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
101: Exact Match: False, Subset Match: False


Processing 102th question: How many months between June 2021 and December 2021 had reviews? on database: yelp
Generation: SELECT COUNT(DISTINCT month) AS months_with_reviews FROM review WHERE month BETWEEN 'June 2021' AND 'December 2021'


Generated Query Results (Normalized):
   months_with_reviews
0                    0

Gold Query Results (Normalized):
   months_with_reviews
0                    0
102: Exact Match: True, Subset Match: True


Processing 103th question: What are the top 10 ticker symbols by total transaction amount? Return the ticker symbol, number of transactions and total transaction amount. on database: broker_context
Generation: SELECT t.sbTickerSymbol, COUNT(*) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbTransaction t JOIN sbTicker s ON t.sbTxTickerId = s.sbTickerId GROUP BY t.sbTxTickerId ORDER BY total_amount DESC LIMIT 10

Error executing query: SELECT t.sbTickerSymbol, COUNT(*) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbTransaction t JOIN sbTicker s ON t.sbTxTickerId = s.sbTickerId GROUP BY t.sbTxTickerId ORDER BY total_amount DESC LIMIT 10
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
103: Exact Match: False, Subset Match: False


Processing 104th question: Which author had the most publications in the year 2021 and how many publications did he/she have that year? on database: academic
Generation: SELECT {author.name, author.aid}, COUNT(publication.pid) AS num_publications FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY {} ORDER BY num_publications DESC NULLS LAST LIMIT 1

Error executing query: SELECT {author.name, author.aid}, COUNT(publication.pid) AS num_publications FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY {} ORDER BY num_publications DESC NULLS LAST LIMIT 1
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {author.name, author.aid}, COUNT(publication.pid) AS ...
               ^

[SQL: SELECT {author.name, author.aid}, COUNT(publication.pid) AS num_publications FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY {} ORDER BY num_publications DESC NULLS LAST LIMIT 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
104: Exact Match: False, Subset Match: False


Processing 105th question: What is the ratio of open businesses to closed businesses in the city of San Francisco? on database: yelp
Generation: SELECT CAST(SUM(CASE WHEN is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM business WHERE city ILIKE '%San Francisco%'


Generated Query Results (Normalized):
   ratio
0    2.0

Gold Query Results (Normalized):
   ratio
0    2.0
105: Exact Match: True, Subset Match: True


Processing 106th question: What is the total cost of round-trip fares for each airline code? on database: atis
Generation: SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare GROUP BY fare.fare_airline ORDER BY total_round_trip_cost DESC NULLS LAST


Generated Query Results (Normalized):
  fare_airline  total_round_trip_cost
0           AA                  950.0
1           AS                  400.0
2           F9                  400.0
3           HA                  400.0
4           UA                  680.0
5           VX                  500.0
6           WN                  350.0

Gold Query Results (Normalized):
  fare_airline  total_round_trip_cost
0           AA                  950.0
1           AS                  400.0
2           F9                  400.0
3           HA                  400.0
4           UA                  680.0
5           VX                  500.0
6           WN                  350.0
106: Exact Match: True, Subset Match: True


Processing 107th question: Get the cities in the United States and their population on database: geography
Generation: SELECT city.city_name, city.population FROM city WHERE city.country_name ILIKE '%United States%'


Generated Query Results (Normalized):
     city_name  population
0      Chicago     1500000
1      Houston     2000000
2  Los Angeles     5000000
3     New York     1000000

Gold Query Results (Normalized):
     city_name  population
0      Chicago     1500000
1      Houston     2000000
2  Los Angeles     5000000
3     New York     1000000
107: Exact Match: True, Subset Match: True


Processing 108th question: What is the total number of papers associated with each dataset? on database: scholar
Generation: SELECT paperdataset.datasetid, COUNT(DISTINCT paperdataset.paperid) AS total_papers FROM paperdataset GROUP BY paperdataset.datasetid ORDER BY total_papers DESC NULLS LAST


Generated Query Results (Normalized):
   datasetid  total_papers
0          1             1
1          2             2
2          3             2
3          4             1

Gold Query Results (Normalized):
   datasetid  total_papers
0          1             1
1          2             2
2          3             2
3          4             1
108: Exact Match: True, Subset Match: True


Processing 109th question: Return the customer who made the most sell transactions on 2023-04-01. Return the id, name and number of transactions. on database: broker_context
Generation: SELECT c.sbCustId, c.sbCustName, COUNT(*) AS num_transactions FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE t.sbTxDateTime::date = '2023-04-01' AND t.sbTxType = 'sell' GROUP BY c.sbCustId ORDER BY num_transactions DESC LIMIT 1

Error executing query: SELECT c.sbCustId, c.sbCustName, COUNT(*) AS num_transactions FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE t.sbTxDateTime::date = '2023-04-01' AND t.sbTxType = 'sell' GROUP BY c.sbCustId ORDER BY num_transactions DESC LIMIT 1
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
109: Exact Match: False, Subset Match: False


Processing 110th question: What is the average clarity score for each instructor who taught a course? on database: advising
Generation: SELECT {instructor.name, instructor.uniqname}, AVG(course.clarity_score) AS average_clarity_score FROM course JOIN instructor ON course.instructor_id = instructor.instructor_id GROUP BY {} ORDER BY average_clarity_score DESC NULLS LAST

Error executing query: SELECT {instructor.name, instructor.uniqname}, AVG(course.clarity_score) AS average_clarity_score FROM course JOIN instructor ON course.instructor_id = instructor.instructor_id GROUP BY {} ORDER BY average_clarity_score DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {instructor.name, instructor.uniqname}, AVG(course.cl...
               ^

[SQL: SELECT {instructor.name, instructor.uniqname}, AVG(course.clarity_score) AS average_clarity_score FROM course JOIN instructor ON course.instructor_id = instructor.instructor_id GROUP BY {} ORDER BY average_clarity_score DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
110: Exact Match: False, Subset Match: False


Processing 111th question: What are the top 3 transaction statuses by number of transactions? Return the status and number of transactions. on database: broker_context
Generation: SELECT sbTxStatus, COUNT(*) AS num_transactions FROM sbTransaction GROUP BY sbTxStatus ORDER BY num_transactions DESC LIMIT 3

Error executing query: SELECT sbTxStatus, COUNT(*) AS num_transactions FROM sbTransaction GROUP BY sbTxStatus ORDER BY num_transactions DESC LIMIT 3
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
111: Exact Match: False, Subset Match: False


Processing 112th question: What is the total number of publications presented in each conference? on database: academic
Generation: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY {} ORDER BY total_publications DESC NULLS LAST

Error executing query: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY {} ORDER BY total_publications DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {conference.name, conference.cid}, COUNT(DISTINCT pub...
               ^

[SQL: SELECT {conference.name, conference.cid}, COUNT(DISTINCT publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY {} ORDER BY total_publications DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
112: Exact Match: False, Subset Match: False


Processing 113th question: How does the ratio of enrolled students to the number of reviews vary across different courses? on database: advising
Generation: SELECT {course.name, course.course_id}, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS ratio FROM course ORDER BY ratio DESC NULLS LAST

Error executing query: SELECT {course.name, course.course_id}, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS ratio FROM course ORDER BY ratio DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {course.name, course.course_id}, CAST(course.num_enro...
               ^

[SQL: SELECT {course.name, course.course_id}, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS ratio FROM course ORDER BY ratio DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
113: Exact Match: False, Subset Match: False


Processing 114th question: For treatments that ended in the year 2022 (from Jan 1st to Dec 31st inclusive), what is the average PASI score at day 100 and number of distinct patients per insurance type? Return the top 5 insurance types sorted by lowest average PASI score first. on database: derm_treatment
Generation: SELECT t.ins_type, COUNT(DISTINCT p.patient_id) AS num_patients, AVG(o.day100_pasi_score) AS avg_pasi_score FROM treatments t JOIN patients p ON t.patient_id = p.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE t.end_dt BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY t.ins_type ORDER BY avg_pasi_score LIMIT 5

Error executing query: SELECT t.ins_type, COUNT(DISTINCT p.patient_id) AS num_patients, AVG(o.day100_pasi_score) AS avg_pasi_score FROM treatments t JOIN patients p ON t.patient_id = p.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE t.end_dt BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY t.ins_type ORDER BY avg_pasi_score LIMIT 5
Error: (psycopg2.errors.UndefinedColumn) column t.ins_type does not exist
LINE 1: SELECT t.ins_type, COUNT(DISTINCT p.patient_id) AS num_patie...
               ^
HINT:  Perhaps you meant to reference the column "p.ins_type".

[SQL: SELECT t.ins_type, COUNT(DISTINCT p.patient_id) AS num_patients, AVG(o.day100_pasi_score) AS avg_pasi_score FROM treatments t JOIN patients p ON t.patient_id = p.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE t.end_dt BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY t.ins_type ORDER BY avg_pasi_score LIMIT 5]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
114: Exact Match: False, Subset Match: False


Processing 115th question: What are the total number of customer signups for the top 2 states? Return the state and total signups, starting from the top. on database: car_dealership
Generation: SELECT state, COUNT(*) AS total_signups FROM customers GROUP BY state ORDER BY total_signups DESC LIMIT 2


Generated Query Results (Normalized):
  state  total_signups
0    CA              4
1    TX              3

Gold Query Results (Normalized):
  state  total_signups
0    CA              4
1    TX              3
115: Exact Match: True, Subset Match: True


Processing 116th question: Return the treatment id, treatment start date, adverse event date and description of all adverse events that occured within 10 days after starting treatment on database: derm_treatment
Generation: SELECT t.treatment_id, t.start_dt, ae.reported_dt, ae.description FROM treatments t JOIN adverse_events ae ON t.treatment_id = ae.treatment_id WHERE ae.reported_dt BETWEEN t.start_dt AND t.start_dt + INTERVAL '10 days'


Generated Query Results (Normalized):
                                         description  ... treatment_id
0                                     Mild skin rash  ...           14
1  Severe allergic reaction, hospitalization requ...  ...            4

[2 rows x 4 columns]

Gold Query Results (Normalized):
                                         description  ... treatment_id
0                                     Mild skin rash  ...           14
1  Severe allergic reaction, hospitalization requ...  ...            4

[2 rows x 4 columns]
116: Exact Match: True, Subset Match: True


Processing 117th question: How many courses are offered for each semester id? on database: advising
Generation: SELECT course_offering.semester, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM course_offering GROUP BY course_offering.semester ORDER BY num_courses DESC NULLS LAST


Generated Query Results (Normalized):
   num_courses  semester
0            2         1
1            2         2
2            2         3
3            2         4

Gold Query Results (Normalized):
   num_courses  semester
0            2         1
1            2         2
2            2         3
3            2         4
117: Exact Match: True, Subset Match: True


Processing 118th question: What is the total number of students who found the instructor to be hilarious per course id? on database: advising
Generation: SELECT course_tags_count.course_id, SUM(course_tags_count.hilarious) AS total_hilarious_students FROM course_tags_count GROUP BY course_tags_count.course_id ORDER BY total_hilarious_students DESC NULLS LAST


Generated Query Results (Normalized):
   course_id  total_hilarious_students
0          1                       3.0
1          2                       2.0
2          3                       1.0
3          4                       1.0

Gold Query Results (Normalized):
   course_id  total_hilarious_students
0          1                       3.0
1          2                       2.0
2          3                       1.0
3          4                       1.0
118: Exact Match: True, Subset Match: True


Processing 119th question: What's the earliest flight departure time in the day in HH:MM? on database: atis
Generation: SELECT to_char(departure_time, 'HH24:MI') AS earliest_departure_time FROM flight ORDER BY earliest_departure_time LIMIT 1


Generated Query Results (Normalized):
  earliest_departure_time
0                  HH24: 

Gold Query Results (Normalized):
  earliest_departure_time
0                  HH24: 
119: Exact Match: True, Subset Match: True


Processing 120th question: what was the average user session duration in seconds split by device_type? on database: ewallet
Generation: SELECT device_type, AVG(EXTRACT(EPOCH FROM session_end_ts - session_start_ts)) AS average_session_duration_seconds FROM consumer_div.user_sessions GROUP BY device_type ORDER BY average_session_duration_seconds DESC


Generated Query Results (Normalized):
   average_session_duration_seconds device_type
0                       1351.333333     web_app
1                       1765.875000  mobile_app

Gold Query Results (Normalized):
   average_session_duration_seconds device_type
0                       1351.333333     web_app
1                       1765.875000  mobile_app
120: Exact Match: True, Subset Match: True


Processing 121th question: Which course has the highest number of enrolled students, and what is the enrollment number? on database: advising
Generation: SELECT {course.name, course.course_id}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1

Error executing query: SELECT {course.name, course.course_id}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {course.name, course.course_id}, course.num_enrolled ...
               ^

[SQL: SELECT {course.name, course.course_id}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
121: Exact Match: False, Subset Match: False


Processing 122th question: Which airlines offer flights from LAX to ORD? on database: atis
Generation: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD'

Error executing query: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT DISTINCT {airline.airline_name, airline.airline_code}...
                        ^

[SQL: SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
122: Exact Match: False, Subset Match: False


Processing 123th question: What is the total number of reviews for each business category? on database: yelp
Generation: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST

Error executing query: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {category.category_name, category.id}, SUM(review.rat...
               ^

[SQL: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
123: Exact Match: False, Subset Match: False


Processing 124th question: How many students have declared a major in each program? on database: advising
Generation: SELECT {program.name, program.program_id}, COUNT(DISTINCT student.student_id) AS num_students
FROM student
JOIN program ON student.program_id = program.program_id
WHERE student.declare_major IS NOT NULL
GROUP BY {}
ORDER BY num_students DESC NULLS LAST

Error executing query: SELECT {program.name, program.program_id}, COUNT(DISTINCT student.student_id) AS num_students
FROM student
JOIN program ON student.program_id = program.program_id
WHERE student.declare_major IS NOT NULL
GROUP BY {}
ORDER BY num_students DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {program.name, program.program_id}, COUNT(DISTINCT st...
               ^

[SQL: SELECT {program.name, program.program_id}, COUNT(DISTINCT student.student_id) AS num_students
FROM student
JOIN program ON student.program_id = program.program_id
WHERE student.declare_major IS NOT NULL
GROUP BY {}
ORDER BY num_students DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
124: Exact Match: False, Subset Match: False


Processing 125th question: What are the top 5 domains with the highest number of authors associated with them? on database: academic
Generation: SELECT {domain.name, domain.did}, COUNT(DISTINCT domain_author.aid) AS num_authors FROM domain JOIN domain_author ON domain.did = domain_author.did GROUP BY {} ORDER BY num_authors DESC LIMIT 5

Error executing query: SELECT {domain.name, domain.did}, COUNT(DISTINCT domain_author.aid) AS num_authors FROM domain JOIN domain_author ON domain.did = domain_author.did GROUP BY {} ORDER BY num_authors DESC LIMIT 5
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {domain.name, domain.did}, COUNT(DISTINCT domain_auth...
               ^

[SQL: SELECT {domain.name, domain.did}, COUNT(DISTINCT domain_author.aid) AS num_authors FROM domain JOIN domain_author ON domain.did = domain_author.did GROUP BY {} ORDER BY num_authors DESC LIMIT 5]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
125: Exact Match: False, Subset Match: False


Processing 126th question: Which lakes have a name that starts with "Lake"? They should be located in states with an area greater than 1000 square kilometers. on database: geography
Generation: SELECT lake.lake_name FROM lake JOIN state ON lake.state_name = state.state_name WHERE state.area > 1000 AND lake.lake_name ILIKE 'Lake%'


Generated Query Results (Normalized):
       lake_name
0      Lake Erie
1     Lake Huron
2  Lake Michigan
3   Lake Ontario
4  Lake Superior

Gold Query Results (Normalized):
       lake_name
0      Lake Erie
1     Lake Huron
2  Lake Michigan
3   Lake Ontario
4  Lake Superior
126: Exact Match: True, Subset Match: True


Processing 127th question: What is the ratio of the number of businesses in each state to the total number of businesses in the database? on database: yelp
Generation: SELECT state, CAST(COUNT(*) AS FLOAT) / NULLIF(SUM(COUNT(*)) OVER (), 0) AS ratio FROM business GROUP BY state ORDER BY ratio DESC NULLS LAST


Generated Query Results (Normalized):
      ratio state
0  0.428571    NY
1  0.571429    CA

Gold Query Results (Normalized):
      ratio state
0  0.428571    NY
1  0.571429    CA
127: Exact Match: True, Subset Match: True


Processing 128th question: How many authors have published more than 2 papers? on database: scholar
Generation: SELECT COUNT(*) AS number_of_authors FROM writes WHERE paperid IN (SELECT paperid FROM writes GROUP BY authorid HAVING COUNT(*) > 2)

Error executing query: SELECT COUNT(*) AS number_of_authors FROM writes WHERE paperid IN (SELECT paperid FROM writes GROUP BY authorid HAVING COUNT(*) > 2)
Error: (psycopg2.errors.GroupingError) column "writes.paperid" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...r_of_authors FROM writes WHERE paperid IN (SELECT paperid FR...
                                                             ^

[SQL: SELECT COUNT(*) AS number_of_authors FROM writes WHERE paperid IN (SELECT paperid FROM writes GROUP BY authorid HAVING COUNT(*) > 2)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
128: Exact Match: False, Subset Match: False


Processing 129th question: What are the top 3 doctor specialties by total drug amount prescribed for treatments started in the past 6 calendar months? Return the specialty, number of treatments, and total drug amount. on database: derm_treatment
Generation: SELECT d.specialty, COUNT(*) AS num_treatments, SUM(t.tot_drug_amt) AS total_drug_amt FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id WHERE t.start_dt >= CURRENT_DATE - INTERVAL '6 months' GROUP BY d.specialty ORDER BY total_drug_amt DESC LIMIT 3


Generated Query Results (Normalized):
   num_treatments    specialty  total_drug_amt
0               1      general           300.0
1               3   immunology           580.0
2               4  dermatology           690.0

Gold Query Results (Normalized):
   num_treatments    specialty  total_drug_amt
0               1      general           300.0
1               3   immunology           580.0
2               4  dermatology           690.0
129: Exact Match: True, Subset Match: True


Processing 130th question: What is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course id? on database: advising
Generation: SELECT course.course_id, CAST(course_tags_count.clear_grading AS FLOAT) / NULLIF(course_tags_count.good_feedback, 0) AS ratio FROM course JOIN course_tags_count ON course.course_id = course_tags_count.course_id


Generated Query Results (Normalized):
   course_id     ratio
0          1  1.250000
1          2  1.333333
2          3  1.500000
3          4  1.000000

Gold Query Results (Normalized):
   course_id     ratio
0          1  1.250000
1          2  1.333333
2          3  1.500000
3          4  1.000000
130: Exact Match: True, Subset Match: True


Processing 131th question: What is the total number of restaurants serving each type of food? on database: restaurants
Generation: SELECT restaurant.food_type, COUNT(DISTINCT restaurant.id) AS total_restaurants FROM restaurant GROUP BY restaurant.food_type ORDER BY total_restaurants DESC NULLS LAST


Generated Query Results (Normalized):
  food_type  total_restaurants
0  American                  3
1   Italian                  2
2  Japanese                  2
3   Mexican                  1
4   Seafood                  2
5     Vegan                  1

Gold Query Results (Normalized):
  food_type  total_restaurants
0  American                  3
1   Italian                  2
2  Japanese                  2
3   Mexican                  1
4   Seafood                  2
5     Vegan                  1
131: Exact Match: True, Subset Match: True


Processing 132th question: Which authors are not part of any organization? on database: academic
Generation: SELECT name FROM author WHERE NOT aid IN (SELECT aid FROM organization)

Generated query returned no results.
132: Exact Match: False, Subset Match: False


Processing 133th question: How many publications were published in journals whose names start with the letter "J"? on database: academic
Generation: SELECT COUNT(DISTINCT publication.pid) AS number_of_publications FROM publication JOIN journal ON publication.jid = journal.jid WHERE journal.name ILIKE 'J%'


Generated Query Results (Normalized):
   number_of_publications
0                       2

Gold Query Results (Normalized):
   number_of_publications
0                       2
133: Exact Match: True, Subset Match: True


Processing 134th question: What was the message that came with the tip made exactly 2 months after March 2021? on database: yelp
Generation: SELECT text FROM tip WHERE month = 'April' AND year = 2021 LIMIT 1


Generated Query Results (Normalized):
                          text
0  Highly recommend the steak.

Gold Query Results (Normalized):
                          text
0  Highly recommend the steak.
134: Exact Match: True, Subset Match: True


Processing 135th question: How many flights depart from each airport code, excluding departures with connections? on database: atis
Generation: SELECT flight.from_airport, COUNT(flight.flight_id) AS num_flights
FROM flight
WHERE flight.connections = 0
GROUP BY flight.from_airport
ORDER BY num_flights DESC


Generated Query Results (Normalized):
  from_airport  num_flights
0          JFK            1
1          LAX            1
2          ORD            3

Gold Query Results (Normalized):
  from_airport  num_flights
0          JFK            1
1          LAX            1
2          ORD            3
135: Exact Match: True, Subset Match: True


Processing 136th question: What is the total number of students who have taken a course with a final project or exam? on database: advising
Generation: SELECT COUNT(DISTINCT student_record.student_id) AS total_students
FROM student_record
JOIN course_offering ON student_record.course_id = course_offering.course_id
WHERE course_offering.has_final_project = TRUE OR course_offering.has_final_exam = TRUE


Generated Query Results (Normalized):
   total_students
0               5

Gold Query Results (Normalized):
   total_students
0               5
136: Exact Match: True, Subset Match: True


Processing 137th question: How many restaurants serve Italian food in each city? on database: restaurants
Generation: SELECT location.city_name, COUNT(*) AS number_of_restaurants FROM restaurant JOIN location ON restaurant.city_name = location.city_name WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST


Generated Query Results (Normalized):
     city_name  number_of_restaurants
0  Los Angeles                      3
1     New York                      3

Gold Query Results (Normalized):
     city_name  number_of_restaurants
0  Los Angeles                      3
1     New York                      3
137: Exact Match: True, Subset Match: True


Processing 138th question: What are the top 2 specialties by number of doctors? Return the specialty and number of doctors. on database: derm_treatment
Generation: SELECT specialty, COUNT(*) AS num_doctors FROM doctors GROUP BY specialty ORDER BY num_doctors DESC LIMIT 2


Generated Query Results (Normalized):
   num_doctors    specialty
0            3   immunology
1            4  dermatology

Gold Query Results (Normalized):
   num_doctors    specialty
0            3   immunology
1            4  dermatology
138: Exact Match: True, Subset Match: True


Processing 139th question: Which papers have the highest number of authors, ordered by the number of authors in descending order? on database: scholar
Generation: SELECT {paper.title, paper.paperid} FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY writes.paperid ORDER BY COUNT(DISTINCT writes.authorid) DESC NULLS LAST

Error executing query: SELECT {paper.title, paper.paperid} FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY writes.paperid ORDER BY COUNT(DISTINCT writes.authorid) DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {paper.title, paper.paperid} FROM paper JOIN writes O...
               ^

[SQL: SELECT {paper.title, paper.paperid} FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY writes.paperid ORDER BY COUNT(DISTINCT writes.authorid) DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
139: Exact Match: False, Subset Match: False


Processing 140th question: What is the total number of reviews for each category in the state of "California"? on database: yelp
Generation: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE business.state = 'California' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST

Error executing query: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE business.state = 'California' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST
Error: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 1: SELECT {category.category_name, category.id}, SUM(review.rat...
               ^

[SQL: SELECT {category.category_name, category.id}, SUM(review.rating) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE business.state = 'California' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
140: Exact Match: False, Subset Match: False


Processing 141th question: Return the distinct list of patient IDs, first names and last names that have outcome assessments. on database: derm_treatment
Generation: SELECT DISTINCT p.patient_id, p.first_name, p.last_name FROM patients p JOIN treatments t ON p.patient_id = t.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id


Generated Query Results (Normalized):
  first_name last_name  patient_id
0      Alice   Johnson           1
1        Bob     Smith           2
2      Carol     Davis           3
3      David    Wilson           4
4        Eve     Brown           5
5      Frank    Taylor           6
6      Grace  Anderson           7
7      Isaac  Martinez           9
8       John   Richter          10

Gold Query Results (Normalized):
  first_name last_name  patient_id
0      Alice   Johnson           1
1        Bob     Smith           2
2      Carol     Davis           3
3      David    Wilson           4
4        Eve     Brown           5
5      Frank    Taylor           6
6      Grace  Anderson           7
7      Isaac  Martinez           9
8       John   Richter          10
141: Exact Match: True, Subset Match: True


Processing 142th question: How does the ratio of authors to organizations differ by continent? on database: academic
Generation: SELECT organization.continent, CAST(COUNT(DISTINCT organization.oid) AS FLOAT) / NULLIF(COUNT(DISTINCT writes.aid), 0) AS ratio FROM organization JOIN writes ON organization.oid = writes.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST

Error executing query: SELECT organization.continent, CAST(COUNT(DISTINCT organization.oid) AS FLOAT) / NULLIF(COUNT(DISTINCT writes.aid), 0) AS ratio FROM organization JOIN writes ON organization.oid = writes.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST
Error: (psycopg2.errors.UndefinedColumn) column writes.oid does not exist
LINE 1: ...OM organization JOIN writes ON organization.oid = writes.oid...
                                                             ^
HINT:  Perhaps you meant to reference the column "writes.aid" or the column "writes.pid".

[SQL: SELECT organization.continent, CAST(COUNT(DISTINCT organization.oid) AS FLOAT) / NULLIF(COUNT(DISTINCT writes.aid), 0) AS ratio FROM organization JOIN writes ON organization.oid = writes.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
142: Exact Match: False, Subset Match: False


Processing 143th question: What is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order? on database: scholar
Generation: SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS total_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY paperkeyphrase.paperid ASC NULLS LAST


Generated Query Results (Normalized):
   paperid  total_keyphrases
0        1                 1
1        2                 1
2        3                 2
3        4                 1
4        5                 2

Gold Query Results (Normalized):
   paperid  total_keyphrases
0        1                 1
1        2                 1
2        3                 2
3        4                 1
4        5                 2
143: Exact Match: True, Subset Match: True


Processing 144th question: number of transactions by users who joined in the past 70 days on database: broker_context
Generation: SELECT COUNT(DISTINCT sbTxCustId) AS num_transactions, sbCustName FROM sbTransaction JOIN sbCustomer ON sbTxCustId = sbCustId WHERE sbCustJoinDate >= CURRENT_DATE - INTERVAL '70' DAY GROUP BY sbCustName ORDER BY num_transactions DESC

Error executing query: SELECT COUNT(DISTINCT sbTxCustId) AS num_transactions, sbCustName FROM sbTransaction JOIN sbCustomer ON sbTxCustId = sbCustId WHERE sbCustJoinDate >= CURRENT_DATE - INTERVAL '70' DAY GROUP BY sbCustName ORDER BY num_transactions DESC
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
144: Exact Match: False, Subset Match: False


Processing 145th question: What is the total number of students who participated actively for each course id, ordered from highest to lowest participants? on database: advising
Generation: SELECT course.course_id, course.name, course.number, course.credits, course_tags_count.participation, course_tags_count.participation / NULLIF(course.credits, 0) AS participation_ratio FROM course JOIN course_tags_count ON course.course_id = course_tags_count.course_id WHERE course_tags_count.participation > 0 ORDER BY participation_ratio DESC NULLS LAST

Error executing query: SELECT course.course_id, course.name, course.number, course.credits, course_tags_count.participation, course_tags_count.participation / NULLIF(course.credits, 0) AS participation_ratio FROM course JOIN course_tags_count ON course.course_id = course_tags_count.course_id WHERE course_tags_count.participation > 0 ORDER BY participation_ratio DESC NULLS LAST
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: text = integer
LINE 1: ....participation, course_tags_count.participation / NULLIF(cou...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT course.course_id, course.name, course.number, course.credits, course_tags_count.participation, course_tags_count.participation / NULLIF(course.credits, 0) AS participation_ratio FROM course JOIN course_tags_count ON course.course_id = course_tags_count.course_id WHERE course_tags_count.participation > 0 ORDER BY participation_ratio DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
145: Exact Match: False, Subset Match: False


Processing 146th question: What is the ratio of the altitude of 'Mount Everest' to the altitude of 'Dhaulagiri'? Match strings exactly on database: geography
Generation: SELECT CAST(mountain.mountain_altitude AS FLOAT) / NULLIF(highlow.highest_elevation, 0) AS ratio FROM mountain JOIN highlow ON mountain.state_name = highlow.state_name WHERE mountain.mountain_name ILIKE '%Everest%' AND highlow.highest_elevation ILIKE '%Dhaulagiri%'

Error executing query: SELECT CAST(mountain.mountain_altitude AS FLOAT) / NULLIF(highlow.highest_elevation, 0) AS ratio FROM mountain JOIN highlow ON mountain.state_name = highlow.state_name WHERE mountain.mountain_name ILIKE '%Everest%' AND highlow.highest_elevation ILIKE '%Dhaulagiri%'
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: text = integer
LINE 1: ...ELECT CAST(mountain.mountain_altitude AS FLOAT) / NULLIF(hig...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT CAST(mountain.mountain_altitude AS FLOAT) / NULLIF(highlow.highest_elevation, 0) AS ratio FROM mountain JOIN highlow ON mountain.state_name = highlow.state_name WHERE mountain.mountain_name ILIKE '%%Everest%%' AND highlow.highest_elevation ILIKE '%%Dhaulagiri%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
146: Exact Match: False, Subset Match: False


Processing 147th question: Return the customer id and the difference between their time from joining to their first transaction. Ignore customers who haven't made any transactions. on database: broker_context
Generation: SELECT c.sbCustId, MIN(t.sbTxDateTime) - c.sbCustJoinDate AS days_to_first_transaction FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId

Error executing query: SELECT c.sbCustId, MIN(t.sbTxDateTime) - c.sbCustJoinDate AS days_to_first_transaction FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
147: Exact Match: False, Subset Match: False


Processing 148th question: Return the name and phone number of the salesperson with the shortest time from being hired to getting fired. Return the number of days he/she was employed for. on database: car_dealership
Generation: SELECT s.first_name, s.last_name, s.phone, s.termination_date - s.hire_date AS days_employed FROM salespersons s ORDER BY days_employed LIMIT 1


Generated Query Results (Normalized):
   days_employed first_name last_name           phone
0            181     Olivia    Thomas  (333)-415-0000

Gold Query Results (Normalized):
   days_employed first_name last_name           phone
0            181     Olivia    Thomas  (333)-415-0000
148: Exact Match: True, Subset Match: True


Processing 149th question: What is the total number of papers published in each year? on database: scholar
Generation: SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY total_papers DESC NULLS LAST


Generated Query Results (Normalized):
   total_papers  year
0             2  2019
1             3  2020

Gold Query Results (Normalized):
   total_papers  year
0             2  2019
1             3  2020
149: Exact Match: True, Subset Match: True


Processed 150 rows.
Matched 85 rows.
Accuracy: 56.667%
