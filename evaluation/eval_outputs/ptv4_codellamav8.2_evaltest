Processing 0th question: What is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database. on database: restaurants
Generation: SELECT CAST(COUNT(DISTINCT CASE WHEN rating > 4.5 THEN id END) AS FLOAT) / NULLIF(COUNT(DISTINCT id), 0) AS ratio FROM restaurant


Generated Query Results (Normalized):
      ratio
0  0.272727

Gold Query Results (Normalized):
      ratio
0  0.272727
0: Exact Match: True, Subset Match: True


Processing 1th question: Which students have declared a minor program? List their firstname and lastname. Order the results by the students' last names. on database: advising
Generation: SELECT firstname, lastname FROM student WHERE declare_major IS NOT NULL AND declare_major <> ''


Generated Query Results (Normalized):
  firstname lastname
0      John    Smith
1      Jane      Doe
2     David  Johnson
3     Sarah    Brown
4   Michael   Wilson

Gold Query Results (Normalized):
  firstname lastname
0     Sarah    Brown
1      Jane      Doe
2     David  Johnson
3      John    Smith
4   Michael   Wilson
1: Exact Match: False, Subset Match: True


Processing 2th question: Return the student IDs who have taken an in-person course and have gotten a grade of A or C. on database: advising
Generation: SELECT DISTINCT student_record.student_id FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.offering_id IN (SELECT offering_id FROM course_offering WHERE course_offering.course_id IN (SELECT course_id FROM course WHERE in_person_course = true) ) AND student_record.grade IN ('A', 'C')

Error executing query: SELECT DISTINCT student_record.student_id FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.offering_id IN (SELECT offering_id FROM course_offering WHERE course_offering.course_id IN (SELECT course_id FROM course WHERE in_person_course = true) ) AND student_record.grade IN ('A', 'C')
Error: (psycopg2.errors.UndefinedColumn) column "in_person_course" does not exist
LINE 1: ....course_id IN (SELECT course_id FROM course WHERE in_person_...
                                                             ^

[SQL: SELECT DISTINCT student_record.student_id FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.offering_id IN (SELECT offering_id FROM course_offering WHERE course_offering.course_id IN (SELECT course_id FROM course WHERE in_person_course = true) ) AND student_record.grade IN ('A', 'C')]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
2: Exact Match: False, Subset Match: False


Processing 3th question: Which courses have a final project and a final exam? on database: advising
Generation: SELECT course.name, course.course_id FROM course JOIN course_offering ON course.course_id = course_offering.course_id WHERE course_offering.has_final_project AND course_offering.has_final_exam


Generated Query Results (Normalized):
   course_id               name
0          2  Advanced Calculus

Gold Query Results (Normalized):
   course_id               name
0          2  Advanced Calculus
3: Exact Match: True, Subset Match: True


Processing 4th question: Return the distinct list of user IDs who have received transaction notifications. on database: ewallet
Generation: SELECT DISTINCT u.uid FROM consumer_div.notifications n JOIN consumer_div.users u ON n.user_id = u.uid WHERE n.type = 'transaction'


Generated Query Results (Normalized):
   uid
0    1
1    2
2    3
3    4
4   10

Gold Query Results (Normalized):
   uid
0    1
1    2
2    3
3    4
4   10
4: Exact Match: True, Subset Match: True


Processing 5th question: What is the total number of papers published per year? on database: scholar
Generation: SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year


Generated Query Results (Normalized):
   total_papers  year
0             2  2019
1             3  2020

Gold Query Results (Normalized):
   total_papers  year
0             2  2019
1             3  2020
5: Exact Match: True, Subset Match: True


Processing 6th question: What is the latitude and longitude of the business with the highest rating? on database: yelp
Generation: SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id WHERE review.rating = (SELECT MAX(rating) FROM review) GROUP BY business.business_id

Error executing query: SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id WHERE review.rating = (SELECT MAX(rating) FROM review) GROUP BY business.business_id
Error: (psycopg2.errors.GroupingError) column "business.latitude" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT business.latitude, business.longitude FROM business J...
               ^

[SQL: SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id WHERE review.rating = (SELECT MAX(rating) FROM review) GROUP BY business.business_id]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
6: Exact Match: False, Subset Match: False


Processing 7th question: What is the average number of references cited by publications in each domain name? on database: academic
Generation: SELECT d.name, AVG(p.reference_num) AS avg_reference_num FROM publication p JOIN domain_publication dp ON p.pid = dp.pid JOIN domain d ON dp.did = d.did GROUP BY d.name


Generated Query Results (Normalized):
   avg_reference_num              name
0                0.0         Sociology
1                1.0  Natural Sciences
2                2.0      Data Science
3                3.0  Computer Science
4                4.0  Machine Learning

Gold Query Results (Normalized):
   avg_reference_num              name
0                0.0         Sociology
1                1.0  Natural Sciences
2                2.0      Data Science
3                3.0  Computer Science
4                4.0  Machine Learning
7: Exact Match: True, Subset Match: True


Processing 8th question: Which merchants earliest coupon start date was within a year of the merchant's registration? Return the merchant id, registration date, and earliest coupon id and start date on database: ewallet
Generation: SELECT m.mid, m.created_at AS registration_date, c.cid, c.start_date FROM consumer_div.merchants m JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.start_date >= m.created_at AND c.start_date < m.created_at + INTERVAL '1 year'


Generated Query Results (Normalized):
   cid  mid registration_date  start_date
0    5    5        2022-06-20  2023-04-01
1   10   10        2023-02-01  2023-03-01

Gold Query Results (Normalized):
   cid  mid registration_date  start_date
0    5    5        2022-06-20  2023-04-01
1   10   10        2023-02-01  2023-03-01
8: Exact Match: True, Subset Match: True


Processing 9th question: Return the top 5 salespersons by number of sales in the past 30 days? Return their first and last name, total sales count and total revenue amount. on database: car_dealership
Generation: WITH sales_30_days AS (SELECT sale_id, sale_price, sale_date FROM sales WHERE sale_date >= CURRENT_DATE - INTERVAL '30 days' ), salesperson_sales AS (SELECT s.salesperson_id, s.first_name, s.last_name, COUNT(*) AS sale_count, SUM(sale_price) AS total_revenue FROM sales_30_days s GROUP BY s.salesperson_id), salesperson_data AS (SELECT sd.salesperson_id, sd.first_name, sd.last_name, sd.sale_count, sd.total_revenue, ROW_NUMBER() OVER (ORDER BY sd.sale_count DESC, sd.total_revenue DESC) AS row_rank FROM salesperson_sales sd) SELECT first_name, last_name, sale_count, total_revenue FROM salesperson_data WHERE row_rank <= 5

Error executing query: WITH sales_30_days AS (SELECT sale_id, sale_price, sale_date FROM sales WHERE sale_date >= CURRENT_DATE - INTERVAL '30 days' ), salesperson_sales AS (SELECT s.salesperson_id, s.first_name, s.last_name, COUNT(*) AS sale_count, SUM(sale_price) AS total_revenue FROM sales_30_days s GROUP BY s.salesperson_id), salesperson_data AS (SELECT sd.salesperson_id, sd.first_name, sd.last_name, sd.sale_count, sd.total_revenue, ROW_NUMBER() OVER (ORDER BY sd.sale_count DESC, sd.total_revenue DESC) AS row_rank FROM salesperson_sales sd) SELECT first_name, last_name, sale_count, total_revenue FROM salesperson_data WHERE row_rank <= 5
Error: (psycopg2.errors.UndefinedColumn) column "sale_id" does not exist
LINE 1: WITH sales_30_days AS (SELECT sale_id, sale_price, sale_date...
                                      ^
HINT:  Perhaps you meant to reference the column "sales.car_id".

[SQL: WITH sales_30_days AS (SELECT sale_id, sale_price, sale_date FROM sales WHERE sale_date >= CURRENT_DATE - INTERVAL '30 days' ), salesperson_sales AS (SELECT s.salesperson_id, s.first_name, s.last_name, COUNT(*) AS sale_count, SUM(sale_price) AS total_revenue FROM sales_30_days s GROUP BY s.salesperson_id), salesperson_data AS (SELECT sd.salesperson_id, sd.first_name, sd.last_name, sd.sale_count, sd.total_revenue, ROW_NUMBER() OVER (ORDER BY sd.sale_count DESC, sd.total_revenue DESC) AS row_rank FROM salesperson_sales sd) SELECT first_name, last_name, sale_count, total_revenue FROM salesperson_data WHERE row_rank <= 5]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
9: Exact Match: False, Subset Match: False


Processing 10th question: Which airlines do not have any flights that either depart from/arrive at JFK, or have one or more stops? on database: atis
Generation: SELECT airline.airline_name, airline.airline_code FROM airline WHERE NOT airline.airline_code IN (SELECT flight.airline_code FROM flight WHERE (flight.from_airport = 'JFK' OR flight.to_airport = 'JFK') AND flight.stops >= 1)


Generated Query Results (Normalized):
  airline_code       airline_name
0           AS    Alaska Airlines
1           B6    JetBlue Airways
2           DL    Delta Air Lines
3           HA  Hawaiian Airlines
4           NK    Spirit Airlines
5           VX     Virgin America

Gold Query Results (Normalized):
  airline_code       airline_name
0           AS    Alaska Airlines
1           B6    JetBlue Airways
2           DL    Delta Air Lines
3           HA  Hawaiian Airlines
4           NK    Spirit Airlines
5           VX     Virgin America
10: Exact Match: True, Subset Match: True


Processing 11th question: How many check-ins occurred on each day of the week? on database: yelp
Generation: SELECT checkin.day, COUNT(*) AS count FROM checkin GROUP BY checkin.day ORDER BY count DESC


Generated Query Results (Normalized):
   count        day
0      2     Friday
1      2     Monday
2      2   Saturday
3      2   Thursday
4      2    Tuesday
5      2  Wednesday

Gold Query Results (Normalized):
   count        day
0      2     Friday
1      2     Monday
2      2   Saturday
3      2   Thursday
4      2    Tuesday
5      2  Wednesday
11: Exact Match: True, Subset Match: True


Processing 12th question: How many distinct customers made each type of transaction between Jan 1, 2023 and Mar 31, 2023 (inclusive of start and end dates)? Return the transaction type, number of distinct customers and average number of shares, for the top 3 transaction types by number of customers. on database: broker_context
Generation: SELECT tx.sbTxType, COUNT(DISTINCT tx.sbTxCustId) AS num_distinct_customers, AVG(tx.sbTxShares) AS avg_shares FROM sbTransaction tx WHERE tx.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY tx.sbTxType ORDER BY num_distinct_customers DESC LIMIT 3

Error executing query: SELECT tx.sbTxType, COUNT(DISTINCT tx.sbTxCustId) AS num_distinct_customers, AVG(tx.sbTxShares) AS avg_shares FROM sbTransaction tx WHERE tx.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY tx.sbTxType ORDER BY num_distinct_customers DESC LIMIT 3
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
12: Exact Match: False, Subset Match: False


Processing 13th question: Which city has the highest-rated restaurant? on database: restaurants
Generation: SELECT restaurant.city_name FROM restaurant ORDER BY rating DESC NULLS LAST LIMIT 1


Generated Query Results (Normalized):
  city_name
0  New York

Gold Query Results (Normalized):
  city_name
0  New York
13: Exact Match: True, Subset Match: True


Processing 14th question: Calculate the ratio of the maximum range to the maximum payload for each aircraft on database: atis
Generation: SELECT aircraft.aircraft_description, MAX(aircraft.range_miles) / NULLIF(MAX(aircraft.pay_load), 0) AS range_payload_ratio FROM aircraft GROUP BY aircraft.aircraft_description ORDER BY range_payload_ratio DESC NULLS LAST


Generated Query Results (Normalized):
                          aircraft_description  range_payload_ratio
0   The Airbus A320 is a narrow-body airliner.                    0
1     The Airbus A330 is a wide-body airliner.                    0
2     The Airbus A350 is a wide-body airliner.                    0
3     The Airbus A380 is a wide-body airliner.                    0
4    The Boeing 737 is a narrow-body airliner.                    0
5      The Boeing 747 is a wide-body airliner.                    0
6      The Boeing 777 is a wide-body airliner.                    0
7      The Boeing 787 is a wide-body airliner.                    0
8     The Bombardier CRJ200 is a regional jet.                    0
9  The Embraer E190 is a narrow-body airliner.                    0

Gold Query Results (Normalized):
                          aircraft_description  range_payload_ratio
0   The Airbus A320 is a narrow-body airliner.                    0
1     The Airbus A330 is a wide-body airliner.                    0
2     The Airbus A350 is a wide-body airliner.                    0
3     The Airbus A380 is a wide-body airliner.                    0
4    The Boeing 737 is a narrow-body airliner.                    0
5      The Boeing 747 is a wide-body airliner.                    0
6      The Boeing 777 is a wide-body airliner.                    0
7      The Boeing 787 is a wide-body airliner.                    0
8     The Bombardier CRJ200 is a regional jet.                    0
9  The Embraer E190 is a narrow-body airliner.                    0
14: Exact Match: True, Subset Match: True


Processing 15th question: Return the distinct list of doctor IDs, first names and last names that have prescribed treatments. on database: derm_treatment
Generation: SELECT DISTINCT d.doc_id, d.first_name, d.last_name FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id


Generated Query Results (Normalized):
   doc_id first_name last_name
0       1       John       Doe
1       2       Jane     Smith
2       3      David   Johnson
3       4      Emily     Brown
4       5    Michael     Davis
5       6      Sarah    Wilson
6       7     Robert    Taylor

Gold Query Results (Normalized):
   doc_id first_name last_name
0       1       John       Doe
1       2       Jane     Smith
2       3      David   Johnson
3       4      Emily     Brown
4       5    Michael     Davis
5       6      Sarah    Wilson
6       7     Robert    Taylor
15: Exact Match: True, Subset Match: True


Processing 16th question: What is the average rating of restaurants in each region? on database: restaurants
Generation: SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region


Generated Query Results (Normalized):
   average_rating      region
0            4.15  California
1            4.30    New York
2            4.50     Florida

Gold Query Results (Normalized):
   average_rating      region
0            4.15  California
1            4.30    New York
2            4.50     Florida
16: Exact Match: True, Subset Match: True


Processing 17th question: Which are the top 5 countries by total transaction amount sent by users, sender_type = 0? Return the country, number of distinct users who sent, and total transaction amount. on database: ewallet
Generation: SELECT country, COUNT(DISTINCT sender_id) AS num_distinct_senders, SUM(amount) AS total_transaction_amount FROM consumer_div.wallet_transactions_daily WHERE sender_type = 0 GROUP BY country ORDER BY total_transaction_amount DESC LIMIT 5

Error executing query: SELECT country, COUNT(DISTINCT sender_id) AS num_distinct_senders, SUM(amount) AS total_transaction_amount FROM consumer_div.wallet_transactions_daily WHERE sender_type = 0 GROUP BY country ORDER BY total_transaction_amount DESC LIMIT 5
Error: (psycopg2.errors.UndefinedColumn) column "country" does not exist
LINE 1: SELECT country, COUNT(DISTINCT sender_id) AS num_distinct_se...
               ^

[SQL: SELECT country, COUNT(DISTINCT sender_id) AS num_distinct_senders, SUM(amount) AS total_transaction_amount FROM consumer_div.wallet_transactions_daily WHERE sender_type = 0 GROUP BY country ORDER BY total_transaction_amount DESC LIMIT 5]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
17: Exact Match: False, Subset Match: False


Processing 18th question: What is the average rating of businesses in the city of San Francisco? on database: yelp
Generation: SELECT AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%San Francisco%'


Generated Query Results (Normalized):
   average_rating
0        4.088889

Gold Query Results (Normalized):
   average_rating
0        4.088889
18: Exact Match: True, Subset Match: True


Processing 19th question: Return the distinct list of salesperson IDs that have received a cash payment, based on joining the salespersons, sales and payments_received tables. on database: car_dealership
Generation: SELECT DISTINCT s.id AS salesperson_id FROM salespersons s JOIN sales sa ON s.id = sa.salesperson_id JOIN payments_received pr ON sa.id = pr.sale_id WHERE pr.payment_method = 'Cash'

Generated query returned no results.
19: Exact Match: False, Subset Match: False


Processing 20th question: What's the name and food type of all the restaurants located on Market St in San Francisco? on database: restaurants
Generation: SELECT name, food_type FROM restaurant WHERE city_name = 'San Francisco' INTERSECT SELECT DISTINCT r.name, r.food_type FROM location l JOIN restaurant r ON l.restaurant_id = r.id WHERE l.street_name = 'Market St'


Generated Query Results (Normalized):
  food_type                  name
0   Mexican  The Tacos & Burritos

Gold Query Results (Normalized):
  food_type                  name
0   Mexican  The Tacos & Burritos
20: Exact Match: True, Subset Match: True


Processing 21th question: How many reviews were posted in each month of the year 2021, ordered by the month? on database: yelp
Generation: SELECT COUNT(*), month FROM review WHERE year = 2021 GROUP BY month ORDER BY month


Generated Query Results (Normalized):
   count     month
0      2     April
1      1  February
2      2   January
3      1      July
4      1      June
5      1     March
6      1       May

Gold Query Results (Normalized):
   count     month
0      2     April
1      1  February
2      2   January
3      1      July
4      1      June
5      1     March
6      1       May
21: Exact Match: True, Subset Match: True


Processing 22th question: What is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits. on database: advising
Generation: SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST


Generated Query Results (Normalized):
   student_id  total_credit
0           1            13
1           5             7
2           4             7
3           3             7
4           2             7

Gold Query Results (Normalized):
   student_id  total_credit
0           1            13
1           5             7
2           4             7
3           3             7
4           2             7
22: Exact Match: True, Subset Match: True


Processing 23th question: What are the top 5 cities with the highest population? Give both city names and the population. on database: geography
Generation: SELECT city_name, population FROM city ORDER BY population DESC NULLS LAST LIMIT 5


Generated Query Results (Normalized):
     city_name  population
0  Los Angeles     5000000
1    Sao Paulo     3000000
2      Houston     2000000
3      Chicago     1500000
4       Mumbai     1200000

Gold Query Results (Normalized):
     city_name  population
0  Los Angeles     5000000
1    Sao Paulo     3000000
2      Houston     2000000
3      Chicago     1500000
4       Mumbai     1200000
23: Exact Match: True, Subset Match: True


Processing 24th question: Give me today's median merchant wallet balance for all active merchants whose category contains 'retail' on database: ewallet
Generation: SELECT median_balance FROM (SELECT MEDIAN(balance) AS median_balance FROM consumer_div.wallet_merchant_balance_daily WHERE merchant_id IN (SELECT m.mid FROM consumer_div.merchants m WHERE m.status = 'active' AND m.category ILIKE '%retail%') AND date = CURRENT_DATE) AS subquery

Error executing query: SELECT median_balance FROM (SELECT MEDIAN(balance) AS median_balance FROM consumer_div.wallet_merchant_balance_daily WHERE merchant_id IN (SELECT m.mid FROM consumer_div.merchants m WHERE m.status = 'active' AND m.category ILIKE '%retail%') AND date = CURRENT_DATE) AS subquery
Error: (psycopg2.errors.UndefinedFunction) function median(numeric) does not exist
LINE 1: SELECT median_balance FROM (SELECT MEDIAN(balance) AS median...
                                           ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT median_balance FROM (SELECT MEDIAN(balance) AS median_balance FROM consumer_div.wallet_merchant_balance_daily WHERE merchant_id IN (SELECT m.mid FROM consumer_div.merchants m WHERE m.status = 'active' AND m.category ILIKE '%%retail%%') AND date = CURRENT_DATE) AS subquery]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
24: Exact Match: False, Subset Match: False


Processing 25th question: What is the ratio of the length of the Mississippi River to the length of the Rhine River? on database: geography
Generation: SELECT CAST(river.length AS FLOAT) / NULLIF(river.length, 0) AS ratio FROM river WHERE river.river_name = 'Mississippi River' INTERSECT SELECT CAST(river.length AS FLOAT) / NULLIF(river.length, 0) AS ratio FROM river WHERE river.river_name = 'Rhine River'

Generated query returned no results.
25: Exact Match: False, Subset Match: False


Processing 26th question: What is the average length of rivers per country in countries with a lake? on database: geography
Generation: SELECT river.country_name, AVG(river.length) AS average_length FROM river JOIN lake ON river.country_name = lake.country_name GROUP BY river.country_name


Generated Query Results (Normalized):
   average_length   country_name
0           200.0  United States
1           300.0          China
2           800.0         Russia

Gold Query Results (Normalized):
   average_length   country_name
0           200.0  United States
1           300.0          China
2           800.0         Russia
26: Exact Match: True, Subset Match: True


Processing 27th question: Return the car ID, make, model and year for cars that have no sales records, by doing a left join from the cars to sales table. on database: car_dealership
Generation: SELECT c.id, c.make, c.model, c.year FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE s.car_id IS NULL


Generated Query Results (Normalized):
    id           make        model  year
0   11          Mazda         CX-5  2022
1   12        Hyundai       Tucson  2023
2   13            Kia      Sorento  2021
3   14           Jeep     Wrangler  2022
4   15            GMC  Sierra 1500  2023
5   16            Ram         1500  2022
6   17  Mercedes-Benz      E-Class  2021
7   18     Volkswagen       Tiguan  2022
8   19          Volvo         XC90  2023
9   20        Porsche          911  2022
10  21       Cadillac     Escalade  2023

Gold Query Results (Normalized):
    id           make        model  year
0   11          Mazda         CX-5  2022
1   12        Hyundai       Tucson  2023
2   13            Kia      Sorento  2021
3   14           Jeep     Wrangler  2022
4   15            GMC  Sierra 1500  2023
5   16            Ram         1500  2022
6   17  Mercedes-Benz      E-Class  2021
7   18     Volkswagen       Tiguan  2022
8   19          Volvo         XC90  2023
9   20        Porsche          911  2022
10  21       Cadillac     Escalade  2023
27: Exact Match: True, Subset Match: True


Processing 28th question: What are the names of the top 3 restaurants with the highest ratings? on database: restaurants
Generation: SELECT name FROM restaurant ORDER BY rating DESC NULLS LAST LIMIT 3


Generated Query Results (Normalized):
                name
0     The Vegan Cafe
1  The Seafood Shack
2    The Pizza Place

Gold Query Results (Normalized):
                name
0     The Vegan Cafe
1  The Seafood Shack
2    The Pizza Place
28: Exact Match: True, Subset Match: True


Processing 29th question: What is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall? on database: restaurants
Generation: SELECT CAST(COUNT(CASE WHEN rating > 4.0 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4.0 THEN 1 END), 0) AS ratio FROM restaurant


Generated Query Results (Normalized):
      ratio
0  2.666667

Gold Query Results (Normalized):
      ratio
0  2.666667
29: Exact Match: True, Subset Match: True


Processing 30th question: How many lakes are there in each state? on database: geography
Generation: SELECT lake.state_name, COUNT(*) AS number_of_lakes FROM lake GROUP BY lake.state_name


Generated Query Results (Normalized):
   number_of_lakes state_name
0                1   New York
1                1       Ohio
2                3   Michigan
3                5       None

Gold Query Results (Normalized):
   number_of_lakes state_name
0                1   New York
1                1       Ohio
2                3   Michigan
3                5       None
30: Exact Match: True, Subset Match: True


Processing 31th question: What is the ratio of businesses in the state of California to businesses in the state of New York? on database: yelp
Generation: SELECT CAST(SUM(CASE WHEN business.state = 'CA' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN business.state = 'NY' THEN 1 ELSE 0 END), 0) AS ratio FROM business


Generated Query Results (Normalized):
      ratio
0  1.333333

Gold Query Results (Normalized):
      ratio
0  1.333333
31: Exact Match: True, Subset Match: True


Processing 32th question: What are the names of the restaurants that serve Italian food? on database: restaurants
Generation: SELECT name FROM restaurant WHERE food_type ILIKE '%Italian%'


Generated Query Results (Normalized):
              name
0  The Pasta House
1  The Pizza Place

Gold Query Results (Normalized):
              name
0  The Pasta House
1  The Pizza Place
32: Exact Match: True, Subset Match: True


Processing 33th question: Who are the top 2 merchants (receiver type 1) by total transaction amount in the past 150 days (inclusive of 150 days ago)? Return the merchant name, total number of transactions, and total transaction amount. on database: ewallet
Generation: SELECT m.name AS merchant_name, COUNT(*) AS total_transactions, SUM(t.amount) AS total_transaction_amount FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id AND t.receiver_type = 1 WHERE t.created_at >= DATE_TRUNC('day', CURRENT_DATE - INTERVAL '150 days') GROUP BY m.name ORDER BY total_transaction_amount DESC LIMIT 2


Generated Query Results (Normalized):
  merchant_name  total_transaction_amount  total_transactions
0    HandyCraft                    199.99                   1
1      TechMart                    399.98                   2

Gold Query Results (Normalized):
  merchant_name  total_transaction_amount  total_transactions
0    HandyCraft                    199.99                   1
1      TechMart                    399.98                   2
33: Exact Match: True, Subset Match: True


Processing 34th question: Return the customer ID and name of customers who have not made any transactions. on database: broker_context
Generation: SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxId IS NULL

Error executing query: SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxId IS NULL
Error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "broker_context" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Generated query returned no results.
34: Exact Match: False, Subset Match: False


Processing 35th question: What are the top 3 most common transaction statuses and their respective counts? on database: ewallet
Generation: SELECT status, COUNT(*) AS count FROM consumer_div.wallet_transactions_daily GROUP BY status ORDER BY count DESC LIMIT 3


Generated Query Results (Normalized):
   count   status
0      2   failed
1      4  pending
2     19  success

Gold Query Results (Normalized):
   count   status
0      2   failed
1      4  pending
2     19  success
35: Exact Match: True, Subset Match: True


Processing 36th question: What is the total number of reviews posted in the year 2021 for businesses in the category "Cafe"? on database: yelp
Generation: SELECT SUM(review.count) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE category.category_name = 'Cafe' AND review.year = 2021

Error executing query: SELECT SUM(review.count) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE category.category_name = 'Cafe' AND review.year = 2021
Error: (psycopg2.errors.GroupingError) aggregate function calls cannot be nested
LINE 1: SELECT SUM(review.count) AS total_reviews FROM review JOIN b...
                   ^

[SQL: SELECT SUM(review.count) AS total_reviews FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.business_id = category.business_id WHERE category.category_name = 'Cafe' AND review.year = 2021]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
36: Exact Match: False, Subset Match: False


Processing 37th question: How many distinct active users sent money per month in 2023? Return the number of active users per month (as a date), starting from the earliest date. Do not include merchants in the query. Only include successful transactions. on database: ewallet
Generation: SELECT TO_CHAR(date_trunc('month', wallet_transactions_daily.created_at), 'YYYY-MM') AS month, COUNT(DISTINCT wallet_transactions_daily.sender_id) AS num_active_users FROM wallet_transactions_daily WHERE wallet_transactions_daily.status = 'SUCCESS' AND wallet_transactions_daily.sender_type = 1 AND wallet_transactions_daily.created_at >= DATE '2023-01-01' GROUP BY month ORDER BY month

Error executing query: SELECT TO_CHAR(date_trunc('month', wallet_transactions_daily.created_at), 'YYYY-MM') AS month, COUNT(DISTINCT wallet_transactions_daily.sender_id) AS num_active_users FROM wallet_transactions_daily WHERE wallet_transactions_daily.status = 'SUCCESS' AND wallet_transactions_daily.sender_type = 1 AND wallet_transactions_daily.created_at >= DATE '2023-01-01' GROUP BY month ORDER BY month
Error: (psycopg2.errors.UndefinedTable) relation "wallet_transactions_daily" does not exist
LINE 1: ...actions_daily.sender_id) AS num_active_users FROM wallet_tra...
                                                             ^

[SQL: SELECT TO_CHAR(date_trunc('month', wallet_transactions_daily.created_at), 'YYYY-MM') AS month, COUNT(DISTINCT wallet_transactions_daily.sender_id) AS num_active_users FROM wallet_transactions_daily WHERE wallet_transactions_daily.status = 'SUCCESS' AND wallet_transactions_daily.sender_type = 1 AND wallet_transactions_daily.created_at >= DATE '2023-01-01' GROUP BY month ORDER BY month]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
37: Exact Match: False, Subset Match: False


Processing 38th question: What is the average GPA of students in the program mathematics? on database: advising
Generation: SELECT AVG(total_gpa) FROM student WHERE program_id IN (SELECT program_id FROM program WHERE name ILIKE '%mathematics%')


Generated Query Results (Normalized):
   avg
0  3.6

Gold Query Results (Normalized):
   avg
0  3.6
38: Exact Match: True, Subset Match: True


Processing 39th question: How many authors wrote papers that were published in the journal "Science" in the year 2020? on database: scholar
Generation: SELECT COUNT(DISTINCT a.authorid) FROM author a JOIN paper p ON a.authorid = p.authorid JOIN journal j ON p.journalid = j.journalid WHERE p.year = 2020 AND j.journalname = 'Science'

Error executing query: SELECT COUNT(DISTINCT a.authorid) FROM author a JOIN paper p ON a.authorid = p.authorid JOIN journal j ON p.journalid = j.journalid WHERE p.year = 2020 AND j.journalname = 'Science'
Error: (psycopg2.errors.UndefinedColumn) column p.authorid does not exist
LINE 1: ...horid) FROM author a JOIN paper p ON a.authorid = p.authorid...
                                                             ^
HINT:  Perhaps you meant to reference the column "a.authorid".

[SQL: SELECT COUNT(DISTINCT a.authorid) FROM author a JOIN paper p ON a.authorid = p.authorid JOIN journal j ON p.journalid = j.journalid WHERE p.year = 2020 AND j.journalname = 'Science']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
39: Exact Match: False, Subset Match: False


Processing 40th question: How does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio? on database: yelp
Generation: SELECT category.category_name, category.id, COUNT(CASE WHEN review.rating > 3 THEN 1 ELSE NULL END)::float / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 ELSE NULL END), 0) AS ratio FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.bid = category.business_id GROUP BY category.category_name, category.id ORDER BY ratio DESC NULLS LAST

Error executing query: SELECT category.category_name, category.id, COUNT(CASE WHEN review.rating > 3 THEN 1 ELSE NULL END)::float / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 ELSE NULL END), 0) AS ratio FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.bid = category.business_id GROUP BY category.category_name, category.id ORDER BY ratio DESC NULLS LAST
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: bigint = text
LINE 1: ...usiness.business_id JOIN category ON business.bid = category...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT category.category_name, category.id, COUNT(CASE WHEN review.rating > 3 THEN 1 ELSE NULL END)::float / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 ELSE NULL END), 0) AS ratio FROM review JOIN business ON review.business_id = business.business_id JOIN category ON business.bid = category.business_id GROUP BY category.category_name, category.id ORDER BY ratio DESC NULLS LAST]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
40: Exact Match: False, Subset Match: False


Processing 41th question: Which flights serve meals in first class? Give me the flight id and meal description. on database: atis
Generation: SELECT f.flight_id, m.meal_description FROM flight f JOIN food_service m ON f.meal_code = m.meal_code WHERE f.class_of_service = 1

Error executing query: SELECT f.flight_id, m.meal_description FROM flight f JOIN food_service m ON f.meal_code = m.meal_code WHERE f.class_of_service = 1
Error: (psycopg2.errors.UndefinedColumn) column f.class_of_service does not exist
LINE 1: ...food_service m ON f.meal_code = m.meal_code WHERE f.class_of...
                                                             ^

[SQL: SELECT f.flight_id, m.meal_description FROM flight f JOIN food_service m ON f.meal_code = m.meal_code WHERE f.class_of_service = 1]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
41: Exact Match: False, Subset Match: False


Processing 42th question: How many flights require a round-trip to purchase the fare? on database: atis
Generation: SELECT COUNT(*) AS round_trip_flights FROM fare WHERE round_trip_required = 'Y'


Generated Query Results (Normalized):
   round_trip_flights
0                   0

Gold Query Results (Normalized):
   round_trip_flights
0                   0
42: Exact Match: True, Subset Match: True


Processing 43th question: What are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order? on database: academic
Generation: SELECT publication.title, publication.pid, publication.reference_num FROM publication ORDER BY publication.reference_num DESC NULLS LAST LIMIT 3


Generated Query Results (Normalized):
   pid  reference_num                      title
0    5              4  Attention is all you need
1    4              2  Optimizing GPU Throughput
2    3              2     Data Mining Techniques

Gold Query Results (Normalized):
   pid  reference_num                      title
0    5              4  Attention is all you need
1    4              2  Optimizing GPU Throughput
2    3              2     Data Mining Techniques
43: Exact Match: True, Subset Match: True


Processing 44th question: Return the patient IDs, first names and last names of patients who have not received any treatments. on database: derm_treatment
Generation: SELECT p.patient_id, p.first_name, p.last_name FROM patients p LEFT JOIN treatments t ON p.patient_id = t.patient_id WHERE t.treatment_id IS NULL


Generated Query Results (Normalized):
  first_name last_name  patient_id
0     Hannah    Garcia           8
1      Kelly     Smith          11

Gold Query Results (Normalized):
  first_name last_name  patient_id
0     Hannah    Garcia           8
1      Kelly     Smith          11
44: Exact Match: True, Subset Match: True


Processing 45th question: What is the ratio of check-ins on weekends to check-ins on weekdays for the business named "Mark's Bistro"? on database: yelp
Generation: SELECT CAST(SUM(CASE WHEN checkin.day ILIKE '%Saturday%' OR checkin.day ILIKE '%Sunday%' THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day ILIKE '%Monday%' OR checkin.day ILIKE '%Tuesday%' OR checkin.day ILIKE '%Wednesday%' OR checkin.day ILIKE '%Thursday%' OR checkin.day ILIKE '%Friday%' THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark\'s Bistro%'

Error executing query: SELECT CAST(SUM(CASE WHEN checkin.day ILIKE '%Saturday%' OR checkin.day ILIKE '%Sunday%' THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day ILIKE '%Monday%' OR checkin.day ILIKE '%Tuesday%' OR checkin.day ILIKE '%Wednesday%' OR checkin.day ILIKE '%Thursday%' OR checkin.day ILIKE '%Friday%' THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark\'s Bistro%'
Error: (psycopg2.errors.SyntaxError) syntax error at or near "s"
LINE 1: ...ess.business_id WHERE business.name ILIKE '%Mark\'s Bistro%'
                                                             ^

[SQL: SELECT CAST(SUM(CASE WHEN checkin.day ILIKE '%%Saturday%%' OR checkin.day ILIKE '%%Sunday%%' THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day ILIKE '%%Monday%%' OR checkin.day ILIKE '%%Tuesday%%' OR checkin.day ILIKE '%%Wednesday%%' OR checkin.day ILIKE '%%Thursday%%' OR checkin.day ILIKE '%%Friday%%' THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%%Mark\'s Bistro%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
45: Exact Match: False, Subset Match: False


Processing 46th question: How many mountains are there in each country? on database: geography
Generation: SELECT mountain.country_name, COUNT(*) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC NULLS LAST


Generated Query Results (Normalized):
  country_name  number_of_mountains
0        Nepal                    8
1     Pakistan                    2

Gold Query Results (Normalized):
  country_name  number_of_mountains
0        Nepal                    8
1     Pakistan                    2
46: Exact Match: True, Subset Match: True


Processing 47th question: What are the top 3 insurance types by average patient height in cm? Return the insurance type, average height and average weight. on database: derm_treatment
Generation: SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight FROM patients GROUP BY ins_type ORDER BY avg_height DESC LIMIT 3


Generated Query Results (Normalized):
   avg_height  avg_weight  ins_type
0  169.600000        67.8   private
1  171.666667        71.0  medicare
2  176.500000        80.0  medicaid

Gold Query Results (Normalized):
   avg_height  avg_weight  ins_type
0  169.600000        67.8   private
1  171.666667        71.0  medicare
2  176.500000        80.0  medicaid
47: Exact Match: True, Subset Match: True


Processing 48th question: What is the total number of check-ins on the 2 days before Saturday? on database: yelp
Generation: SELECT SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.day = 'Saturday' - INTERVAL '2 days'

Error executing query: SELECT SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.day = 'Saturday' - INTERVAL '2 days'
Error: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type interval: "Saturday"
LINE 1: ...S total_checkins FROM checkin WHERE checkin.day = 'Saturday'...
                                                             ^

[SQL: SELECT SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.day = 'Saturday' - INTERVAL '2 days']
(Background on this error at: https://sqlalche.me/e/20/9h9h)
Generated query returned no results.
48: Exact Match: False, Subset Match: False


Processing 49th question: Which papers are associated with the keyphrase "Machine Learning"? on database: scholar
Generation: SELECT paper.title, paper.paperid FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%'


Generated Query Results (Normalized):
   paperid                                        title
0        1       A Study on Machine Learning Algorithms
1        5  Machine Learning in Tackling Climate Change

Gold Query Results (Normalized):
   paperid                                        title
0        1       A Study on Machine Learning Algorithms
1        5  Machine Learning in Tackling Climate Change
49: Exact Match: True, Subset Match: True


Processing 50th question: What are the names of the authors who have written publications in the domain "Computer Science"? on database: academic
Generation: SELECT DISTINCT name FROM author WHERE aid IN (SELECT DISTINCT aid FROM domain_author WHERE did IN (SELECT did FROM domain WHERE name ILIKE '%Computer Science%'))


Generated Query Results (Normalized):
             name
0  Ashish Vaswani
1  Martin Odersky
2    Noam Shazeer

Gold Query Results (Normalized):
             name
0  Ashish Vaswani
1  Martin Odersky
2    Noam Shazeer
50: Exact Match: True, Subset Match: True


Processing 51th question: What is the average rating of restaurants that serve Mexican food in each city? on database: restaurants
Generation: SELECT r.city_name, AVG(r.rating) AS average_rating FROM restaurant r WHERE r.food_type ILIKE '%Mexican%' GROUP BY r.city_name


Generated Query Results (Normalized):
   average_rating      city_name
0             4.1  San Francisco

Gold Query Results (Normalized):
   average_rating      city_name
0             4.1  San Francisco
51: Exact Match: True, Subset Match: True


Processing 52th question: Which state code is Orlando International Airport in? on database: atis
Generation: SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%'


Generated Query Results (Normalized):
  state_code
0         FL

Gold Query Results (Normalized):
  state_code
0         FL
52: Exact Match: True, Subset Match: True


Processing 53th question: What is the total number of unique keyphrases associated with papers published in the journal with "IEEE Transactions" in its name? on database: scholar
Generation: SELECT COUNT(DISTINCT keyphrase.keyphraseid) FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE journal.journalname ILIKE '%IEEE Transactions%'


Generated Query Results (Normalized):
   count
0      2

Gold Query Results (Normalized):
   count
0      2
53: Exact Match: True, Subset Match: True


Processing 54th question: Which states border the state where lake ontario is? on database: geography
Generation: SELECT border FROM lake WHERE lake_name ILIKE '%Ontario%'

Error executing query: SELECT border FROM lake WHERE lake_name ILIKE '%Ontario%'
Error: (psycopg2.errors.UndefinedColumn) column "border" does not exist
LINE 1: SELECT border FROM lake WHERE lake_name ILIKE '%Ontario%'
               ^

[SQL: SELECT border FROM lake WHERE lake_name ILIKE '%%Ontario%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
54: Exact Match: False, Subset Match: False


Processing 55th question: Which users have posted reviews for businesses located in the neighbourhood of "Downtown" and how many reviews have they posted? on database: yelp
Generation: SELECT review.user_id, COUNT(review.rid) AS review_count FROM review JOIN business ON review.business_id = business.business_id JOIN neighbourhood ON business.business_id = neighbourhood.business_id WHERE neighbourhood.neighbourhood_name = 'Downtown' GROUP BY review.user_id ORDER BY review_count DESC


Generated Query Results (Normalized):
   review_count user_id
0             2       1
1             2       4
2             2       5
3             3       3

Gold Query Results (Normalized):
   review_count user_id
0             2       1
1             2       4
2             2       5
3             3       3
55: Exact Match: True, Subset Match: True


Processing 56th question: Which cars were in inventory in the latest snapshot for march 2023? Return the car id, make, model, and year. Cars are considered to be in inventory" if is_in_inventory is True." on database: car_dealership
Generation: SELECT c.id, c.make, c.model, c.year FROM cars c JOIN inventory_snapshots s ON c.id = s.car_id WHERE s.is_in_inventory = TRUE AND s.snapshot_date = (SELECT MAX(snapshot_date) FROM inventory_snapshots WHERE snapshot_date <= '2023-03-31' )


Generated Query Results (Normalized):
   id    make    model  year
0   1  Toyota    Camry  2022
1   3    Ford  Mustang  2023

Gold Query Results (Normalized):
   id    make    model  year
0   1  Toyota    Camry  2022
1   3    Ford  Mustang  2023
56: Exact Match: True, Subset Match: True


Processing 57th question: What is the total number of students enrolled in each course, ordered from highest to lowest? on database: advising
Generation: SELECT course.name, course.course_id, course.number, course.credits, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST


Generated Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          2       4                 Advanced Calculus             5  MATH201
1          4       3             Distributed Databases             3    CS302
2          1       3  Introduction to Computer Science             3    CS101
3          3       3           Introduction to Physics             1  PHYS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101

Gold Query Results (Normalized):
   course_id credits                              name  num_enrolled   number
0          4       3             Distributed Databases             3    CS302
1          3       3           Introduction to Physics             1  PHYS101
2          2       4                 Advanced Calculus             5  MATH201
3          1       3  Introduction to Computer Science             3    CS101
57: Exact Match: False, Subset Match: True


Processing 58th question: Return merchants (merchant ID and name) who have not issued any coupons. on database: ewallet
Generation: SELECT m.mid, m.name FROM consumer_div.merchants m LEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.merchant_id IS NULL


Generated Query Results (Normalized):
   mid               name
0   11       FashionTrend
1   12       GreenGourmet
2   13        PetParadise
3   14  HomeTechSolutions
4   15          BookWorms

Gold Query Results (Normalized):
   mid               name
0   11       FashionTrend
1   12       GreenGourmet
2   13        PetParadise
3   14  HomeTechSolutions
4   15          BookWorms
58: Exact Match: True, Subset Match: True


Processing 59th question: What were the total quarterly sales in 2023 grouped by customer's state? Represent each quarter as the first date in the quarter. on database: car_dealership
Generation: SELECT SUM(sale_price) AS total_sales, EXTRACT(QUARTER FROM sale_date) AS quarter, customers.state AS state FROM sales JOIN customers ON sales.customer_id = customers.id WHERE sale_date >= '2023-01-01' AND sale_date < '2023-04-01' GROUP BY customers.state, quarter ORDER BY total_sales DESC


Generated Query Results (Normalized):
   quarter state  total_sales
0      1.0    AZ      47000.0
1      1.0    CA      26500.0
2      1.0    IL      30500.0
3      1.0    TX      61500.0

Gold Query Results (Normalized):
   quarter state  total_sales
0      1.0    AZ      47000.0
1      1.0    CA      26500.0
2      1.0    IL      30500.0
3      1.0    TX      61500.0
59: Exact Match: True, Subset Match: True


Processing 60th question: What is the total number of papers published in each journal, ordered by the journal name? on database: scholar
Generation: SELECT journal.journalname, COUNT(paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY journal.journalname, journal.journalid ORDER BY journal.journalname


Generated Query Results (Normalized):
                                         journalname  total_papers
0  IEEE Transactions on Pattern Analysis and Mach...             2
1             International Journal of Mental Health             1
2                                             Nature             1
3                                            Science             1

Gold Query Results (Normalized):
                                         journalname  total_papers
0  IEEE Transactions on Pattern Analysis and Mach...             2
1             International Journal of Mental Health             1
2                                             Nature             1
3                                            Science             1
60: Exact Match: True, Subset Match: True


Processing 61th question: Which street has the most number of restaurants? on database: restaurants
Generation: SELECT street_name, COUNT(*) AS number_of_restaurants FROM location GROUP BY street_name ORDER BY number_of_restaurants DESC LIMIT 1


Generated Query Results (Normalized):
   number_of_restaurants street_name
0                      2    Pine Ave

Gold Query Results (Normalized):
   number_of_restaurants street_name
0                      2    Pine Ave
61: Exact Match: True, Subset Match: True


Processing 62th question: What's the average predicted time to graduation since admission in no. of days? on database: advising
Generation: SELECT AVG(DATE_PART('day', predicted_graduation_semester - entered_as)::FLOAT) AS average_predicted_time_to_graduation FROM student

Error executing query: SELECT AVG(DATE_PART('day', predicted_graduation_semester - entered_as)::FLOAT) AS average_predicted_time_to_graduation FROM student
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: date - text
LINE 1: ...VG(DATE_PART('day', predicted_graduation_semester - entered_...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT AVG(DATE_PART('day', predicted_graduation_semester - entered_as)::FLOAT) AS average_predicted_time_to_graduation FROM student]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
62: Exact Match: False, Subset Match: False


Processing 63th question: Which organizations have authors who have written publications in the domain "Machine Learning"? on database: academic
Generation: SELECT DISTINCT o.name, o.homepage, o.oid FROM organization o JOIN author a ON o.oid = a.oid JOIN publication_domain pd ON a.aid = pd.aid JOIN domain d ON pd.did = d.did WHERE d.name ILIKE '%Machine Learning%'

Error executing query: SELECT DISTINCT o.name, o.homepage, o.oid FROM organization o JOIN author a ON o.oid = a.oid JOIN publication_domain pd ON a.aid = pd.aid JOIN domain d ON pd.did = d.did WHERE d.name ILIKE '%Machine Learning%'
Error: (psycopg2.errors.UndefinedTable) relation "publication_domain" does not exist
LINE 1: ...rganization o JOIN author a ON o.oid = a.oid JOIN publicatio...
                                                             ^

[SQL: SELECT DISTINCT o.name, o.homepage, o.oid FROM organization o JOIN author a ON o.oid = a.oid JOIN publication_domain pd ON a.aid = pd.aid JOIN domain d ON pd.did = d.did WHERE d.name ILIKE '%%Machine Learning%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
63: Exact Match: False, Subset Match: False


Processing 64th question: How many reviews were posted by users with the name "Sarah Williams" in the month of April 2021? on database: yelp
Generation: SELECT COUNT(*) AS review_count FROM review r JOIN users u ON r.user_id = u.user_id WHERE u.name ILIKE '%Sarah Williams%' AND r.month = 'April' AND r.year = 2021


Generated Query Results (Normalized):
   review_count
0             1

Gold Query Results (Normalized):
   review_count
0             1
64: Exact Match: True, Subset Match: True


Processing 65th question: Return the top 5 states by total revenue, showing the number of unique customers and total revenue (based on sale price) for each state. on database: car_dealership
Generation: SELECT c.state, COUNT(DISTINCT c.id) AS num_customers, SUM(s.sale_price) AS total_revenue FROM sales s JOIN customers c ON s.customer_id = c.id GROUP BY c.state ORDER BY total_revenue DESC LIMIT 5


Generated Query Results (Normalized):
   num_customers state  total_revenue
0              1    FL        54900.0
1              1    IL       124500.0
2              1    WA        90000.0
3              3    CA       257000.0
4              3    TX       198500.0

Gold Query Results (Normalized):
   num_customers state  total_revenue
0              1    FL        54900.0
1              1    IL       124500.0
2              1    WA        90000.0
3              3    CA       257000.0
4              3    TX       198500.0
65: Exact Match: True, Subset Match: True


Processing 66th question: How many courses does each department offer? on database: advising
Generation: SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC


Generated Query Results (Normalized):
         department  num_courses
0  Computer Science            2
1       Mathematics            1
2           Physics            1

Gold Query Results (Normalized):
         department  num_courses
0  Computer Science            2
1       Mathematics            1
2           Physics            1
66: Exact Match: True, Subset Match: True


Processing 67th question: What are the top 3 publications with the highest number of citations? on database: academic
Generation: SELECT publication.title, publication.pid, publication.citation_num FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 3


Generated Query Results (Normalized):
   citation_num  pid                                              title
0             4    1       The Effects of Climate Change on Agriculture
1             2    3                             Data Mining Techniques
2             2    2  A Study on the Effects of Social Media on Ment...

Gold Query Results (Normalized):
   citation_num  pid                                              title
0             4    1       The Effects of Climate Change on Agriculture
1             2    3                             Data Mining Techniques
2             2    2  A Study on the Effects of Social Media on Ment...
67: Exact Match: True, Subset Match: True


Processing 68th question: What is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers? on database: scholar
Generation: SELECT CAST(COUNT(CASE WHEN cited_papers_count >= 2 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN cited_papers_count < 2 THEN 1 END), 0) AS ratio FROM (SELECT paper.paperid, COUNT(cite.citedpaperid) AS cited_papers_count FROM paper JOIN cite ON paper.paperid = cite.citingpaperid GROUP BY paper.paperid) AS subquery


Generated Query Results (Normalized):
   ratio
0    1.5

Gold Query Results (Normalized):
   ratio
0    1.5
68: Exact Match: True, Subset Match: True


Processing 69th question: What is the proportion of papers that belong to more than 1 dataset to papers that belong to 1 dataset? on database: scholar
Generation: SELECT CAST(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) > 1 THEN paperdataset.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) = 1 THEN paperdataset.paperid END), 0) AS proportion_of_papers_in_more_than_1_dataset FROM paperdataset

Error executing query: SELECT CAST(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) > 1 THEN paperdataset.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) = 1 THEN paperdataset.paperid END), 0) AS proportion_of_papers_in_more_than_1_dataset FROM paperdataset
Error: (psycopg2.errors.UndefinedFunction) function array_length(bigint, integer) does not exist
LINE 1: ... CASE WHEN paperdataset.datasetid IS NOT NULL AND array_leng...
                                                             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT CAST(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) > 1 THEN paperdataset.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paperdataset.datasetid IS NOT NULL AND array_length(paperdataset.datasetid, 1) = 1 THEN paperdataset.paperid END), 0) AS proportion_of_papers_in_more_than_1_dataset FROM paperdataset]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
69: Exact Match: False, Subset Match: False


Processing 70th question: What month were most students admitted? Return the no. of students and the month as a date on database: advising
Generation: SELECT date_trunc('month', admit_term) AS month, COUNT(*) AS num_students FROM student GROUP BY month ORDER BY num_students DESC LIMIT 1


Generated Query Results (Normalized):
                      month  num_students
0 2018-01-01 05:00:00+00:00             2

Gold Query Results (Normalized):
                      month  num_students
0 2018-01-01 05:00:00+00:00             2
70: Exact Match: True, Subset Match: True


Processing 71th question: What are the names and areas of the lakes in Michigan? on database: geography
Generation: SELECT lake_name, area FROM lake WHERE state_name = 'Michigan'


Generated Query Results (Normalized):
     area      lake_name
0   300.0     Lake Huron
1   500.0  Lake Michigan
2  1000.0  Lake Superior

Gold Query Results (Normalized):
     area      lake_name
0   300.0     Lake Huron
1   500.0  Lake Michigan
2  1000.0  Lake Superior
71: Exact Match: True, Subset Match: True


Processing 72th question: Return the course id's that are offered in either semesters 1 or 2 and ends before 1pm and had an instructor on thursday. on database: advising
Generation: SELECT DISTINCT course.course_id FROM course JOIN course_offering ON course.course_id = course_offering.course_id JOIN instructor ON course_offering.offering_id = instructor.offering_id WHERE (course_offering.semester = 1 OR course_offering.semester = 2) AND course_offering.end_time < '13:00:00' AND instructor.thursday = 't'

Error executing query: SELECT DISTINCT course.course_id FROM course JOIN course_offering ON course.course_id = course_offering.course_id JOIN instructor ON course_offering.offering_id = instructor.offering_id WHERE (course_offering.semester = 1 OR course_offering.semester = 2) AND course_offering.end_time < '13:00:00' AND instructor.thursday = 't'
Error: (psycopg2.errors.UndefinedColumn) column instructor.offering_id does not exist
LINE 1: ... JOIN instructor ON course_offering.offering_id = instructor...
                                                             ^

[SQL: SELECT DISTINCT course.course_id FROM course JOIN course_offering ON course.course_id = course_offering.course_id JOIN instructor ON course_offering.offering_id = instructor.offering_id WHERE (course_offering.semester = 1 OR course_offering.semester = 2) AND course_offering.end_time < '13:00:00' AND instructor.thursday = 't']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
72: Exact Match: False, Subset Match: False


Processing 73th question: What are the top 3 payment methods by total payment amount received? Return the payment method, total number of payments and total amount. on database: car_dealership
Generation: SELECT payment_method, COUNT(*) AS total_payments, SUM(payment_amount) AS total_amount FROM payments_received GROUP BY payment_method ORDER BY total_amount DESC LIMIT 3


Generated Query Results (Normalized):
  payment_method  total_amount  total_payments
0    credit_card      426500.0               7
1     debit_card      216000.0               5
2      financing      252700.0               5

Gold Query Results (Normalized):
  payment_method  total_amount  total_payments
0    credit_card      426500.0               7
1     debit_card      216000.0               5
2      financing      252700.0               5
73: Exact Match: True, Subset Match: True


Processing 74th question: What are the titles of all publications ordered alphabetically? on database: academic
Generation: SELECT title FROM publication ORDER BY title ASC NULLS LAST


Generated Query Results (Normalized):
                                               title
0  A Study on the Effects of Social Media on Ment...
1                          Attention is all you need
2                             Data Mining Techniques
3                          Optimizing GPU Throughput
4       The Effects of Climate Change on Agriculture

Gold Query Results (Normalized):
                                               title
0  A Study on the Effects of Social Media on Ment...
1                          Attention is all you need
2                             Data Mining Techniques
3                          Optimizing GPU Throughput
4       The Effects of Climate Change on Agriculture
74: Exact Match: True, Subset Match: True


Processing 75th question: What is the average rating of restaurants serving each type of food? on database: restaurants
Generation: SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type


Generated Query Results (Normalized):
   average_rating food_type
0            3.80  American
1            4.10   Mexican
2            4.25  Japanese
3            4.50   Seafood
4            4.60   Italian
5            4.60     Vegan

Gold Query Results (Normalized):
   average_rating food_type
0            3.80  American
1            4.10   Mexican
2            4.25  Japanese
3            4.50   Seafood
4            4.60   Italian
5            4.60     Vegan
75: Exact Match: True, Subset Match: True


Processing 76th question: What's the absolute difference in time in days between today and the earliest flight departure? Give the answer as an integer. on database: atis
Generation: SELECT (CURRENT_DATE - MIN(departure_time)::DATE) AS days_to_earliest_flight FROM flight

Error executing query: SELECT (CURRENT_DATE - MIN(departure_time)::DATE) AS days_to_earliest_flight FROM flight
Error: (psycopg2.errors.CannotCoerce) cannot cast type bigint to date
LINE 1: SELECT (CURRENT_DATE - MIN(departure_time)::DATE) AS days_to...
                                                  ^

[SQL: SELECT (CURRENT_DATE - MIN(departure_time)::DATE) AS days_to_earliest_flight FROM flight]
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
76: Exact Match: False, Subset Match: False


Processing 77th question: What is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue? on database: scholar
Generation: SELECT journal.journalname, COUNT(paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid WHERE paper.paperid = 2 GROUP BY journal.journalname


Generated Query Results (Normalized):
  journalname  total_papers
0      Nature             1

Gold Query Results (Normalized):
  journalname  total_papers
0      Nature             1
77: Exact Match: True, Subset Match: True


Processing 78th question: What are the top 5 best selling car models by total revenue? Return the make, model, total number of sales and total revenue. on database: car_dealership
Generation: SELECT c.make, c.model, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM cars c JOIN sales s ON c.id = s.car_id GROUP BY c.make, c.model ORDER BY total_revenue DESC LIMIT 5


Generated Query Results (Normalized):
     make    model  total_revenue  total_sales
0    Audi       A4        81500.0            2
1     BMW       X5        63000.0            1
2    Ford  Mustang       233500.0            5
3  Subaru  Outback        59500.0            2
4   Tesla  Model 3       184500.0            4

Gold Query Results (Normalized):
     make    model  total_revenue  total_sales
0    Audi       A4        81500.0            2
1     BMW       X5        63000.0            1
2    Ford  Mustang       233500.0            5
3  Subaru  Outback        59500.0            2
4   Tesla  Model 3       184500.0            4
78: Exact Match: True, Subset Match: True


Processing 79th question: What is the average number of citations received by publications in each year? on database: academic
Generation: SELECT publication.year, AVG(publication.citation_num) AS avg_citation_num FROM publication GROUP BY publication.year ORDER BY publication.year


Generated Query Results (Normalized):
   avg_citation_num  year
0               1.0  2021
1               3.0  2020

Gold Query Results (Normalized):
   avg_citation_num  year
0               1.0  2021
1               3.0  2020
79: Exact Match: True, Subset Match: True


Processing 80th question: How does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state. on database: geography
Generation: SELECT city.city_name, CAST(city.population AS FLOAT) / NULLIF(state.population, 0) AS population_proportion FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_proportion DESC NULLS LAST


Generated Query Results (Normalized):
     city_name  population_proportion
0      Houston                   40.0
1       London                  100.0
2  Los Angeles                   50.0
3       Mumbai                    6.0
4     New York                    5.0
5    Sao Paulo                   60.0
6        Tokyo                   10.0
7      Toronto                   10.0

Gold Query Results (Normalized):
     city_name  population_proportion
0      Houston                   40.0
1       London                  100.0
2  Los Angeles                   50.0
3       Mumbai                    6.0
4     New York                    5.0
5    Sao Paulo                   60.0
6        Tokyo                   10.0
7      Toronto                   10.0
80: Exact Match: True, Subset Match: True


Processing 81th question: Which aircraft code can carry the highest weight of cargo that any aircraft can carry? on database: atis
Generation: SELECT aircraft.aircraft_code, aircraft.weight FROM aircraft ORDER BY weight DESC NULLS LAST LIMIT 1


Generated Query Results (Normalized):
  aircraft_code   weight
0          A380  1235000

Gold Query Results (Normalized):
  aircraft_code   weight
0          A380  1235000
81: Exact Match: True, Subset Match: True


Processing 82th question: What are the names of the restaurants in Los Angeles that have a rating higher than 4? on database: restaurants
Generation: SELECT name FROM restaurant WHERE city_name = 'Los Angeles' AND rating > 4


Generated Query Results (Normalized):
              name
0  The Pasta House
1    The Sushi Bar

Gold Query Results (Normalized):
              name
0  The Pasta House
1    The Sushi Bar
82: Exact Match: True, Subset Match: True


Processing 83th question: What is the ratio of Italian restaurants out of all restaurants in Los Angeles? on database: restaurants
Generation: SELECT CAST(SUM(CASE WHEN restaurant.food_type ILIKE '%Italian%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(COUNT(*)) , 0) AS ratio FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%'

Error executing query: SELECT CAST(SUM(CASE WHEN restaurant.food_type ILIKE '%Italian%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(COUNT(*)) , 0) AS ratio FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%'
Error: (psycopg2.errors.GroupingError) aggregate function calls cannot be nested
LINE 1: ...alian%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(COUNT(*)) ...
                                                             ^

[SQL: SELECT CAST(SUM(CASE WHEN restaurant.food_type ILIKE '%%Italian%%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(COUNT(*)) , 0) AS ratio FROM restaurant WHERE restaurant.city_name ILIKE '%%Los Angeles%%']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
83: Exact Match: False, Subset Match: False


Processing 84th question: What is the ratio of aircraft capacity to its range in miles for each aircraft code? on database: atis
Generation: SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) / NULLIF(aircraft.range_miles, 0) AS capacity_to_range_ratio FROM aircraft ORDER BY capacity_to_range_ratio DESC NULLS LAST


Generated Query Results (Normalized):
  aircraft_code  capacity_to_range_ratio
0          A320                 0.072727
1          A330                 0.069291
2          A350                 0.055000
3          A380                 0.106625
4          B737                 0.059740
5          B747                 0.048627
6          B777                 0.064290
7          B787                 0.043825
8        CRJ200                 0.028818
9          E190                 0.047500

Gold Query Results (Normalized):
  aircraft_code  capacity_to_range_ratio
0          A320                 0.072727
1          A330                 0.069291
2          A350                 0.055000
3          A380                 0.106625
4          B737                 0.059740
5          B747                 0.048627
6          B777                 0.064290
7          B787                 0.043825
8        CRJ200                 0.028818
9          E190                 0.047500
84: Exact Match: True, Subset Match: True


Processing 85th question: What's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York? on database: restaurants
Generation: SELECT name, rating FROM restaurant WHERE rating > 4 AND city_name = 'New York'


Generated Query Results (Normalized):
              name  rating
0  The Pizza Place     4.7
1   The Ramen Shop     4.3

Gold Query Results (Normalized):
              name  rating
0  The Pizza Place     4.7
1   The Ramen Shop     4.3
85: Exact Match: True, Subset Match: True


Processing 86th question: How many restaurants serve Italian food in each region? on database: restaurants
Generation: SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST


Generated Query Results (Normalized):
   number_of_restaurants      region
0                      1  California
1                      1    New York

Gold Query Results (Normalized):
   number_of_restaurants      region
0                      1  California
1                      1    New York
86: Exact Match: True, Subset Match: True


Processing 87th question: How many reviews were there 2 months before the review with id 3? on database: yelp
Generation: SELECT COUNT(*) AS review_count FROM review WHERE month = (SELECT month FROM review WHERE rid = 3) - INTERVAL '2 months'

Error executing query: SELECT COUNT(*) AS review_count FROM review WHERE month = (SELECT month FROM review WHERE rid = 3) - INTERVAL '2 months'
Error: (psycopg2.errors.UndefinedFunction) operator does not exist: text - interval
LINE 1: ... month = (SELECT month FROM review WHERE rid = 3) - INTERVAL...
                                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT COUNT(*) AS review_count FROM review WHERE month = (SELECT month FROM review WHERE rid = 3) - INTERVAL '2 months']
(Background on this error at: https://sqlalche.me/e/20/f405)
Generated query returned no results.
87: Exact Match: False, Subset Match: False


Processing 88th question: What is the ratio of the population of the United States to the population of California? on database: geography
Generation: SELECT (state.population / NULLIF(state.population, 0)) AS ratio FROM state WHERE state.state_name ILIKE 'United States' INTERSECT SELECT (state.population / NULLIF(state.population, 0)) AS ratio FROM state WHERE state.state_name ILIKE 'California'

Generated query returned no results.
88: Exact Match: False, Subset Match: False


Processing 89th question: What are the highest mountains in meters, ordered from highest to lowest altitude? on database: geography
Generation: SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST


Generated Query Results (Normalized):
   mountain_altitude  mountain_name
0              10000  Mount Everest
1               9000   Nanga Parbat
2               8000        Cho Oyu
3               7000        Manaslu
4               6000     Dhaulagiri
5               5000             K2
6               4000         Makalu
7               3000  Kangchenjunga
8               2000         Lhotse
9               1000      Annapurna

Gold Query Results (Normalized):
   mountain_altitude  mountain_name
0              10000  Mount Everest
1               9000   Nanga Parbat
2               8000        Cho Oyu
3               7000        Manaslu
4               6000     Dhaulagiri
5               5000             K2
6               4000         Makalu
7               3000  Kangchenjunga
8               2000         Lhotse
9               1000      Annapurna
89: Exact Match: True, Subset Match: True


Processing 90th question: How many students were predicted to graduate in the last 10 years? on database: advising
Generation: SELECT COUNT(student.student_id) AS number_of_students FROM student WHERE student.predicted_graduation_semester >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '10 years'


Generated Query Results (Normalized):
   number_of_students
0                   4

Gold Query Results (Normalized):
   number_of_students
0                   4
90: Exact Match: True, Subset Match: True


Processing 91th question: Which neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood? on database: yelp
Generation: SELECT neighbourhood.neighbourhood_name, COUNT(DISTINCT business.business_id) AS business_count FROM business JOIN neighbourhood ON business.business_id = neighbourhood.business_id GROUP BY neighbourhood.neighbourhood_name ORDER BY business_count DESC NULLS LAST


Generated Query Results (Normalized):
   business_count neighbourhood_name
0               1          Hollywood
1               1    Upper East Side
2               2            Midtown
3               3           Downtown

Gold Query Results (Normalized):
   business_count neighbourhood_name
0               1          Hollywood
1               1    Upper East Side
2               2            Midtown
3               3           Downtown
91: Exact Match: True, Subset Match: True


Processing 92th question: What's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes on database: atis
Generation: SELECT EXTRACT(EPOCH FROM (to_timestamp(arrival_time) - to_timestamp(departure_time)) / 60) AS duration_minutes FROM flight


Generated Query Results (Normalized):
   duration_minutes
0         60.000000
1         61.666667
2         66.666667
3        166.666667
4        200.000000
5        250.000000
6        333.333333

Gold Query Results (Normalized):
   duration_minutes
0         60.000000
1         61.666667
2         66.666667
3        166.666667
4        200.000000
5        250.000000
6        333.333333
92: Exact Match: True, Subset Match: True


Processing 93th question: What are the names of the journals in the database, ordered by the length of the journal name from shortest to longest? on database: scholar
Generation: SELECT journal.journalname, journal.journalid FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST


Generated Query Results (Normalized):
   journalid                                        journalname
0          3  IEEE Transactions on Pattern Analysis and Mach...
1          4             International Journal of Mental Health
2          1                                             Nature
3          2                                            Science

Gold Query Results (Normalized):
   journalid                                        journalname
0          3  IEEE Transactions on Pattern Analysis and Mach...
1          4             International Journal of Mental Health
2          1                                             Nature
3          2                                            Science
93: Exact Match: True, Subset Match: True


Processing 94th question: What is the total number of publications published in each year? on database: academic
Generation: SELECT publication.year, COUNT(*) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year


Generated Query Results (Normalized):
   total_publications  year
0                   2  2020
1                   3  2021

Gold Query Results (Normalized):
   total_publications  year
0                   2  2020
1                   3  2021
94: Exact Match: True, Subset Match: True


Processing 95th question: How many course offerings have a final exam and how many do not? on database: advising
Generation: SELECT count(*), bool_or(has_final_exam) AS has_final_exam FROM course_offering GROUP BY has_final_exam


Generated Query Results (Normalized):
   count  has_final_exam
0      2           False
1      6            True

Gold Query Results (Normalized):
   count  has_final_exam
0      2           False
1      6            True
95: Exact Match: True, Subset Match: True


Processing 96th question: What are the top 2 airlines with the most flights? on database: atis
Generation: SELECT airline.airline_name, airline.airline_code, COUNT(flight.flight_number) AS flight_count FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY airline.airline_name, airline.airline_code ORDER BY flight_count DESC NULLS LAST LIMIT 2


Generated Query Results (Normalized):
  airline_code       airline_name  flight_count
0           AA  American Airlines             3
1           UA    United Airlines             2

Gold Query Results (Normalized):
  airline_code       airline_name  flight_count
0           UA    United Airlines             2
1           AA  American Airlines             3

Gold Query Results (Normalized):
  airline_code       airline_name  flight_count
0           UA    United Airlines             2
1           AA  American Airlines             3

Gold Query Results (Normalized):
  airline_code       airline_name  flight_count
0           UA    United Airlines             2
1           AA  American Airlines             3
96: Exact Match: False, Subset Match: True


Processing 97th question: What are the names and altitudes of the mountains in Nepal? on database: geography
Generation: SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name = 'Nepal'


Generated Query Results (Normalized):
   mountain_altitude  mountain_name
0               1000      Annapurna
1               2000         Lhotse
2               3000  Kangchenjunga
3               4000         Makalu
4               6000     Dhaulagiri
5               7000        Manaslu
6               8000        Cho Oyu
7              10000  Mount Everest

Gold Query Results (Normalized):
   mountain_altitude  mountain_name
0               1000      Annapurna
1               2000         Lhotse
2               3000  Kangchenjunga
3               4000         Makalu
4               6000     Dhaulagiri
5               7000        Manaslu
6               8000        Cho Oyu
7              10000  Mount Everest
97: Exact Match: True, Subset Match: True


Processing 98th question: Which countries have both lakes and rivers? on database: geography
Generation: SELECT DISTINCT lake.country_name AS country FROM lake JOIN river ON lake.country_name = river.country_name


Generated Query Results (Normalized):
         country
0          China
1         Russia
2  United States

Gold Query Results (Normalized):
         country
0          China
1         Russia
2  United States
98: Exact Match: True, Subset Match: True


Processing 99th question: How many keyphrases are associated with each paper? on database: scholar
Generation: SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid


Generated Query Results (Normalized):
   keyphrase_count  paperid
0                1        1
1                1        2
2                1        4
3                2        3
4                2        5

Gold Query Results (Normalized):
   keyphrase_count  paperid
0                1        1
1                1        2
2                1        4
3                2        3
4                2        5
99: Exact Match: True, Subset Match: True


Processed 100 rows.
Matched 75 rows.
Accuracy: 75.000%
