{"question":"What is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.","answer":"SELECT COUNT(*)::float \/ NULLIF((SELECT COUNT(*) FROM restaurant), 0) AS rating_ratio FROM restaurant WHERE rating > 4.5;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN rating > 4.5 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(*), 0) AS ratio FROM restaurant"}
{"question":"Which students have declared a minor program? List their firstname and lastname. Order the results by the students' last names.","answer":"SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname"}
{"question":"Return the student IDs who have taken an in-person course and have gotten a grade of A or C.","answer":"SELECT DISTINCT student_id FROM student_record WHERE student_record.how = 'in-person' AND student_record.grade IN ('A', 'C');","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT student_record.student_id FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.offering_id IN (SELECT offering_id FROM course_offering WHERE course_offering.course_id IN (SELECT course.course_id FROM course WHERE course.has_discussion = true)) AND student_record.grade IN ('A', 'C')"}
{"question":"Which courses have a final project and a final exam?","answer":"SELECT DISTINCT {course.name, course.course_id, course.number} FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course_offering.has_final_project = true AND course_offering.has_final_exam = true;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT course.name, course.course_id FROM course JOIN course_offering ON course.course_id = course_offering.course_id WHERE course_offering.has_final_project AND course_offering.has_final_exam"}
{"question":"Return the distinct list of user IDs who have received transaction notifications.","answer":"SELECT DISTINCT user_id FROM consumer_div.notifications WHERE type = 'transaction'","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_distinct","generation":"SELECT DISTINCT u.uid FROM consumer_div.notifications n JOIN consumer_div.users u ON n.user_id = u.uid WHERE n.type = 'transaction'"}
{"question":"What is the total number of papers published per year?","answer":"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year"}
{"question":"What is the latitude and longitude of the business with the highest rating?","answer":"SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id, business.latitude, business.longitude ORDER BY AVG(review.rating) DESC LIMIT 1;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT review.business_id, review.latitude, review.longitude FROM review ORDER BY review.rating DESC NULLS LAST LIMIT 1"}
{"question":"What is the average number of references cited by publications in each domain name?","answer":"SELECT {domain.name,domain.did}, AVG(publication.reference_num) AS average_references FROM domain_publication JOIN publication ON domain_publication.pid = publication.pid JOIN domain ON domain.did = domain_publication.did GROUP BY {};","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT domain.name, AVG(publication.reference_num) AS avg_reference_num FROM domain JOIN domain_publication ON domain.did = domain_publication.did JOIN publication ON domain_publication.pid = publication.pid GROUP BY domain.name"}
{"question":"Which merchants earliest coupon start date was within a year of the merchant's registration? Return the merchant id, registration date, and earliest coupon id and start date","answer":"WITH earliest_coupons AS (SELECT c.merchant_id, MIN(c.start_date) AS earliest_coupon_start_date FROM consumer_div.coupons c GROUP BY c.merchant_id) SELECT m.mid AS merchant_id, m.created_at AS merchant_registration_date, ec.earliest_coupon_start_date, c.cid AS earliest_coupon_id FROM consumer_div.merchants m JOIN earliest_coupons ec ON m.mid = ec.merchant_id JOIN consumer_div.coupons c ON ec.merchant_id = c.merchant_id AND ec.earliest_coupon_start_date = c.start_date WHERE ec.earliest_coupon_start_date <= m.created_at + INTERVAL '1 year';","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT m.mid, m.created_at AS registration_date, c.cid, c.start_date FROM consumer_div.merchants m JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.start_date >= m.created_at AND c.start_date < m.created_at + INTERVAL '1 year' ORDER BY m.created_at, c.start_date"}
{"question":"Return the top 5 salespersons by number of sales in the past 30 days? Return their first and last name, total sales count and total revenue amount.","answer":"SELECT sp.first_name, sp.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY sp.first_name, sp.last_name, sp.id ORDER BY total_sales DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_date_group_order_limit","generation":"SELECT s.salesperson_id, s.first_name, s.last_name, COUNT(*) AS total_sales, SUM(sale_price) AS total_revenue FROM sales s JOIN cars c ON s.car_id = c.id WHERE sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY s.salesperson_id, s.first_name, s.last_name ORDER BY total_sales DESC LIMIT 5"}
{"question":"Which airlines do not have any flights that either depart from\/arrive at JFK, or have one or more stops?","answer":"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM airline WHERE airline.airline_code NOT IN (SELECT flight.airline_code FROM flight WHERE flight.from_airport = 'JFK' OR flight.to_airport = 'JFK' OR flight.stops > 0);","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT DISTINCT airline.airline_name FROM airline WHERE NOT airline.airline_code IN (SELECT flight.airline_code FROM flight WHERE flight.from_airport = 'JFK' OR flight.to_airport = 'JFK' UNION SELECT flight.airline_code FROM flight WHERE flight.stops > 0)"}
{"question":"How many check-ins occurred on each day of the week?","answer":"SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT checkin.day, COUNT(*) AS num_checkins FROM checkin GROUP BY checkin.day ORDER BY num_checkins DESC"}
{"question":"How many distinct customers made each type of transaction between Jan 1, 2023 and Mar 31, 2023 (inclusive of start and end dates)? Return the transaction type, number of distinct customers and average number of shares, for the top 3 transaction types by number of customers.","answer":"SELECT t.sbTxType, COUNT(DISTINCT t.sbTxCustId) AS num_customers, AVG(t.sbTxShares) AS avg_shares FROM sbTransaction t WHERE t.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31 23:59:59' GROUP BY t.sbTxType ORDER BY num_customers DESC LIMIT 3","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_date_group_order_limit","generation":"SELECT tx.sbTxType, COUNT(DISTINCT tx.sbTxCustId) AS num_distinct_customers, AVG(tx.sbTxShares) AS avg_num_shares FROM sbTransaction tx WHERE tx.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY tx.sbTxType ORDER BY num_distinct_customers DESC LIMIT 3"}
{"question":"Which city has the highest-rated restaurant?","answer":"SELECT DISTINCT restaurant.city_name FROM restaurant WHERE rating=(SELECT MAX(rating) FROM restaurant);","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT restaurant.city_name FROM restaurant ORDER BY rating DESC NULLS LAST LIMIT 1"}
{"question":"Calculate the ratio of the maximum range to the maximum payload for each aircraft","answer":"SELECT aircraft.range_miles::float \/ NULLIF(aircraft.pay_load, 0) AS range_to_payload_ratio FROM aircraft;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT aircraft.aircraft_code, aircraft.wing_span, aircraft.pay_load, (CAST(aircraft.wing_span AS FLOAT) \/ NULLIF(aircraft.pay_load, 0)) AS range_payload_ratio FROM aircraft ORDER BY range_payload_ratio DESC"}
{"question":"Return the distinct list of doctor IDs, first names and last names that have prescribed treatments.","answer":"SELECT DISTINCT d.doc_id, d.first_name, d.last_name FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_distinct","generation":"SELECT DISTINCT d.doc_id, d.first_name, d.last_name FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id"}
{"question":"What is the average rating of restaurants in each region?","answer":"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name=restaurant.city_name GROUP BY 1;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region"}
{"question":"Which are the top 5 countries by total transaction amount sent by users, sender_type = 0? Return the country, number of distinct users who sent, and total transaction amount.","answer":"SELECT u.country, COUNT(DISTINCT t.sender_id) AS user_count, SUM(t.amount) AS total_amount FROM consumer_div.users u JOIN consumer_div.wallet_transactions_daily t ON u.uid = t.sender_id WHERE t.sender_type = 0 GROUP BY u.country ORDER BY total_amount DESC LIMIT 5","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_group_order_limit","generation":"SELECT c.country, COUNT(DISTINCT t.sender_id) AS num_distinct_senders, SUM(t.amount) AS total_transaction_amount FROM consumer_div.wallet_transactions_daily t JOIN consumer_div.users u ON t.sender_id = u.uid JOIN consumer_div.countries c ON u.country = c.code WHERE t.sender_type = 0 GROUP BY c.country ORDER BY total_transaction_amount DESC LIMIT 5"}
{"question":"What is the average rating of businesses in the city of San Francisco?","answer":"SELECT AVG(sf.average_rating) AS sf_average_rating FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE LOWER(business.city) ILIKE '%san francisco%' GROUP BY business.business_id) AS sf;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%San Francisco%'"}
{"question":"Return the distinct list of salesperson IDs that have received a cash payment, based on joining the salespersons, sales and payments_received tables.","answer":"SELECT DISTINCT s.id AS salesperson_id FROM salespersons s JOIN sales sa ON s.id = sa.salesperson_id JOIN payments_received p ON sa.id = p.sale_id WHERE p.payment_method = 'cash'","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_distinct","generation":"SELECT DISTINCT s.id AS salesperson_id FROM salespersons s JOIN sales s2 ON s.id = s2.salesperson_id JOIN payments_received pr ON s2.id = pr.sale_id WHERE pr.payment_method = 'Cash'"}
{"question":"What's the name and food type of all the restaurants located on Market St in San Francisco?","answer":"SELECT restaurant.name, restaurant.food_type FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE location.street_name ILIKE '%Market St%' AND location.city_name ILIKE '%San Francisco%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name, food_type FROM restaurant WHERE city_name = 'San Francisco' INTERSECT SELECT name, food_type FROM restaurant WHERE street_name = 'Market St'"}
{"question":"How many reviews were posted in each month of the year 2021, ordered by the month?","answer":"SELECT review.month, COUNT(review.rid) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.month ORDER BY TO_DATE(review.month, 'Month') NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT MONTH, COUNT(*) AS review_count FROM review WHERE year = 2021 GROUP BY MONTH ORDER BY MONTH"}
{"question":"What is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.","answer":"SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST"}
{"question":"What are the top 5 cities with the highest population? Give both city names and the population.","answer":"SELECT city.city_name, city.population FROM city ORDER BY city.population DESC NULLS LAST LIMIT 5;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT city_name, population FROM city ORDER BY population DESC NULLS LAST LIMIT 5"}
{"question":"Give me today's median merchant wallet balance for all active merchants whose category contains 'retail'","answer":"WITH retail_merchants AS (SELECT mid FROM consumer_div.merchants WHERE category ILIKE '%retail%' AND status = 'active' ), merchant_balances AS (SELECT balance FROM consumer_div.wallet_merchant_balance_daily wmbd JOIN retail_merchants rm ON wmbd.merchant_id = rm.mid WHERE DATE(wmbd.updated_at) = CURRENT_DATE ) SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY balance) AS median_balance FROM merchant_balances;","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT median(balance) AS median_balance FROM consumer_div.wallet_merchant_balance_daily WHERE merchant_id IN (SELECT m.mid FROM consumer_div.merchants m WHERE m.status = 'active' AND m.category ILIKE '%retail%' AND m.mcc <> 7000) AND date_trunc('day', updated_at) = CURRENT_DATE"}
{"question":"What is the ratio of the length of the Mississippi River to the length of the Rhine River?","answer":"SELECT CAST((SELECT length FROM river WHERE LOWER(river_name) LIKE '%mississippi%') AS FLOAT) \/ NULLIF((SELECT length FROM river WHERE LOWER(river_name) LIKE '%rhine%'), 0) AS ratio ;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT CAST(river.length AS FLOAT) \/ NULLIF(river.length, 0) AS ratio FROM river WHERE river.river_name = 'Mississippi River' INTERSECT SELECT CAST(river.length AS FLOAT) \/ NULLIF(river.length, 0) FROM river WHERE river.river_name = 'Rhine River'"}
{"question":"What is the average length of rivers per country in countries with a lake?","answer":"SELECT l.country_name, AVG(r.length) AS average_length FROM river r JOIN lake l ON r.country_name = l.country_name GROUP BY 1;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT lake.country_name, AVG(river.length) AS average_river_length FROM lake JOIN river ON lake.country_name = river.country_name WHERE lake.lake_name IS NOT NULL GROUP BY lake.country_name"}
{"question":"Return the car ID, make, model and year for cars that have no sales records, by doing a left join from the cars to sales table.","answer":"SELECT c.id AS car_id, c.make, c.model, c.year FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE s.car_id IS NULL","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_left_join","generation":"SELECT c.id, c.make, c.model, c.year FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE s.car_id IS NULL"}
{"question":"What are the names of the top 3 restaurants with the highest ratings?","answer":"SELECT restaurant.name FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST LIMIT 3;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT name FROM restaurant ORDER BY rating DESC NULLS LAST LIMIT 3"}
{"question":"What is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?","answer":"SELECT CAST(SUM(CASE WHEN restaurant.rating > 4.0 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN restaurant.rating < 4.0 THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM restaurant"}
{"question":"How many lakes are there in each state?","answer":"SELECT lake.state_name, COUNT(lake.lake_name) AS lake_count FROM lake GROUP BY lake.state_name ORDER BY lake_count DESC;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT lake.state_name, COUNT(lake.lake_name) AS number_of_lakes FROM lake GROUP BY lake.state_name ORDER BY number_of_lakes DESC"}
{"question":"What is the ratio of businesses in the state of California to businesses in the state of New York?","answer":"SELECT CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio FROM business;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT CAST(SUM(CASE WHEN business.state = 'CA' THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN business.state = 'NY' THEN 1 ELSE 0 END), 0) AS ratio FROM business"}
{"question":"What are the names of the restaurants that serve Italian food?","answer":"SELECT restaurant.name FROM restaurant WHERE LOWER(restaurant.food_type) ILIKE '%italian%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name FROM restaurant WHERE food_type ILIKE '%Italian%'"}
{"question":"Who are the top 2 merchants (receiver type 1) by total transaction amount in the past 150 days (inclusive of 150 days ago)? Return the merchant name, total number of transactions, and total transaction amount.","answer":"SELECT m.name AS merchant_name, COUNT(t.txid) AS total_transactions, SUM(t.amount) AS total_amount FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id WHERE t.receiver_type = 1 AND t.created_at >= CURRENT_DATE - INTERVAL '150 days' GROUP BY m.name ORDER BY total_amount DESC LIMIT 2","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_date_group_order_limit","generation":"SELECT m.name AS merchant_name, COUNT(t.txid) AS total_transactions, SUM(t.amount) AS total_transaction_amount FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id AND t.receiver_type = 1 AND t.created_at >= DATE_TRUNC('day', CURRENT_DATE - INTERVAL '150 days') GROUP BY m.name ORDER BY total_transaction_amount DESC LIMIT 2"}
{"question":"Return the customer ID and name of customers who have not made any transactions.","answer":"SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxCustId IS NULL","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_left_join","generation":"SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxId IS NULL"}
{"question":"What are the top 3 most common transaction statuses and their respective counts?","answer":"SELECT status, COUNT(*) AS COUNT FROM consumer_div.wallet_transactions_daily GROUP BY status ORDER BY COUNT DESC LIMIT 3","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_group_order_limit","generation":"SELECT status, COUNT(*) AS count FROM consumer_div.wallet_transactions_daily GROUP BY status ORDER BY COUNT DESC LIMIT 3"}
{"question":"What is the total number of reviews posted in the year 2021 for businesses in the category \"Cafe\"?","answer":"SELECT COUNT(review.rid) AS total_reviews FROM review JOIN category ON review.business_id = category.business_id WHERE review.year = 2021 AND category.category_name ILIKE '%Cafe%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT SUM(review.count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id JOIN review ON business.business_id = review.business_id WHERE category.category_name = 'Cafe' AND review.year = 2021"}
{"question":"How many distinct active users sent money per month in 2023? Return the number of active users per month (as a date), starting from the earliest date. Do not include merchants in the query. Only include successful transactions.","answer":"SELECT DATE_TRUNC('month', t.created_at) AS MONTH, COUNT(DISTINCT t.sender_id) AS active_users FROM consumer_div.wallet_transactions_daily t JOIN consumer_div.users u ON t.sender_id = u.uid WHERE t.sender_type = 0 AND t.status = 'success' AND u.status = 'active' AND t.created_at >= '2023-01-01' AND t.created_at < '2024-01-01' GROUP BY MONTH ORDER BY MONTH","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_date_group_order_limit","generation":"SELECT to_char(date_trunc('month', wallet_transactions_daily.created_at), 'YYYY-MM') AS month, COUNT(DISTINCT wallet_transactions_daily.sender_id) AS num_active_users FROM wallet_transactions_daily WHERE wallet_transactions_daily.status = 'SUCCESS' AND wallet_transactions_daily.sender_type = 1 AND wallet_transactions_daily.created_at >= '2023-01-01' AND wallet_transactions_daily.created_at < '2024-01-01' GROUP BY month ORDER BY MONTH"}
{"question":"What is the average GPA of students in the program mathematics?","answer":"SELECT AVG(student.total_gpa) FROM student JOIN program ON student.program_id = program.program_id WHERE LOWER(program.name) = 'mathematics';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT AVG(total_gpa) FROM student WHERE program_id IN (SELECT program_id FROM program WHERE name ILIKE '%mathematics%')"}
{"question":"How many authors wrote papers that were published in the journal \"Science\" in the year 2020?","answer":"SELECT COUNT(DISTINCT writes.authorid) AS number_of_authors FROM writes JOIN paper ON writes.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%Science%' AND paper.year = 2020;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT COUNT(DISTINCT a.authorid) AS number_of_authors FROM author a JOIN writes w ON a.authorid = w.authorid JOIN paper p ON w.paperid = p.paperid JOIN journal j ON p.journalid = j.journalid WHERE j.journalname = 'Science' AND p.year = 2020"}
{"question":"How does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?","answer":"SELECT {category.category_name, category.id}, CAST(COUNT(CASE WHEN review.rating > 3 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 END), 0) AS ratio FROM review JOIN category ON review.business_id = category.business_id GROUP BY {} ORDER BY ratio DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT c.category_name, COUNT(CASE WHEN r.rating > 3 THEN 1 END)::float \/ NULLIF(COUNT(CASE WHEN r.rating < 3 THEN 1 END), 0) AS positive_to_negative_ratio FROM business b JOIN category c ON b.business_id = c.business_id JOIN review r ON b.business_id = r.business_id GROUP BY c.category_name ORDER BY positive_to_negative_ratio DESC NULLS LAST"}
{"question":"Which flights serve meals in first class? Give me the flight id and meal description.","answer":"SELECT flight.flight_id, food_service.meal_description FROM flight JOIN food_service ON flight.meal_code = food_service.meal_code WHERE LOWER(food_service.compartment) LIKE '%first class%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT f.flight_id, m.meal_description FROM flight f JOIN food_service m ON f.meal_code = m.meal_code WHERE f.class_of_service = 'FIRST'"}
{"question":"How many flights require a round-trip to purchase the fare?","answer":"SELECT COUNT(DISTINCT flight_fare.flight_id) FROM flight_fare JOIN fare ON flight_fare.fare_id = fare.fare_id WHERE fare.round_trip_required = 'Yes';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT COUNT(*) AS round_trip_flights FROM fare WHERE round_trip_required = 'Y'"}
{"question":"What are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?","answer":"SELECT publication.title FROM publication ORDER BY publication.reference_num DESC LIMIT 3;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT publication.title, publication.reference_num FROM publication ORDER BY publication.reference_num DESC NULLS LAST LIMIT 3"}
{"question":"Return the patient IDs, first names and last names of patients who have not received any treatments.","answer":"SELECT p.patient_id, p.first_name, p.last_name FROM patients p LEFT JOIN treatments t ON p.patient_id = t.patient_id WHERE t.patient_id IS NULL","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_left_join","generation":"SELECT p.patient_id, p.first_name, p.last_name FROM patients p LEFT JOIN treatments t ON p.patient_id = t.patient_id WHERE t.patient_id IS NULL"}
{"question":"What is the ratio of check-ins on weekends to check-ins on weekdays for the business named \"Mark's Bistro\"?","answer":"SELECT CAST(SUM(CASE WHEN checkin.day IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN checkin.day NOT IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark''s Bistro%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT CAST(SUM(CASE WHEN checkin.day ILIKE '%Saturday%' OR checkin.day ILIKE '%Sunday%' THEN checkin.count ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN checkin.day ILIKE '%Monday%' OR checkin.day ILIKE '%Tuesday%' OR checkin.day ILIKE '%Wednesday%' OR checkin.day ILIKE '%Thursday%' OR checkin.day ILIKE '%Friday%' THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark\\'s Bistro%'"}
{"question":"How many mountains are there in each country?","answer":"SELECT mountain.country_name, COUNT(mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT mountain.country_name, COUNT(DISTINCT mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC"}
{"question":"What are the top 3 insurance types by average patient height in cm? Return the insurance type, average height and average weight.","answer":"SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight FROM patients GROUP BY ins_type ORDER BY avg_height DESC LIMIT 3","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_group_order_limit","generation":"SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight FROM patients GROUP BY ins_type ORDER BY avg_height DESC LIMIT 3"}
{"question":"What is the total number of check-ins on the 2 days before Saturday?","answer":"SELECT sum(COUNT) AS total_checkins FROM checkin WHERE DAY IN ('Thursday', 'Friday') ;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.day = 'Saturday' - INTERVAL '2 days'"}
{"question":"Which papers are associated with the keyphrase \"Machine Learning\"?","answer":"SELECT {paper.title,paper.paperid} FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT DISTINCT paper.title FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%'"}
{"question":"What are the names of the authors who have written publications in the domain \"Computer Science\"?","answer":"SELECT DISTINCT author.name FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_publication ON publication.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name ilike '%computer%science%';","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT DISTINCT {author.name, author.oid} FROM author JOIN domain_author ON author.aid = domain_author.aid JOIN domain ON domain_author.did = domain.did WHERE domain.name ILIKE '%Computer Science%'"}
{"question":"What is the average rating of restaurants that serve Mexican food in each city?","answer":"SELECT location.city_name, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE LOWER(restaurant.food_type) LIKE '%mexican%' GROUP BY location.city_name;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT r.city_name, AVG(r.rating) AS average_rating FROM restaurant r WHERE r.food_type ILIKE '%Mexican%' GROUP BY r.city_name ORDER BY average_rating DESC NULLS LAST"}
{"question":"Which state code is Orlando International Airport in?","answer":"SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%' LIMIT 1"}
{"question":"What is the total number of unique keyphrases associated with papers published in the journal with \"IEEE Transactions\" in its name?","answer":"SELECT COUNT(DISTINCT paperkeyphrase.keyphraseid) AS total_keyphrases FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid WHERE journal.journalname ILIKE '%IEEE Transactions%';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT COUNT(DISTINCT keyphrase.keyphraseid) FROM keyphrase JOIN paper ON keyphrase.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%IEEE Transactions%'"}
{"question":"Which states border the state where lake ontario is?","answer":"SELECT border_info.border FROM border_info JOIN lake ON border_info.state_name = lake.state_name WHERE lake.lake_name ilike '%Ontario%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT DISTINCT border_info.border FROM border_info JOIN lake ON lake.state_name = border_info.state_name WHERE lake.lake_name = 'Lake Ontario'"}
{"question":"Which users have posted reviews for businesses located in the neighbourhood of \"Downtown\" and how many reviews have they posted?","answer":"SELECT {users.name, users.user_id}, COUNT(review.rid) AS review_count FROM review JOIN neighbourhood ON review.business_id = neighbourhood.business_id JOIN users ON review.user_id = users.user_id WHERE neighbourhood.neighbourhood_name ILIKE '%Downtown%' GROUP BY {} ORDER BY review_count DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT u.name, COUNT(r.business_id) AS review_count FROM review r JOIN business b ON r.business_id = b.business_id JOIN neighbourhood n ON b.business_id = n.business_id JOIN users u ON r.user_id = u.user_id WHERE n.neighbourhood_name = 'Downtown' GROUP BY u.name ORDER BY review_count DESC"}
{"question":"Which cars were in inventory in the latest snapshot for march 2023? Return the car id, make, model, and year. Cars are considered to be in inventory\" if is_in_inventory is True.\"","answer":"WITH latest_snapshot AS (SELECT MAX(snapshot_date) AS snapshot_date FROM inventory_snapshots WHERE snapshot_date BETWEEN '2023-03-01' AND '2023-03-31' ), latest_snapshot_data AS (SELECT inv.car_id FROM inventory_snapshots inv JOIN latest_snapshot ls ON inv.snapshot_date = ls.snapshot_date WHERE inv.is_in_inventory = TRUE ) SELECT c.id, c.make, c.model, c.year FROM cars c JOIN latest_snapshot_data lsd ON c.id = lsd.car_id;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT c.id, c.make, c.model, c.year FROM cars c JOIN inventory_snapshots s ON c.id = s.car_id WHERE s.is_in_inventory = TRUE AND s.snapshot_date = (SELECT MAX(snapshot_date) FROM inventory_snapshots WHERE MONTH(snapshot_date) = 3 AND YEAR(snapshot_date) = 2023)"}
{"question":"What is the total number of students enrolled in each course, ordered from highest to lowest?","answer":"SELECT {course.course_id, course.name, course.number}, SUM(course.num_enrolled) AS total_students FROM course GROUP BY {} ORDER BY total_students DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT {course.name, course.course_id}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST"}
{"question":"Return merchants (merchant ID and name) who have not issued any coupons.","answer":"SELECT m.mid AS merchant_id, m.name AS merchant_name FROM consumer_div.merchants m LEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.cid IS NULL","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_left_join","generation":"SELECT m.mid, m.name FROM consumer_div.merchants m LEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.merchant_id IS NULL"}
{"question":"What were the total quarterly sales in 2023 grouped by customer's state? Represent each quarter as the first date in the quarter.","answer":"SELECT DATE_TRUNC('QUARTER', s.sale_date) AS QUARTER, c.state, SUM(s.sale_price) AS total_sales FROM sales s JOIN customers c ON s.customer_id = c.id WHERE EXTRACT(YEAR FROM s.sale_date) = 2023 GROUP BY c.state, QUARTER HAVING SUM(s.sale_price) > 0 ORDER BY QUARTER, c.state;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT SUM(sale_price) AS total_sales, to_char(sale_date, 'YYYY-q') AS quarter, c.state FROM sales s JOIN customers c ON s.customer_id = c.id WHERE sale_date >= '2023-01-01' AND sale_date < '2024-01-01' GROUP BY c.state, quarter ORDER BY total_sales DESC, c.state"}
{"question":"What is the total number of papers published in each journal, ordered by the journal name?","answer":"SELECT journal.journalname, COUNT(DISTINCT paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY journal.journalname ORDER BY journal.journalname NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT journal.journalname, COUNT(paper.paperid) AS total_papers FROM journal JOIN paper ON journal.journalid = paper.journalid GROUP BY journal.journalname ORDER BY journal.journalname"}
{"question":"Which street has the most number of restaurants?","answer":"SELECT street_name FROM location GROUP BY street_name ORDER BY COUNT(restaurant_id) DESC LIMIT 1;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT location.street_name, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM location GROUP BY location.street_name ORDER BY number_of_restaurants DESC NULLS LAST LIMIT 1"}
{"question":"What's the average predicted time to graduation since admission in no. of days?","answer":"SELECT avg(predicted_graduation_semester - admit_term) AS average_predicted_time_to_graduation FROM student;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT AVG(DATE_PART('day', predicted_graduation_semester - entered_as)::FLOAT) AS average_predicted_time_to_graduation FROM student"}
{"question":"Which organizations have authors who have written publications in the domain \"Machine Learning\"?","answer":"SELECT DISTINCT {organization.name, organization.oid} FROM organization JOIN author ON organization.oid = author.oid JOIN writes ON author.aid = writes.aid JOIN domain_publication ON writes.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name = 'Machine Learning';","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT DISTINCT {o.name, o.oid} FROM organization o JOIN domain_author da ON o.oid = da.oid JOIN domain d ON da.did = d.did JOIN publication_author pa ON da.aid = pa.aid JOIN publication p ON pa.pid = p.pid JOIN domain_publication dp ON d.did = dp.did WHERE d.name = 'Machine Learning'"}
{"question":"How many reviews were posted by users with the name \"Sarah Williams\" in the month of April 2021?","answer":"SELECT COUNT(*) FROM review JOIN users ON review.user_id = users.user_id WHERE users.name ILIKE '%Sarah Williams%' AND review.month = 'April' AND review.year = 2021;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT COUNT(*) AS review_count FROM review WHERE business_id IN (SELECT business.business_id FROM business JOIN users ON business.user_id = users.user_id WHERE users.name ILIKE '%Sarah Williams%' AND MONTH TO_CHAR(TO_DATE(review.year || '-' || review.month, 'YYYY-MM'), 'Mon') = 'April' AND review.year = 2021)"}
{"question":"Return the top 5 states by total revenue, showing the number of unique customers and total revenue (based on sale price) for each state.","answer":"SELECT c.state, COUNT(DISTINCT s.customer_id) AS unique_customers, SUM(s.sale_price) AS total_revenue FROM sales s JOIN customers c ON s.customer_id = c.id GROUP BY c.state ORDER BY total_revenue DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_group_order_limit","generation":"SELECT state, COUNT(DISTINCT customer_id) AS num_customers, SUM(sale_price) AS total_revenue FROM sales GROUP BY state ORDER BY total_revenue DESC NULLS LAST LIMIT 5"}
{"question":"How many courses does each department offer?","answer":"SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC"}
{"question":"What are the top 3 publications with the highest number of citations?","answer":"SELECT {publication.title, publication.pid}, publication.citation_num FROM publication ORDER BY publication.citation_num DESC LIMIT 3;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT {publication.title, publication.pid}, publication.citation_num FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 3"}
{"question":"What is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?","answer":"SELECT CAST(COUNT(CASE WHEN paper.numcitedby > 1 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN paper.numcitedby < 2 THEN 1 END), 0) AS ratio FROM paper;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN cited_papers_count >= 2 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN cited_papers_count < 2 THEN 1 END), 0) AS ratio FROM (SELECT cited_papers_count FROM (SELECT paper.paperid, COUNT(cite.citedpaperid) AS cited_papers_count FROM paper JOIN cite ON paper.paperid = cite.citingpaperid GROUP BY paper.paperid) AS subquery1) AS subquery2"}
{"question":"What is the proportion of papers that belong to more than 1 dataset to papers that belong to 1 dataset?","answer":"SELECT CAST(COUNT(CASE WHEN dataset_count > 1 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN dataset_count = 1 THEN 1 END), 0) AS ratio FROM (SELECT paperdataset.paperid, COUNT(paperdataset.datasetid) AS dataset_count FROM paperdataset GROUP BY paperdataset.paperid) AS subquery;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT CASE WHEN cnt > 1 THEN paperdataset.paperid END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT paperdataset.paperid), 0) AS ratio FROM (SELECT paperid, COUNT(datasetid) AS cnt FROM paperdataset GROUP BY paperid) AS subquery"}
{"question":"What month were most students admitted? Return the no. of students and the month as a date","answer":"SELECT date_trunc('month', s.admit_term) AS month, COUNT(*) AS total_students FROM student s GROUP BY MONTH ORDER BY total_students DESC LIMIT 1;SELECT TO_CHAR(DATE_TRUNC('month', s.admit_term), 'YYYY-MM') AS month, COUNT(*) AS total_students FROM student s GROUP BY month ORDER BY total_students DESC LIMIT 1;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT date_trunc('month', admit_term) AS month, COUNT(*) AS num_students FROM student GROUP BY month ORDER BY num_students DESC LIMIT 1"}
{"question":"What are the names and areas of the lakes in Michigan?","answer":"SELECT lake_name, area FROM lake WHERE state_name ILIKE '%Michigan%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT lake.lake_name, lake.area FROM lake WHERE lake.state_name = 'Michigan'"}
{"question":"Return the course id's that are offered in either semesters 1 or 2 and ends before 1pm and had an instructor on thursday.","answer":"SELECT DISTINCT co.course_id FROM course_offering co JOIN offering_instructor oi ON co.offering_id = oi.offering_id WHERE (co.semester = 1 OR co.semester = 2) AND co.end_time < '13:00:00' AND co.thursday IS NOT NULL;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT DISTINCT c.course_id FROM course c JOIN course_offering co ON c.course_id = co.course_id JOIN instructor i ON NOT i.instructor_id IS NULL JOIN offering_instructor oi ON i.instructor_id = oi.instructor_id WHERE co.semester = 1 OR co.semester = 2 AND co.end_time < '13:00:00' AND oi.thursday ILIKE '%yes%'"}
{"question":"What are the top 3 payment methods by total payment amount received? Return the payment method, total number of payments and total amount.","answer":"SELECT payment_method, COUNT(*) AS total_payments, SUM(payment_amount) AS total_amount FROM payments_received GROUP BY payment_method ORDER BY total_amount DESC LIMIT 3","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_group_order_limit","generation":"SELECT payment_method, COUNT(*) AS total_payments, SUM(payment_amount) AS total_amount FROM payments_received GROUP BY payment_method ORDER BY total_amount DESC LIMIT 3"}
{"question":"What are the titles of all publications ordered alphabetically?","answer":"SELECT DISTINCT publication.title FROM publication ORDER BY publication.title ASC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT publication.title FROM publication ORDER BY publication.title ASC NULLS LAST"}
{"question":"What is the average rating of restaurants serving each type of food?","answer":"SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type ORDER BY average_rating DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type"}
{"question":"What's the absolute difference in time in days between today and the earliest flight departure? Give the answer as an integer.","answer":"SELECT date_part('day', CURRENT_DATE - to_timestamp(departure_time)) AS difference_in_days FROM flight ORDER BY departure_time LIMIT 1;SELECT (CURRENT_DATE - TO_TIMESTAMP(MIN(f.departure_time))) AS days_difference FROM flight f;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT (CURRENT_DATE - MIN(departure_time)::DATE) AS difference_in_days FROM flight"}
{"question":"What is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?","answer":"SELECT venue.venuename, COUNT(DISTINCT paper.paperid) FROM paper JOIN venue ON paper.venueid = venue.venueid WHERE paper.venueid = (SELECT venueid FROM paper WHERE paperid = 2 ) GROUP BY venue.venuename;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT paper.venue.venuename, COUNT(paper.paperid) AS total_papers FROM paper JOIN venue ON paper.venueid = venue.venueid WHERE paper.paperid = 2 GROUP BY paper.venue.venuename"}
{"question":"What are the top 5 best selling car models by total revenue? Return the make, model, total number of sales and total revenue.","answer":"SELECT c.make, c.model, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN cars c ON s.car_id = c.id GROUP BY c.make, c.model ORDER BY total_revenue DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_group_order_limit","generation":"SELECT c.make, c.model, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM cars c JOIN sales s ON c.id = s.car_id GROUP BY c.make, c.model ORDER BY total_revenue DESC LIMIT 5"}
{"question":"What is the average number of citations received by publications in each year?","answer":"SELECT publication.year, AVG(publication.citation_num) AS average_citations FROM publication GROUP BY publication.year ORDER BY publication.year NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT publication.year, AVG(publication.citation_num) AS avg_citation_num FROM publication GROUP BY publication.year ORDER BY publication.year"}
{"question":"How does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.","answer":"SELECT city.city_name, CAST(city.population AS float) \/ NULLIF(state.population, 0) AS population_ratio FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_ratio DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT city.city_name, CAST(city.population AS FLOAT) \/ NULLIF(state.population, 0) AS population_proportion FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_proportion DESC NULLS LAST"}
{"question":"Which aircraft code can carry the highest weight of cargo that any aircraft can carry?","answer":"SELECT aircraft.aircraft_code FROM aircraft ORDER BY pay_load DESC NULLS LAST LIMIT 1;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT aircraft.aircraft_code, aircraft.weight FROM aircraft ORDER BY aircraft.weight DESC NULLS LAST LIMIT 1"}
{"question":"What are the names of the restaurants in Los Angeles that have a rating higher than 4?","answer":"SELECT DISTINCT restaurant.name FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%' AND restaurant.rating > 4 ORDER BY restaurant.name NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name FROM restaurant WHERE rating > 4 AND city_name ILIKE '%Los Angeles%'"}
{"question":"What is the ratio of Italian restaurants out of all restaurants in Los Angeles?","answer":"SELECT CAST(COUNT(CASE WHEN food_type ILIKE '%Italian%' THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(food_type), 0) AS ratio FROM restaurant WHERE city_name ILIKE '%Los Angeles%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT CASE WHEN restaurant.city_name ILIKE '%Los Angeles%' AND restaurant.food_type ILIKE '%Italian%' THEN restaurant.id END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN restaurant.city_name ILIKE '%Los Angeles%' THEN restaurant.id END), 0) AS ratio FROM restaurant"}
{"question":"What is the ratio of aircraft capacity to its range in miles for each aircraft code?","answer":"SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) \/ NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio FROM aircraft;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) \/ NULLIF(aircraft.range_miles, 0) AS capacity_to_range FROM aircraft ORDER BY aircraft.aircraft_code"}
{"question":"What's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?","answer":"SELECT restaurant.name, restaurant.rating FROM restaurant WHERE restaurant.rating > 4 AND restaurant.city_name ILIKE '%New York%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name, rating FROM restaurant WHERE rating > 4 AND city_name = 'New York'"}
{"question":"How many restaurants serve Italian food in each region?","answer":"SELECT geographic.region, COUNT(restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY geographic.region"}
{"question":"How many reviews were there 2 months before the review with id 3?","answer":"SELECT COUNT(*) AS review_count FROM review WHERE TO_DATE(CAST(review.year AS TEXT) || '-' || CASE review.month WHEN 'January' THEN '01' WHEN 'February' THEN '02' WHEN 'March' THEN '03' WHEN 'April' THEN '04' WHEN 'May' THEN '05' WHEN 'June' THEN '06' WHEN 'July' THEN '07' WHEN 'August' THEN '08' WHEN 'September' THEN '09' WHEN 'October' THEN '10' WHEN 'November' THEN '11' WHEN 'December' THEN '12' END || '-01', 'YYYY-MM-DD') = (SELECT TO_DATE(CAST(r.year AS TEXT) || '-' || CASE r.month WHEN 'January' THEN '01' WHEN 'February' THEN '02' WHEN 'March' THEN '03' WHEN 'April' THEN '04' WHEN 'May' THEN '05' WHEN 'June' THEN '06' WHEN 'July' THEN '07' WHEN 'August' THEN '08' WHEN 'September' THEN '09' WHEN 'October' THEN '10' WHEN 'November' THEN '11' WHEN 'December' THEN '12' END || '-01', 'YYYY-MM-DD') - INTERVAL '2 months' FROM review r WHERE r.rid = 3);","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT COUNT(*) AS review_count FROM review WHERE MONTH ILIKE '%January%' AND YEAR = (SELECT EXTRACT(YEAR FROM TO_DATE((SELECT MONTH FROM review WHERE rid = 3) || ' ' || (SELECT YEAR FROM review WHERE rid = 3) - 2, 'Month YYYY')))"}
{"question":"What is the ratio of the population of the United States to the population of California?","answer":"SELECT CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.country_name) LIKE '%united states%') AS FLOAT) \/ CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.state_name) LIKE '%california%') AS FLOAT) AS population_ratio FROM state;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT (state.population \/ NULLIF(CAST(state.population AS FLOAT) \/ NULLIF(SUM(CASE WHEN state.state_name = 'California' THEN state.population ELSE 0 END) OVER (), 0), 0), 0) AS population_ratio FROM state"}
{"question":"What are the highest mountains in meters, ordered from highest to lowest altitude?","answer":"SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST"}
{"question":"How many students were predicted to graduate in the last 10 years?","answer":"SELECT count(*) AS num_students_graduated FROM student WHERE predicted_graduation_semester >= DATE_TRUNC('year', CURRENT_DATE) - interval '10 year';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT COUNT(student.student_id) AS number_of_students FROM student WHERE student.predicted_graduation_semester >= CURRENT_DATE - INTERVAL '10 years'"}
{"question":"Which neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?","answer":"SELECT {neighbourhood.neighbourhood_name, neighbourhood.id}, COUNT(DISTINCT neighbourhood.business_id) AS business_count FROM neighbourhood GROUP BY {} ORDER BY business_count DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT neighbourhood.neighbourhood_name, COUNT(DISTINCT business.business_id) AS business_count FROM business JOIN neighbourhood ON business.business_id = neighbourhood.business_id GROUP BY neighbourhood.neighbourhood_name ORDER BY business_count DESC NULLS LAST"}
{"question":"What's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes","answer":"SELECT avg(to_timestamp(arrival_time) - to_timestamp(departure_time) - interval '34 minutes') AS average_duration FROM flight;SELECT AVG(arrival_time - departure_time)\/60 - 34 AS average_duration FROM flight;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT EXTRACT(EPOCH FROM (to_timestamp(arrival_time) - to_timestamp(departure_time)) \/ 60) AS duration_minutes FROM flight"}
{"question":"What are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?","answer":"SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname)"}
{"question":"What is the total number of publications published in each year?","answer":"SELECT publication.year, COUNT(DISTINCT publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT publication.year, COUNT(publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year"}
{"question":"How many course offerings have a final exam and how many do not?","answer":"SELECT course_offering.has_final_exam, COUNT(offering_id) AS num_courses FROM course_offering GROUP BY course_offering.has_final_exam;SELECT COUNT(CASE WHEN co.has_final_exam THEN 1 END) AS num_with_final_exam, COUNT(CASE WHEN NOT co.has_final_exam THEN 1 END) AS num_without_final_exam FROM course_offering co;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT SUM(CASE WHEN has_final_exam THEN 1 ELSE 0 END) AS num_offerings_with_final_exam, SUM(CASE WHEN NOT has_final_exam THEN 1 ELSE 0 END) AS num_offerings_without_final_exam FROM course_offering"}
{"question":"What are the top 2 airlines with the most flights?","answer":"SELECT {airline.airline_name, airline.airline_code}, COUNT(flight.flight_id) AS number_of_flights FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY {} ORDER BY number_of_flights DESC NULLS LAST LIMIT 2;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT airline.airline_name, COUNT(flight.airline_code) AS flight_count FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY airline.airline_name ORDER BY flight_count DESC LIMIT 2"}
{"question":"What are the names and altitudes of the mountains in Nepal?","answer":"SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name ILIKE '%Nepal%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain WHERE mountain.country_name ILIKE '%Nepal%'"}
{"question":"Which countries have both lakes and rivers?","answer":"SELECT DISTINCT lake.country_name FROM lake JOIN river ON lake.country_name = river.country_name;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT lake.country_name AS country FROM lake JOIN river ON lake.country_name = river.country_name"}
{"question":"How many keyphrases are associated with each paper?","answer":"SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY keyphrase_count DESC NULLS LAST;SELECT p.title, COUNT(pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid GROUP BY p.title ORDER BY num_keyphrases DESC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT paperkeyphrase.paperid, COUNT(DISTINCT paperkeyphrase.keyphraseid) AS num_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid"}
