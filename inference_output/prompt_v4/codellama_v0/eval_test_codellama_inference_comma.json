[
{"question":"What is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.","answer":"SELECT COUNT(*)::float \/ NULLIF((SELECT COUNT(*) FROM restaurant), 0) AS rating_ratio FROM restaurant WHERE rating > 4.5;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            restaurant\n        WHERE\n            rating > 4.5\n    ) \/\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            restaurant\n    )"},
{"question":"Which students have declared a minor program? List their firstname and lastname. Order the results by the students' last names.","answer":"SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT firstname, lastname\nFROM student\nWHERE minor IS NOT NULL\nORDER BY lastname"},
{"question":"Return the student IDs who have taken an in-person course and have gotten a grade of A or C.","answer":"SELECT DISTINCT student_id FROM student_record WHERE student_record.how = 'in-person' AND student_record.grade IN ('A', 'C');","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT DISTINCT student_id\nFROM student_record\nWHERE course_id IN (SELECT course_id\n                     FROM course\n                     WHERE has_in_person = 't')\nAND grade IN ('A', 'C')"},
{"question":"Which courses have a final project and a final exam?","answer":"SELECT DISTINCT {course.name, course.course_id, course.number} FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course_offering.has_final_project = true AND course_offering.has_final_exam = true;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT course.name\nFROM course\nINNER JOIN course_offering ON course.course_id = course_offering.course_id\nWHERE course_offering.has_final_project = true\nAND course_offering.has_final_exam = true"},
{"question":"Return the distinct list of user IDs who have received transaction notifications.","answer":"SELECT DISTINCT user_id FROM consumer_div.notifications WHERE type = 'transaction'","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_distinct","generation":"SELECT DISTINCT(user_id)\nFROM consumer_div.notifications\nWHERE type = 'transaction'\nAND status = 'delivered'"},
{"question":"What is the total number of papers published per year?","answer":"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT year, COUNT(*) AS total\nFROM paper\nGROUP BY year\nORDER BY year"},
{"question":"What is the latitude and longitude of the business with the highest rating?","answer":"SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id, business.latitude, business.longitude ORDER BY AVG(review.rating) DESC LIMIT 1;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT latitude, longitude\nFROM public.business\nWHERE business_id = (\n    SELECT business_id\n    FROM public.review\n    WHERE rating = (\n        SELECT MAX(rating)\n        FROM public.review\n    )\n)"},
{"question":"What is the average number of references cited by publications in each domain name?","answer":"SELECT {domain.name,domain.did}, AVG(publication.reference_num) AS average_references FROM domain_publication JOIN publication ON domain_publication.pid = publication.pid JOIN domain ON domain.did = domain_publication.did GROUP BY {};","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT \n    domain.name,\n    AVG(publication.reference_num)\nFROM\n    publication\n    JOIN domain_publication ON publication.pid = domain_publication.pid\n    JOIN domain ON domain_publication.did = domain.did\nGROUP BY\n    domain.name\n[\/SQL]\n\n### Explanation\nThe query joins the publication table with the domain_publication table to get the publication IDs for each domain. It then joins the publication table with the domain table to get the average number of references cited by publications in each domain."},
{"question":"Which merchants earliest coupon start date was within a year of the merchant's registration? Return the merchant id, registration date, and earliest coupon id and start date","answer":"WITH earliest_coupons AS (SELECT c.merchant_id, MIN(c.start_date) AS earliest_coupon_start_date FROM consumer_div.coupons c GROUP BY c.merchant_id) SELECT m.mid AS merchant_id, m.created_at AS merchant_registration_date, ec.earliest_coupon_start_date, c.cid AS earliest_coupon_id FROM consumer_div.merchants m JOIN earliest_coupons ec ON m.mid = ec.merchant_id JOIN consumer_div.coupons c ON ec.merchant_id = c.merchant_id AND ec.earliest_coupon_start_date = c.start_date WHERE ec.earliest_coupon_start_date <= m.created_at + INTERVAL '1 year';","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT m.mid, m.created_at, c.cid, c.start_date\nFROM consumer_div.merchants m\nJOIN consumer_div.coupons c ON m.mid = c.merchant_id\nWHERE c.start_date >= m.created_at - INTERVAL '1 year'\nORDER BY m.mid, c.start_date\n[\/SQL]\n\n### Explanation\nThe query joins the merchants table with the coupons table on the merchant id. The join condition is that the merchant id in the coupons table is equal to the merchant id in the merchants table. The where clause filters the results to only include coupons that have a start date that is greater than or equal to the merchant's registration date minus one year. The order by clause orders the results by the merchant id and the start date of the coupon.\n\n### Example\nThe following is an example of the output of the query:\n[SQL]\nSELECT m.mid, m.created_at, c.cid, c.start_date\nFROM consumer_div.merchants m\nJOIN consumer_div.coupons c ON m.mid = c.merchant_id\nWHERE c.start_date >= m.created_at - INTERVAL '1 year'\nORDER BY m.mid, c.start_date\n[\/SQL]\n\n| mid | created_at | cid | start_date |\n| --- | ---------- | --- | ---------- |\n| 1 | 2020-01-01 | 1 | 2020-01-01 |\n| 1 | 2020-01-01 | 2 | 2020-01-02 |\n| 1 | 2020-01-01 | 3 | 2020-01-03 |\n| 2 | 2020-01-02 | 4 | 2020-01-04 |\n| 2 | 2020-01-02 | 5 | 2020-01-05 |\n| 3 | 2020-01-"},
{"question":"Return the top 5 salespersons by number of sales in the past 30 days? Return their first and last name, total sales count and total revenue amount.","answer":"SELECT sp.first_name, sp.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons sp ON s.salesperson_id = sp.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '30 days' GROUP BY sp.first_name, sp.last_name, sp.id ORDER BY total_sales DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_date_group_order_limit","generation":"SELECT salespersons.first_name, salespersons.last_name, COUNT(sales.id) AS sales_count, SUM(sales.sale_price) AS revenue_amount\nFROM sales\nINNER JOIN salespersons ON sales.salesperson_id = salespersons.id\nWHERE sales.sale_date > NOW() - INTERVAL '30 days'\nGROUP BY salespersons.id\nORDER BY sales_count DESC\nLIMIT 5"},
{"question":"Which airlines do not have any flights that either depart from\/arrive at JFK, or have one or more stops?","answer":"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM airline WHERE airline.airline_code NOT IN (SELECT flight.airline_code FROM flight WHERE flight.from_airport = 'JFK' OR flight.to_airport = 'JFK' OR flight.stops > 0);","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT DISTINCT airline_code\nFROM flight\nWHERE NOT EXISTS (\n    SELECT *\n    FROM flight\n    WHERE flight.airline_code = flight_2.airline_code\n    AND flight.flight_id = flight_2.flight_id\n    AND (\n        (\n            flight.from_airport = 'JFK'\n            AND flight_2.to_airport = 'JFK'\n        )\n        OR\n        (\n            flight.to_airport = 'JFK'\n            AND flight_2.from_airport = 'JFK'\n        )\n    )\n)\nAND NOT EXISTS (\n    SELECT *\n    FROM flight_stop\n    WHERE flight_stop.flight_id = flight.flight_id\n    AND flight_stop.stop_airport = 'JFK'\n)"},
{"question":"How many check-ins occurred on each day of the week?","answer":"SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT day, count(cid) as checkins\nFROM checkin\nGROUP BY day\nORDER BY day"},
{"question":"How many distinct customers made each type of transaction between Jan 1, 2023 and Mar 31, 2023 (inclusive of start and end dates)? Return the transaction type, number of distinct customers and average number of shares, for the top 3 transaction types by number of customers.","answer":"SELECT t.sbTxType, COUNT(DISTINCT t.sbTxCustId) AS num_customers, AVG(t.sbTxShares) AS avg_shares FROM sbTransaction t WHERE t.sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31 23:59:59' GROUP BY t.sbTxType ORDER BY num_customers DESC LIMIT 3","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_date_group_order_limit","generation":"SELECT sbTxType, COUNT(DISTINCT sbTxCustId) AS num_distinct_customers, AVG(sbTxShares) AS avg_shares\nFROM sbTransaction\nWHERE sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31'\nGROUP BY sbTxType\nORDER BY COUNT(DISTINCT sbTxCustId) DESC\nLIMIT 3"},
{"question":"Which city has the highest-rated restaurant?","answer":"SELECT DISTINCT restaurant.city_name FROM restaurant WHERE rating=(SELECT MAX(rating) FROM restaurant);","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT city_name\nFROM public.restaurant\nWHERE rating = (SELECT MAX(rating)\n                 FROM public.restaurant)"},
{"question":"Calculate the ratio of the maximum range to the maximum payload for each aircraft","answer":"SELECT aircraft.range_miles::float \/ NULLIF(aircraft.pay_load, 0) AS range_to_payload_ratio FROM aircraft;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT aircraft_code,\n       (SELECT MAX(range_miles)\n        FROM aircraft) \/ MAX(pay_load) AS ratio\nFROM aircraft"},
{"question":"Return the distinct list of doctor IDs, first names and last names that have prescribed treatments.","answer":"SELECT DISTINCT d.doc_id, d.first_name, d.last_name FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_distinct","generation":"SELECT DISTINCT doctors.doc_id, doctors.first_name, doctors.last_name\nFROM doctors\nJOIN treatments ON doctors.doc_id = treatments.doc_id\nJOIN patients ON treatments.patient_id = patients.patient_id\nWHERE treatments.treatment_id IS NOT NULL"},
{"question":"What is the average rating of restaurants in each region?","answer":"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name=restaurant.city_name GROUP BY 1;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT region, AVG(rating)\nFROM restaurant\nJOIN location ON restaurant.city_name = location.city_name\nJOIN geographic ON location.city_name = geographic.city_name\nGROUP BY region"},
{"question":"Which are the top 5 countries by total transaction amount sent by users, sender_type = 0? Return the country, number of distinct users who sent, and total transaction amount.","answer":"SELECT u.country, COUNT(DISTINCT t.sender_id) AS user_count, SUM(t.amount) AS total_amount FROM consumer_div.users u JOIN consumer_div.wallet_transactions_daily t ON u.uid = t.sender_id WHERE t.sender_type = 0 GROUP BY u.country ORDER BY total_amount DESC LIMIT 5","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_group_order_limit","generation":"SELECT country, COUNT(DISTINCT sender_id) AS distinct_users, SUM(amount) AS total_transaction_amount\nFROM consumer_div.wallet_transactions_daily\nWHERE sender_type = 0\nGROUP BY country\nORDER BY total_transaction_amount DESC\nLIMIT 5"},
{"question":"What is the average rating of businesses in the city of San Francisco?","answer":"SELECT AVG(sf.average_rating) AS sf_average_rating FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE LOWER(business.city) ILIKE '%san francisco%' GROUP BY business.business_id) AS sf;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT AVG(rating)\nFROM public.review\nWHERE city = 'San Francisco'"},
{"question":"Return the distinct list of salesperson IDs that have received a cash payment, based on joining the salespersons, sales and payments_received tables.","answer":"SELECT DISTINCT s.id AS salesperson_id FROM salespersons s JOIN sales sa ON s.id = sa.salesperson_id JOIN payments_received p ON sa.id = p.sale_id WHERE p.payment_method = 'cash'","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_distinct","generation":"SELECT DISTINCT salespersons.id\nFROM salespersons\nJOIN sales ON salespersons.id = sales.salesperson_id\nJOIN payments_received ON sales.id = payments_received.sale_id\nWHERE payments_received.payment_method = 'Cash'"},
{"question":"What's the name and food type of all the restaurants located on Market St in San Francisco?","answer":"SELECT restaurant.name, restaurant.food_type FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE location.street_name ILIKE '%Market St%' AND location.city_name ILIKE '%San Francisco%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT restaurant.name, restaurant.food_type\nFROM public.restaurant\nJOIN public.location ON restaurant.id = location.restaurant_id\nJOIN public.geographic ON location.city_name = geographic.city_name\nWHERE geographic.city_name = 'San Francisco'\nAND location.street_name = 'Market St'"},
{"question":"How many reviews were posted in each month of the year 2021, ordered by the month?","answer":"SELECT review.month, COUNT(review.rid) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.month ORDER BY TO_DATE(review.month, 'Month') NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT month, COUNT(*) AS review_count\nFROM public.review\nWHERE year = 2021\nGROUP BY month\nORDER BY month"},
{"question":"What is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.","answer":"SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT student_id, SUM(credits) AS total_credits\nFROM student_record\nJOIN course ON student_record.course_id = course.course_id\nGROUP BY student_id\nORDER BY total_credits DESC"},
{"question":"What are the top 5 cities with the highest population? Give both city names and the population.","answer":"SELECT city.city_name, city.population FROM city ORDER BY city.population DESC NULLS LAST LIMIT 5;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT city_name, population\nFROM city\nORDER BY population DESC\nLIMIT 5"},
{"question":"Give me today's median merchant wallet balance for all active merchants whose category contains 'retail'","answer":"WITH retail_merchants AS (SELECT mid FROM consumer_div.merchants WHERE category ILIKE '%retail%' AND status = 'active' ), merchant_balances AS (SELECT balance FROM consumer_div.wallet_merchant_balance_daily wmbd JOIN retail_merchants rm ON wmbd.merchant_id = rm.mid WHERE DATE(wmbd.updated_at) = CURRENT_DATE ) SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY balance) AS median_balance FROM merchant_balances;","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT \n    m.mid,\n    m.name,\n    m.country,\n    m.state,\n    m.city,\n    m.postal_code,\n    m.address,\n    m.status,\n    m.category,\n    m.sub_category,\n    m.mcc,\n    m.contact_name,\n    m.contact_email,\n    m.contact_phone,\n    m.logo_url,\n    m.website_url,\n    m.description,\n    m.created_at,\n    m.updated_at,\n    m.kyc_status,\n    m.kyc_verified_at,\n    m.address_billing,\n    m.address_delivery,\n    w.balance AS merchant_balance,\n    w.updated_at AS merchant_balance_updated_at\nFROM \n    consumer_div.merchants m\n    INNER JOIN consumer_div.wallet_merchant_balance_daily w ON m.mid = w.merchant_id\nWHERE \n    m.status = 'active'\n    AND m.category LIKE '%retail%'\n    AND w.updated_at = (\n        SELECT \n            MAX(updated_at)\n        FROM \n            consumer_div.wallet_merchant_balance_daily\n        WHERE \n            merchant_id = m.mid\n    )\nORDER BY \n    m.mid"},
{"question":"What is the ratio of the length of the Mississippi River to the length of the Rhine River?","answer":"SELECT CAST((SELECT length FROM river WHERE LOWER(river_name) LIKE '%mississippi%') AS FLOAT) \/ NULLIF((SELECT length FROM river WHERE LOWER(river_name) LIKE '%rhine%'), 0) AS ratio ;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT\n    (\n        SELECT\n            length\n        FROM\n            river\n        WHERE\n            river_name = 'Mississippi River'\n    ) \/\n    (\n        SELECT\n            length\n        FROM\n            river\n        WHERE\n            river_name = 'Rhine River'\n    )"},
{"question":"What is the average length of rivers per country in countries with a lake?","answer":"SELECT l.country_name, AVG(r.length) AS average_length FROM river r JOIN lake l ON r.country_name = l.country_name GROUP BY 1;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT country_name, AVG(length)\nFROM river\nJOIN lake ON lake.country_name = river.country_name\nGROUP BY country_name\n[\/SQL]\n\n### Explanation\nThe query joins the river and lake tables on the country_name column. The AVG function calculates the average length of rivers per country. The GROUP BY clause groups the results by country_name."},
{"question":"Return the car ID, make, model and year for cars that have no sales records, by doing a left join from the cars to sales table.","answer":"SELECT c.id AS car_id, c.make, c.model, c.year FROM cars c LEFT JOIN sales s ON c.id = s.car_id WHERE s.car_id IS NULL","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_left_join","generation":"SELECT c.id, c.make, c.model, c.year\nFROM cars c\nLEFT JOIN sales s ON c.id = s.car_id\nWHERE s.id IS NULL"},
{"question":"What are the names of the top 3 restaurants with the highest ratings?","answer":"SELECT restaurant.name FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST LIMIT 3;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT name\nFROM restaurant\nWHERE rating = (SELECT MAX(rating)\n                 FROM restaurant)"},
{"question":"What is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?","answer":"SELECT CAST(SUM(CASE WHEN restaurant.rating > 4.0 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN restaurant.rating < 4.0 THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            restaurant\n        WHERE\n            rating > 4.0\n    ) \/ (\n        SELECT\n            COUNT(*)\n        FROM\n            restaurant\n        WHERE\n            rating < 4.0\n    )"},
{"question":"How many lakes are there in each state?","answer":"SELECT lake.state_name, COUNT(lake.lake_name) AS lake_count FROM lake GROUP BY lake.state_name ORDER BY lake_count DESC;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT state_name, COUNT(*)\nFROM lake\nGROUP BY state_name"},
{"question":"What is the ratio of businesses in the state of California to businesses in the state of New York?","answer":"SELECT CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio FROM business;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT\n    (\n        SELECT COUNT(*)\n        FROM business\n        WHERE state = 'CA'\n    ) \/ (\n        SELECT COUNT(*)\n        FROM business\n        WHERE state = 'NY'\n    ) AS ratio"},
{"question":"What are the names of the restaurants that serve Italian food?","answer":"SELECT restaurant.name FROM restaurant WHERE LOWER(restaurant.food_type) ILIKE '%italian%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name\nFROM restaurant\nWHERE food_type = 'Italian'"},
{"question":"Who are the top 2 merchants (receiver type 1) by total transaction amount in the past 150 days (inclusive of 150 days ago)? Return the merchant name, total number of transactions, and total transaction amount.","answer":"SELECT m.name AS merchant_name, COUNT(t.txid) AS total_transactions, SUM(t.amount) AS total_amount FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id WHERE t.receiver_type = 1 AND t.created_at >= CURRENT_DATE - INTERVAL '150 days' GROUP BY m.name ORDER BY total_amount DESC LIMIT 2","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_date_group_order_limit","generation":"SELECT m.name, COUNT(wtd.txid) as total_transactions, SUM(wtd.amount) as total_transaction_amount\nFROM consumer_div.wallet_transactions_daily wtd\nJOIN consumer_div.merchants m ON m.mid = wtd.receiver_id\nWHERE wtd.receiver_type = 1\nAND wtd.created_at >= NOW() - INTERVAL '150 days'\nGROUP BY m.name\nORDER BY total_transaction_amount DESC\nLIMIT 2"},
{"question":"Return the customer ID and name of customers who have not made any transactions.","answer":"SELECT c.sbCustId, c.sbCustName FROM sbCustomer c LEFT JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxCustId IS NULL","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_left_join","generation":"SELECT sbCustId, sbCustName\nFROM sbCustomer\nWHERE sbCustId NOT IN (\n    SELECT sbTxCustId\n    FROM sbTransaction\n)"},
{"question":"What are the top 3 most common transaction statuses and their respective counts?","answer":"SELECT status, COUNT(*) AS COUNT FROM consumer_div.wallet_transactions_daily GROUP BY status ORDER BY COUNT DESC LIMIT 3","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_group_order_limit","generation":"SELECT status, COUNT(*) AS count\nFROM consumer_div.wallet_transactions_daily\nGROUP BY status\nORDER BY count DESC\nLIMIT 3"},
{"question":"What is the total number of reviews posted in the year 2021 for businesses in the category \"Cafe\"?","answer":"SELECT COUNT(review.rid) AS total_reviews FROM review JOIN category ON review.business_id = category.business_id WHERE review.year = 2021 AND category.category_name ILIKE '%Cafe%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT COUNT(r.rid) AS total_reviews\nFROM public.review r\nINNER JOIN public.business b ON r.business_id = b.business_id\nINNER JOIN public.category c ON b.business_id = c.business_id\nWHERE c.category_name = 'Cafe'\nAND r.year = 2021"},
{"question":"How many distinct active users sent money per month in 2023? Return the number of active users per month (as a date), starting from the earliest date. Do not include merchants in the query. Only include successful transactions.","answer":"SELECT DATE_TRUNC('month', t.created_at) AS MONTH, COUNT(DISTINCT t.sender_id) AS active_users FROM consumer_div.wallet_transactions_daily t JOIN consumer_div.users u ON t.sender_id = u.uid WHERE t.sender_type = 0 AND t.status = 'success' AND u.status = 'active' AND t.created_at >= '2023-01-01' AND t.created_at < '2024-01-01' GROUP BY MONTH ORDER BY MONTH","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_date_group_order_limit","generation":"SELECT \n    EXTRACT(MONTH FROM tx.created_at) AS month,\n    COUNT(DISTINCT tx.sender_id) AS active_users\nFROM \n    consumer_div.wallet_transactions_daily tx\nWHERE \n    tx.status = 'SUCCESS'\n    AND tx.type = 'TRANSFER'\n    AND tx.created_at >= '2023-01-01'\nGROUP BY \n    month\nORDER BY \n    month"},
{"question":"What is the average GPA of students in the program mathematics?","answer":"SELECT AVG(student.total_gpa) FROM student JOIN program ON student.program_id = program.program_id WHERE LOWER(program.name) = 'mathematics';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT AVG(student.total_gpa)\nFROM student\nJOIN program_course ON student.program_id = program_course.program_id\nJOIN course ON program_course.course_id = course.course_id\nWHERE course.department = 'mathematics'"},
{"question":"How many authors wrote papers that were published in the journal \"Science\" in the year 2020?","answer":"SELECT COUNT(DISTINCT writes.authorid) AS number_of_authors FROM writes JOIN paper ON writes.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%Science%' AND paper.year = 2020;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT COUNT(DISTINCT(writes.authorid))\nFROM writes\nINNER JOIN paper ON writes.paperid = paper.paperid\nINNER JOIN journal ON paper.journalid = journal.journalid\nWHERE journal.journalname = 'Science'\nAND paper.year = 2020"},
{"question":"How does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?","answer":"SELECT {category.category_name, category.id}, CAST(COUNT(CASE WHEN review.rating > 3 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 END), 0) AS ratio FROM review JOIN category ON review.business_id = category.business_id GROUP BY {} ORDER BY ratio DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT c.category_name, COUNT(r.rating) AS positive_reviews, COUNT(r.rating) AS negative_reviews, COUNT(r.rating) \/ COUNT(r.rating) AS ratio\nFROM public.business b\nJOIN public.category c ON b.business_id = c.business_id\nJOIN public.review r ON b.business_id = r.business_id\nWHERE r.rating > 3\nGROUP BY c.category_name\nORDER BY ratio DESC"},
{"question":"Which flights serve meals in first class? Give me the flight id and meal description.","answer":"SELECT flight.flight_id, food_service.meal_description FROM flight JOIN food_service ON flight.meal_code = food_service.meal_code WHERE LOWER(food_service.compartment) LIKE '%first class%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT flight.flight_id, food_service.meal_description\nFROM flight\nINNER JOIN flight_fare ON flight.flight_id = flight_fare.flight_id\nINNER JOIN fare ON flight_fare.fare_id = fare.fare_id\nINNER JOIN food_service ON fare.fare_basis_code = food_service.meal_code\nWHERE booking_class = 'F'\nAND fare.fare_basis_code = food_service.meal_code\n[\/SQL]\n\n### Explanation\nThe query joins the following tables:\n- flight: flight_fare, fare, food_service\n- flight_fare: fare\n- fare: food_service\n\nThe query filters the results to only include flights that have a booking class of 'F' (first class) and a meal code that matches the meal code in the food_service table.\n\nThe query returns the flight id and meal description for each flight that serves meals in first class."},
{"question":"How many flights require a round-trip to purchase the fare?","answer":"SELECT COUNT(DISTINCT flight_fare.flight_id) FROM flight_fare JOIN fare ON flight_fare.fare_id = fare.fare_id WHERE fare.round_trip_required = 'Yes';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT COUNT(*)\nFROM flight\nWHERE round_trip_required = 'Y'"},
{"question":"What are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?","answer":"SELECT publication.title FROM publication ORDER BY publication.reference_num DESC LIMIT 3;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT title, citation_num\nFROM publication\nWHERE citation_num > 0\nORDER BY citation_num DESC\nLIMIT 3"},
{"question":"Return the patient IDs, first names and last names of patients who have not received any treatments.","answer":"SELECT p.patient_id, p.first_name, p.last_name FROM patients p LEFT JOIN treatments t ON p.patient_id = t.patient_id WHERE t.patient_id IS NULL","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_left_join","generation":"SELECT patients.patient_id, patients.first_name, patients.last_name\nFROM patients\nWHERE patients.patient_id NOT IN (\n    SELECT DISTINCT treatment.patient_id\n    FROM treatments AS treatment\n)"},
{"question":"What is the ratio of check-ins on weekends to check-ins on weekdays for the business named \"Mark's Bistro\"?","answer":"SELECT CAST(SUM(CASE WHEN checkin.day IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN checkin.day NOT IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark''s Bistro%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT\n  (\n    SELECT\n      COUNT(*)\n    FROM\n      checkin\n    WHERE\n      day = 'Saturday'\n      AND business_id = 'Mark''s Bistro'\n  ) \/ (\n    SELECT\n      COUNT(*)\n    FROM\n      checkin\n    WHERE\n      day = 'Friday'\n      AND business_id = 'Mark''s Bistro'\n  ) AS ratio"},
{"question":"How many mountains are there in each country?","answer":"SELECT mountain.country_name, COUNT(mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT country_name, COUNT(mountain_name) AS num_mountains\nFROM mountain\nGROUP BY country_name\nORDER BY num_mountains DESC"},
{"question":"What are the top 3 insurance types by average patient height in cm? Return the insurance type, average height and average weight.","answer":"SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight FROM patients GROUP BY ins_type ORDER BY avg_height DESC LIMIT 3","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_group_order_limit","generation":"SELECT ins_type, AVG(height_cm) AS avg_height, AVG(weight_kg) AS avg_weight\nFROM patients\nGROUP BY ins_type\nORDER BY avg_height DESC\nLIMIT 3"},
{"question":"What is the total number of check-ins on the 2 days before Saturday?","answer":"SELECT sum(COUNT) AS total_checkins FROM checkin WHERE DAY IN ('Thursday', 'Friday') ;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT SUM(count)\nFROM public.checkin\nWHERE day = 'Friday' OR day = 'Thursday'"},
{"question":"Which papers are associated with the keyphrase \"Machine Learning\"?","answer":"SELECT {paper.title,paper.paperid} FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT paper.title\nFROM paper\nJOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid\nJOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid\nWHERE keyphrase.keyphrasename = 'Machine Learning'"},
{"question":"What are the names of the authors who have written publications in the domain \"Computer Science\"?","answer":"SELECT DISTINCT author.name FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_publication ON publication.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name ilike '%computer%science%';","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT name\nFROM public.author\nWHERE aid IN (\n    SELECT aid\n    FROM public.domain_author\n    WHERE did = (\n        SELECT did\n        FROM public.domain\n        WHERE name = 'Computer Science'\n    )\n)"},
{"question":"What is the average rating of restaurants that serve Mexican food in each city?","answer":"SELECT location.city_name, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE LOWER(restaurant.food_type) LIKE '%mexican%' GROUP BY location.city_name;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT city_name, AVG(rating) AS average_rating\nFROM restaurant\nJOIN location ON restaurant.city_name = location.city_name\nJOIN geographic ON location.city_name = geographic.city_name\nWHERE food_type = 'Mexican'\nGROUP BY city_name\nORDER BY average_rating DESC"},
{"question":"Which state code is Orlando International Airport in?","answer":"SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT state_code\nFROM public.airport\nWHERE airport_code = 'MCO'"},
{"question":"What is the total number of unique keyphrases associated with papers published in the journal with \"IEEE Transactions\" in its name?","answer":"SELECT COUNT(DISTINCT paperkeyphrase.keyphraseid) AS total_keyphrases FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid WHERE journal.journalname ILIKE '%IEEE Transactions%';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT COUNT(DISTINCT keyphraseid)\nFROM paperkeyphrase\nJOIN paper ON paperkeyphrase.paperid = paper.paperid\nJOIN journal ON paper.journalid = journal.journalid\nWHERE journalname LIKE '%IEEE Transactions%'"},
{"question":"Which states border the state where lake ontario is?","answer":"SELECT border_info.border FROM border_info JOIN lake ON border_info.state_name = lake.state_name WHERE lake.lake_name ilike '%Ontario%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT DISTINCT state_name\nFROM public.border_info\nWHERE border = 'lake ontario'"},
{"question":"Which users have posted reviews for businesses located in the neighbourhood of \"Downtown\" and how many reviews have they posted?","answer":"SELECT {users.name, users.user_id}, COUNT(review.rid) AS review_count FROM review JOIN neighbourhood ON review.business_id = neighbourhood.business_id JOIN users ON review.user_id = users.user_id WHERE neighbourhood.neighbourhood_name ILIKE '%Downtown%' GROUP BY {} ORDER BY review_count DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT u.user_id, count(r.business_id)\nFROM public.users u\nJOIN public.review r ON u.user_id = r.user_id\nJOIN public.neighbourhood n ON r.business_id = n.business_id\nWHERE n.neighbourhood_name = 'Downtown'\nGROUP BY u.user_id\nORDER BY count(r.business_id) DESC"},
{"question":"Which cars were in inventory in the latest snapshot for march 2023? Return the car id, make, model, and year. Cars are considered to be in inventory\" if is_in_inventory is True.\"","answer":"WITH latest_snapshot AS (SELECT MAX(snapshot_date) AS snapshot_date FROM inventory_snapshots WHERE snapshot_date BETWEEN '2023-03-01' AND '2023-03-31' ), latest_snapshot_data AS (SELECT inv.car_id FROM inventory_snapshots inv JOIN latest_snapshot ls ON inv.snapshot_date = ls.snapshot_date WHERE inv.is_in_inventory = TRUE ) SELECT c.id, c.make, c.model, c.year FROM cars c JOIN latest_snapshot_data lsd ON c.id = lsd.car_id;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT cars.id, cars.make, cars.model, cars.year\nFROM cars\nINNER JOIN inventory_snapshots ON cars.id = inventory_snapshots.car_id\nWHERE inventory_snapshots.is_in_inventory = True\nAND inventory_snapshots.snapshot_date = '2023-03-31'"},
{"question":"What is the total number of students enrolled in each course, ordered from highest to lowest?","answer":"SELECT {course.course_id, course.name, course.number}, SUM(course.num_enrolled) AS total_students FROM course GROUP BY {} ORDER BY total_students DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT course_id, COUNT(student_id) AS num_enrolled\nFROM student_record\nGROUP BY course_id\nORDER BY num_enrolled DESC"},
{"question":"Return merchants (merchant ID and name) who have not issued any coupons.","answer":"SELECT m.mid AS merchant_id, m.name AS merchant_name FROM consumer_div.merchants m LEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id WHERE c.cid IS NULL","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_left_join","generation":"SELECT m.mid, m.name\nFROM consumer_div.merchants m\nLEFT JOIN consumer_div.coupons c ON m.mid = c.merchant_id\nWHERE c.merchant_id IS NULL"},
{"question":"What were the total quarterly sales in 2023 grouped by customer's state? Represent each quarter as the first date in the quarter.","answer":"SELECT DATE_TRUNC('QUARTER', s.sale_date) AS QUARTER, c.state, SUM(s.sale_price) AS total_sales FROM sales s JOIN customers c ON s.customer_id = c.id WHERE EXTRACT(YEAR FROM s.sale_date) = 2023 GROUP BY c.state, QUARTER HAVING SUM(s.sale_price) > 0 ORDER BY QUARTER, c.state;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT\n  state,\n  SUM(sale_price) AS total_sales,\n  EXTRACT(YEAR FROM sale_date) AS year,\n  EXTRACT(QUARTER FROM sale_date) AS quarter\nFROM\n  sales\nWHERE\n  EXTRACT(YEAR FROM sale_date) = 2023\nGROUP BY\n  state,\n  year,\n  quarter\nORDER BY\n  state,\n  year,\n  quarter"},
{"question":"What is the total number of papers published in each journal, ordered by the journal name?","answer":"SELECT journal.journalname, COUNT(DISTINCT paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY journal.journalname ORDER BY journal.journalname NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT journal.journalname, COUNT(paper.paperid) AS totalpapers\nFROM paper\nINNER JOIN journal ON paper.journalid = journal.journalid\nGROUP BY journal.journalname\nORDER BY journal.journalname"},
{"question":"Which street has the most number of restaurants?","answer":"SELECT street_name FROM location GROUP BY street_name ORDER BY COUNT(restaurant_id) DESC LIMIT 1;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT street_name, COUNT(restaurant_id) AS num_restaurants\nFROM public.location\nJOIN public.restaurant ON location.restaurant_id = restaurant.id\nJOIN public.geographic ON location.city_name = geographic.city_name\nGROUP BY street_name\nORDER BY num_restaurants DESC\nLIMIT 1"},
{"question":"What's the average predicted time to graduation since admission in no. of days?","answer":"SELECT avg(predicted_graduation_semester - admit_term) AS average_predicted_time_to_graduation FROM student;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT \n\tEXTRACT(DAY FROM (predicted_graduation_semester - entered_as)) AS predicted_time_to_graduation\nFROM \n\tstudent\nWHERE \n\tprogram_id = 1"},
{"question":"Which organizations have authors who have written publications in the domain \"Machine Learning\"?","answer":"SELECT DISTINCT {organization.name, organization.oid} FROM organization JOIN author ON organization.oid = author.oid JOIN writes ON author.aid = writes.aid JOIN domain_publication ON writes.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name = 'Machine Learning';","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT organization.name\nFROM organization\nJOIN writes ON writes.aid = organization.oid\nJOIN writes_publication ON writes_publication.aid = writes.aid\nJOIN publication ON publication.pid = writes_publication.pid\nJOIN publication_domain ON publication_domain.pid = publication.pid\nJOIN domain ON domain.did = publication_domain.did\nWHERE domain.name = 'Machine Learning'"},
{"question":"How many reviews were posted by users with the name \"Sarah Williams\" in the month of April 2021?","answer":"SELECT COUNT(*) FROM review JOIN users ON review.user_id = users.user_id WHERE users.name ILIKE '%Sarah Williams%' AND review.month = 'April' AND review.year = 2021;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT COUNT(*)\nFROM review\nWHERE user_id IN (SELECT user_id\n                  FROM users\n                  WHERE name = 'Sarah Williams')\nAND month = 'April'\nAND year = 2021"},
{"question":"Return the top 5 states by total revenue, showing the number of unique customers and total revenue (based on sale price) for each state.","answer":"SELECT c.state, COUNT(DISTINCT s.customer_id) AS unique_customers, SUM(s.sale_price) AS total_revenue FROM sales s JOIN customers c ON s.customer_id = c.id GROUP BY c.state ORDER BY total_revenue DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_group_order_limit","generation":"SELECT state, COUNT(DISTINCT customer_id) AS unique_customers, SUM(sale_price) AS total_revenue\nFROM sales\nJOIN customers ON sales.customer_id = customers.id\nGROUP BY state\nORDER BY total_revenue DESC\nLIMIT 5"},
{"question":"How many courses does each department offer?","answer":"SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT department, COUNT(course_id) AS num_courses\nFROM course\nGROUP BY department\nORDER BY department"},
{"question":"What are the top 3 publications with the highest number of citations?","answer":"SELECT {publication.title, publication.pid}, publication.citation_num FROM publication ORDER BY publication.citation_num DESC LIMIT 3;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT publication.title, publication.citation_num\nFROM publication\nORDER BY publication.citation_num DESC\nLIMIT 3"},
{"question":"What is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?","answer":"SELECT CAST(COUNT(CASE WHEN paper.numcitedby > 1 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN paper.numcitedby < 2 THEN 1 END), 0) AS ratio FROM paper;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            paper\n        WHERE\n            numcitedby >= 2\n    ) \/ (\n        SELECT\n            COUNT(*)\n        FROM\n            paper\n        WHERE\n            numcitedby < 2\n    )"},
{"question":"What is the proportion of papers that belong to more than 1 dataset to papers that belong to 1 dataset?","answer":"SELECT CAST(COUNT(CASE WHEN dataset_count > 1 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN dataset_count = 1 THEN 1 END), 0) AS ratio FROM (SELECT paperdataset.paperid, COUNT(paperdataset.datasetid) AS dataset_count FROM paperdataset GROUP BY paperdataset.paperid) AS subquery;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT\n    (SELECT COUNT(*) FROM paperdataset WHERE datasetid IN (SELECT datasetid FROM paperdataset GROUP BY datasetid HAVING COUNT(*) > 1)) \/\n    (SELECT COUNT(*) FROM paperdataset WHERE datasetid IN (SELECT datasetid FROM paperdataset GROUP BY datasetid HAVING COUNT(*) = 1))"},
{"question":"What month were most students admitted? Return the no. of students and the month as a date","answer":"SELECT date_trunc('month', s.admit_term) AS month, COUNT(*) AS total_students FROM student s GROUP BY MONTH ORDER BY total_students DESC LIMIT 1;SELECT TO_CHAR(DATE_TRUNC('month', s.admit_term), 'YYYY-MM') AS month, COUNT(*) AS total_students FROM student s GROUP BY month ORDER BY total_students DESC LIMIT 1;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT\n    EXTRACT(MONTH FROM admit_term) AS month,\n    COUNT(*) AS num_students\nFROM\n    student\nGROUP BY\n    month\nORDER BY\n    num_students DESC"},
{"question":"What are the names and areas of the lakes in Michigan?","answer":"SELECT lake_name, area FROM lake WHERE state_name ILIKE '%Michigan%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT lake_name, area\nFROM lake\nWHERE state_name = 'Michigan'"},
{"question":"Return the course id's that are offered in either semesters 1 or 2 and ends before 1pm and had an instructor on thursday.","answer":"SELECT DISTINCT co.course_id FROM course_offering co JOIN offering_instructor oi ON co.offering_id = oi.offering_id WHERE (co.semester = 1 OR co.semester = 2) AND co.end_time < '13:00:00' AND co.thursday IS NOT NULL;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT course_id\nFROM course_offering\nWHERE semester IN (1, 2)\nAND end_time < '13:00:00'\nAND thursday = 'y'"},
{"question":"What are the top 3 payment methods by total payment amount received? Return the payment method, total number of payments and total amount.","answer":"SELECT payment_method, COUNT(*) AS total_payments, SUM(payment_amount) AS total_amount FROM payments_received GROUP BY payment_method ORDER BY total_amount DESC LIMIT 3","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_group_order_limit","generation":"SELECT payment_method, COUNT(payment_method) AS total_payments, SUM(payment_amount) AS total_amount\nFROM payments_received\nGROUP BY payment_method\nORDER BY total_amount DESC\nLIMIT 3"},
{"question":"What are the titles of all publications ordered alphabetically?","answer":"SELECT DISTINCT publication.title FROM publication ORDER BY publication.title ASC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT title\nFROM publication\nORDER BY title"},
{"question":"What is the average rating of restaurants serving each type of food?","answer":"SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type ORDER BY average_rating DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT food_type, AVG(rating)\nFROM restaurant\nJOIN location ON restaurant.id = location.restaurant_id\nJOIN geographic ON location.city_name = geographic.city_name\nGROUP BY food_type\n[\/SQL]\n\n### Explanation\nThe query joins the restaurant, location, and geographic tables on the restaurant_id, city_name, and city_name columns, respectively. It then groups the results by food_type and calculates the average rating for each food type."},
{"question":"What's the absolute difference in time in days between today and the earliest flight departure? Give the answer as an integer.","answer":"SELECT date_part('day', CURRENT_DATE - to_timestamp(departure_time)) AS difference_in_days FROM flight ORDER BY departure_time LIMIT 1;SELECT (CURRENT_DATE - TO_TIMESTAMP(MIN(f.departure_time))) AS days_difference FROM flight f;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT\n    (EXTRACT(DAY FROM (MIN(departure_time) - CURRENT_DATE))::INTEGER) AS \"Absolute Difference in Days\"\nFROM\n    flight"},
{"question":"What is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?","answer":"SELECT venue.venuename, COUNT(DISTINCT paper.paperid) FROM paper JOIN venue ON paper.venueid = venue.venueid WHERE paper.venueid = (SELECT venueid FROM paper WHERE paperid = 2 ) GROUP BY venue.venuename;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT venue.venuename, COUNT(paper.paperid)\nFROM paper\nJOIN venue ON paper.venueid = venue.venueid\nWHERE paper.paperid = 2\nGROUP BY venue.venuename\n[\/SQL]\n\n### Explanation\nThe query joins the paper table with the venue table on the venueid column. It then filters the results to only include the paper with paperid = 2. Finally, it groups the results by the venuename column and counts the number of papers published in each venue."},
{"question":"What are the top 5 best selling car models by total revenue? Return the make, model, total number of sales and total revenue.","answer":"SELECT c.make, c.model, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN cars c ON s.car_id = c.id GROUP BY c.make, c.model ORDER BY total_revenue DESC LIMIT 5","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_group_order_limit","generation":"SELECT make, model, SUM(sale_price) AS total_sales, COUNT(sale_price) AS total_revenue\nFROM sales\nJOIN cars ON sales.car_id = cars.id\nGROUP BY make, model\nORDER BY total_revenue DESC\nLIMIT 5"},
{"question":"What is the average number of citations received by publications in each year?","answer":"SELECT publication.year, AVG(publication.citation_num) AS average_citations FROM publication GROUP BY publication.year ORDER BY publication.year NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT\n  year,\n  AVG(citation_num) AS avg_citation_num\nFROM\n  publication\nGROUP BY\n  year\nORDER BY\n  year"},
{"question":"How does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.","answer":"SELECT city.city_name, CAST(city.population AS float) \/ NULLIF(state.population, 0) AS population_ratio FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_ratio DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT city.city_name,\n       (city.population \/ state.population) AS proportion\nFROM city\nJOIN state ON city.state_name = state.state_name\nORDER BY proportion DESC"},
{"question":"Which aircraft code can carry the highest weight of cargo that any aircraft can carry?","answer":"SELECT aircraft.aircraft_code FROM aircraft ORDER BY pay_load DESC NULLS LAST LIMIT 1;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT aircraft_code\nFROM public.aircraft\nWHERE weight = (SELECT MAX(weight)\n                 FROM public.aircraft)"},
{"question":"What are the names of the restaurants in Los Angeles that have a rating higher than 4?","answer":"SELECT DISTINCT restaurant.name FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%' AND restaurant.rating > 4 ORDER BY restaurant.name NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name\nFROM restaurant\nWHERE rating > 4\nAND city_name = 'Los Angeles'"},
{"question":"What is the ratio of Italian restaurants out of all restaurants in Los Angeles?","answer":"SELECT CAST(COUNT(CASE WHEN food_type ILIKE '%Italian%' THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(food_type), 0) AS ratio FROM restaurant WHERE city_name ILIKE '%Los Angeles%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT \n    (SELECT COUNT(*) FROM restaurant WHERE city_name = 'Los Angeles') AS total_restaurants,\n    (SELECT COUNT(*) FROM restaurant WHERE city_name = 'Los Angeles' AND food_type = 'Italian') AS italian_restaurants,\n    (italian_restaurants \/ total_restaurants) AS ratio\nFROM restaurant\nWHERE city_name = 'Los Angeles'"},
{"question":"What is the ratio of aircraft capacity to its range in miles for each aircraft code?","answer":"SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) \/ NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio FROM aircraft;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT aircraft_code, capacity, range_miles, capacity \/ range_miles AS ratio\nFROM public.aircraft"},
{"question":"What's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?","answer":"SELECT restaurant.name, restaurant.rating FROM restaurant WHERE restaurant.rating > 4 AND restaurant.city_name ILIKE '%New York%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"instruct","generation":"SELECT name, rating\nFROM restaurant\nWHERE rating > 4\nAND city_name = 'New York'"},
{"question":"How many restaurants serve Italian food in each region?","answer":"SELECT geographic.region, COUNT(restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT region, COUNT(restaurant_id) AS num_restaurants\nFROM public.restaurant\nJOIN public.location ON public.restaurant.city_name = public.location.city_name\nJOIN public.geographic ON public.location.city_name = public.geographic.city_name\nWHERE food_type = 'Italian'\nGROUP BY region\nORDER BY num_restaurants DESC"},
{"question":"How many reviews were there 2 months before the review with id 3?","answer":"SELECT COUNT(*) AS review_count FROM review WHERE TO_DATE(CAST(review.year AS TEXT) || '-' || CASE review.month WHEN 'January' THEN '01' WHEN 'February' THEN '02' WHEN 'March' THEN '03' WHEN 'April' THEN '04' WHEN 'May' THEN '05' WHEN 'June' THEN '06' WHEN 'July' THEN '07' WHEN 'August' THEN '08' WHEN 'September' THEN '09' WHEN 'October' THEN '10' WHEN 'November' THEN '11' WHEN 'December' THEN '12' END || '-01', 'YYYY-MM-DD') = (SELECT TO_DATE(CAST(r.year AS TEXT) || '-' || CASE r.month WHEN 'January' THEN '01' WHEN 'February' THEN '02' WHEN 'March' THEN '03' WHEN 'April' THEN '04' WHEN 'May' THEN '05' WHEN 'June' THEN '06' WHEN 'July' THEN '07' WHEN 'August' THEN '08' WHEN 'September' THEN '09' WHEN 'October' THEN '10' WHEN 'November' THEN '11' WHEN 'December' THEN '12' END || '-01', 'YYYY-MM-DD') - INTERVAL '2 months' FROM review r WHERE r.rid = 3);","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT COUNT(*)\nFROM review\nWHERE month = '2018-01'\nAND year = 2018\nAND rid < 3"},
{"question":"What is the ratio of the population of the United States to the population of California?","answer":"SELECT CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.country_name) LIKE '%united states%') AS FLOAT) \/ CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.state_name) LIKE '%california%') AS FLOAT) AS population_ratio FROM state;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT (\n    (\n        SELECT population\n        FROM state\n        WHERE state_name = 'United States'\n    ) \/ (\n        SELECT population\n        FROM state\n        WHERE state_name = 'California'\n    )\n) AS ratio"},
{"question":"What are the highest mountains in meters, ordered from highest to lowest altitude?","answer":"SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT mountain_name, mountain_altitude\nFROM mountain\nORDER BY mountain_altitude DESC"},
{"question":"How many students were predicted to graduate in the last 10 years?","answer":"SELECT count(*) AS num_students_graduated FROM student WHERE predicted_graduation_semester >= DATE_TRUNC('year', CURRENT_DATE) - interval '10 year';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT COUNT(DISTINCT student.student_id)\nFROM student\nWHERE student.predicted_graduation_semester >= (SELECT semester.semester\n                                                  FROM semester\n                                                  WHERE semester.semester = '2019-2020-spring')"},
{"question":"Which neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?","answer":"SELECT {neighbourhood.neighbourhood_name, neighbourhood.id}, COUNT(DISTINCT neighbourhood.business_id) AS business_count FROM neighbourhood GROUP BY {} ORDER BY business_count DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT neighbourhood_name, COUNT(business_id) AS business_count\nFROM public.neighbourhood\nJOIN public.business ON public.neighbourhood.business_id = public.business.business_id\nGROUP BY neighbourhood_name\nORDER BY business_count DESC"},
{"question":"What's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes","answer":"SELECT avg(to_timestamp(arrival_time) - to_timestamp(departure_time) - interval '34 minutes') AS average_duration FROM flight;SELECT AVG(arrival_time - departure_time)\/60 - 34 AS average_duration FROM flight;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT\n\tEXTRACT(EPOCH FROM (arrival_time - departure_time)) \/ 60 - 34 AS duration\nFROM\n\tflight"},
{"question":"What are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?","answer":"SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT journalname\nFROM journal\nORDER BY length(journalname)"},
{"question":"What is the total number of publications published in each year?","answer":"SELECT publication.year, COUNT(DISTINCT publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT\n  year,\n  COUNT(*) AS total_publications\nFROM\n  publication\nGROUP BY\n  year\nORDER BY\n  year"},
{"question":"How many course offerings have a final exam and how many do not?","answer":"SELECT course_offering.has_final_exam, COUNT(offering_id) AS num_courses FROM course_offering GROUP BY course_offering.has_final_exam;SELECT COUNT(CASE WHEN co.has_final_exam THEN 1 END) AS num_with_final_exam, COUNT(CASE WHEN NOT co.has_final_exam THEN 1 END) AS num_without_final_exam FROM course_offering co;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT\n  COUNT(DISTINCT offering_id) AS num_offerings_with_final_exam,\n  COUNT(DISTINCT offering_id) AS num_offerings_without_final_exam\nFROM\n  course_offering\nWHERE\n  has_final_exam = true"},
{"question":"What are the top 2 airlines with the most flights?","answer":"SELECT {airline.airline_name, airline.airline_code}, COUNT(flight.flight_id) AS number_of_flights FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY {} ORDER BY number_of_flights DESC NULLS LAST LIMIT 2;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT airline_name, COUNT(flight_id) AS flight_count\nFROM flight\nJOIN airline ON flight.airline_code = airline.airline_code\nGROUP BY airline_name\nORDER BY flight_count DESC\nLIMIT 2"},
{"question":"What are the names and altitudes of the mountains in Nepal?","answer":"SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name ILIKE '%Nepal%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT mountain_name, mountain_altitude\nFROM mountain\nWHERE country_name = 'Nepal'"},
{"question":"Which countries have both lakes and rivers?","answer":"SELECT DISTINCT lake.country_name FROM lake JOIN river ON lake.country_name = river.country_name;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT DISTINCT country_name\nFROM lake\nINNER JOIN river\nON lake.country_name = river.country_name\nWHERE lake.country_name = river.country_name"},
{"question":"How many keyphrases are associated with each paper?","answer":"SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY keyphrase_count DESC NULLS LAST;SELECT p.title, COUNT(pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid GROUP BY p.title ORDER BY num_keyphrases DESC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT paperid, COUNT(keyphraseid) AS numkeyphrases\nFROM paperkeyphrase\nGROUP BY paperid\nORDER BY numkeyphrases DESC"}
]