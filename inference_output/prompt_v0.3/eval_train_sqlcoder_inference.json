{"question":"What is the total number of credits earned by students in each program?","answer":"SELECT {program.name, program.program_id}, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY {};","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT p.name, SUM(s.total_credit) AS total_credits FROM public.program p JOIN public.student s ON p.program_id = s.program_id GROUP BY p.name ORDER BY total_credits DESC NULLS LAST"}
{"question":"Which flight has the shortest duration between departure and arrival times? Convert to integer minutes.","answer":"SELECT {flight.flight_number, flight.flight_id}, (arrival_time - departure_time) \/ 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT f.flight_id, (f.arrival_time - f.departure_time)\/60 AS duration_in_minutes FROM flight f ORDER BY duration_in_minutes ASC NULLS LAST LIMIT 1"}
{"question":"Which airports have the shortest minimum connect time, sorted in ascending order? Show the minimum connect time.","answer":"SELECT {airport.airport_name, airport.airport_code}, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT a.airport_code, a.minimum_connect_time FROM public.airport a ORDER BY a.minimum_connect_time ASC NULLS LAST"}
{"question":"What are the names of all the courses offered by the department of Computer Science?","answer":"SELECT course.name FROM course WHERE course.department ILIKE '%Computer Science%' ORDER BY course.name ASC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT c.name FROM public.course c WHERE c.department ILIKE '%Computer%Science%' ORDER BY c.name NULLS LAST"}
{"question":"Please provide a list of business names in New York and their average ratings ordered by the highest average rating first.","answer":"SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%New York%' GROUP BY business.name, business.business_id ORDER BY average_rating DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT b.name, AVG(r.rating) AS average_rating FROM public.business b JOIN public.review r ON b.business_id = r.business_id WHERE b.state = 'NY' GROUP BY b.name ORDER BY average_rating DESC NULLS LAST"}
{"question":"What is the average length of rivers in each country?","answer":"SELECT river.country_name, AVG(river.length) AS average_length FROM river GROUP BY river.country_name ORDER BY average_length DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT r.country_name, AVG(r.length) AS average_length FROM public.river r GROUP BY r.country_name ORDER BY average_length DESC NULLS LAST"}
{"question":"How long has it been in days since the last admitted student? Give the answer as an integer.","answer":"SELECT CURRENT_DATE - max(admit_term) AS duration_since_last_admitted_student FROM student;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"date_functions","generation":"SELECT EXTRACT(DAY FROM CURRENT_DATE - MAX(s.admit_term)) AS days_since_last_admission FROM public.student s"}
{"question":"What are the top 2 most frequently used device types for user sessions and their respective counts?","answer":"SELECT device_type, COUNT(*) AS COUNT FROM consumer_div.user_sessions GROUP BY device_type ORDER BY COUNT DESC LIMIT 2","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_group_order_limit","generation":"SELECT u.device_type, COUNT(u.device_type) AS COUNT FROM consumer_div.user_sessions u GROUP BY u.device_type ORDER BY COUNT DESC NULLS LAST LIMIT 2"}
{"question":"Which flights operate on Mondays and Wednesdays? Give me the relevant flight numbers","answer":"SELECT {flight.flight_number, flight.flight_id} FROM flight WHERE LOWER(flight.flight_days) LIKE '%mon%' AND LOWER(flight.flight_days) LIKE '%wed%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT f.flight_number FROM public.flight f WHERE f.flight_days ilike '%Monday%' OR f.flight_days ilike '%Wednesday%'"}
{"question":"Which rivers traverse at least 3 cities\/landmarks?","answer":"SELECT river_name FROM river WHERE traverse LIKE '%,%,%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT r.river_name FROM public.river r JOIN (SELECT t.traverse FROM public.river r JOIN (SELECT traverse FROM public.river GROUP BY traverse HAVING COUNT(traverse) >= 3) AS t ON r.traverse = t.traverse) AS subquery ON TRUE"}
{"question":"What is the ratio of the total number of publications to the total number of keywords within each domain ID? Show all domain IDs.","answer":"SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_publication LEFT JOIN domain_keyword ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_keyword LEFT JOIN domain_publication ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT d.did, COALESCE(CAST(COUNT(DISTINCT dp.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT dk.kid), 0), 0) AS publication_to_keyword_ratio FROM domain d LEFT JOIN domain_publication dp ON d.did = dp.did LEFT JOIN domain_keyword dk ON d.did = dk.did GROUP BY d.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"ratio","generation":"SELECT d.did, COUNT(DISTINCT p.pid)::FLOAT \/ NULLIF(COUNT(DISTINCT k.kid), 0) AS ratio FROM public.domain d LEFT JOIN public.domain_publication p ON d.did = p.did LEFT JOIN public.domain_keyword k ON d.did = k.did GROUP BY d.did ORDER BY ratio NULLS LAST"}
{"question":"What are the top 3 most frequently used coupon codes? Return the coupon code, total number of redemptions, and total amount redeemed.","answer":"SELECT c.code AS coupon_code, COUNT(t.txid) AS redemption_count, SUM(t.amount) AS total_discount FROM consumer_div.coupons c JOIN consumer_div.wallet_transactions_daily t ON c.cid = t.coupon_id GROUP BY c.code ORDER BY redemption_count DESC LIMIT 3","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_group_order_limit","generation":"SELECT c.code, COUNT(w.txid) AS total_redemptions, SUM(w.amount) AS total_amount_redeemed FROM consumer_div.coupons c JOIN consumer_div.wallet_transactions_daily w ON c.cid = w.coupon_id GROUP BY c.code ORDER BY total_redemptions DESC, total_amount_redeemed DESC LIMIT 3"}
{"question":"What are the names of the authors who wrote the paper with the title \"The Effects of Climate Change on Agriculture\"?","answer":"SELECT author.authorname FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title = 'The Effects of Climate Change on Agriculture';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT a.authorname FROM public.author a JOIN public.writes w ON a.authorid = w.authorid JOIN public.paper p ON w.paperid = p.paperid WHERE p.title ilike '%The%Effects%of%Climate%Change%on%Agriculture%'"}
{"question":"What is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers?","answer":"SELECT CAST(COUNT(DISTINCT CASE WHEN paper_count >= 3 THEN subquery.authorid END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN paper_count < 3 THEN subquery.authorid END), 0) AS ratio FROM (SELECT writes.authorid, COUNT(writes.paperid) AS paper_count FROM writes GROUP BY writes.authorid) AS subquery;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT CASE WHEN w.papercount >= 3 THEN w.authorid END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN w.papercount < 3 THEN w.authorid END), 0) AS ratio FROM (SELECT w.authorid, COUNT(w.paperid) AS papercount FROM writes w GROUP BY w.authorid) AS w"}
{"question":"Which authors have written publications in both the domain \"Machine Learning\" and the domain \"Data Science\"?","answer":"SELECT {author.name,author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM DOMAIN WHERE domain.name IN ('Machine Learning', 'Data Science') ) GROUP BY 1 HAVING COUNT(DISTINCT domain_author.did) = 2);","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT DISTINCT a.name FROM public.author a JOIN public.domain_author da1 ON a.aid = da1.aid JOIN public.domain_author da2 ON a.aid = da2.aid WHERE da1.did = (SELECT did FROM public.domain WHERE name = 'Machine Learning') AND da2.did = (SELECT did FROM public.domain WHERE name = 'Data Science')"}
{"question":"What is the monthly average transaction price for successful transactions in the 1st quarter of 2023?","answer":"SELECT DATE_TRUNC('month', sbTxDateTime) AS MONTH, AVG(sbTxPrice) AS avg_price FROM sbTransaction WHERE sbTxStatus = 'success' AND sbTxDateTime BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY MONTH ORDER BY MONTH;","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"date_functions","generation":"SELECT EXTRACT(MONTH FROM sbTxDateTime) AS MONTH, AVG(sbTxPrice) AS average_price FROM sbTransaction WHERE EXTRACT(QUARTER FROM sbTxDateTime) = 1 AND EXTRACT(YEAR FROM sbTxDateTime) = 2023 AND sbTxStatus = 'successful' GROUP BY MONTH ORDER BY MONTH NULLS LAST"}
{"question":"What are the top 3 businesses in terms of review count?","answer":"SELECT {business.name, business.business_id, business.bid}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT b.name, b.review_count FROM public.business b ORDER BY b.review_count DESC NULLS LAST LIMIT 3"}
{"question":"Which lakes have the largest areas in square kilometers, ordered from largest to smallest?","answer":"SELECT lake.lake_name, lake.area FROM lake ORDER BY lake.area DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT l.lake_name, l.area FROM public.lake l ORDER BY l.area DESC NULLS LAST"}
{"question":"show all placebo treatment id, start and end date, where there concomitant_meds were started within 2 weeks of starting the treatment. also return the start and end dates of all concomitant drug usage.","answer":"SELECT t.treatment_id, t.start_dt AS treatment_start_date, t.end_dt AS treatment_end_date, cm.start_dt AS concomitant_med_start_date, cm.end_dt AS concomitant_med_end_date FROM treatments t JOIN concomitant_meds cm ON t.treatment_id = cm.treatment_id WHERE t.is_placebo = TRUE AND TO_DATE(cm.start_dt, 'YYYY-MM-DD') BETWEEN t.start_dt AND t.start_dt + INTERVAL '2 WEEK' ORDER BY t.treatment_id;","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"date_functions","generation":"SELECT t.treatment_id, t.start_dt, t.end_dt, c.start_dt, c.end_dt FROM treatments t JOIN concomitant_meds c ON t.treatment_id = c.treatment_id WHERE t.is_placebo = TRUE AND (c.start_dt::DATE - t.start_dt::DATE) <= 14"}
{"question":"What is the average cost of a one-way trip for each airport pair in the fare table?","answer":"SELECT f.from_airport, f.to_airport, AVG(f.one_direction_cost) AS average_cost FROM fare f GROUP BY f.from_airport, f.to_airport ORDER BY f.from_airport, f.to_airport NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"group_by","generation":"SELECT f.from_airport, f.to_airport, AVG(f.one_direction_cost) AS average_one_way_cost FROM fare f GROUP BY f.from_airport, f.to_airport ORDER BY average_one_way_cost NULLS LAST"}
{"question":"Return the ticker ID and symbol of tickers that do not have any daily price records.","answer":"SELECT tk.sbTickerId, tk.sbTickerSymbol FROM sbTicker tk LEFT JOIN sbDailyPrice dp ON tk.sbTickerId = dp.sbDpTickerId WHERE dp.sbDpTickerId IS NULL","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_left_join","generation":"SELECT t.sbTickerId, t.sbTickerSymbol FROM sbTicker t LEFT JOIN sbDailyPrice d ON t.sbTickerId = d.sbDpTickerId WHERE d.sbDpTickerId IS NULL"}
{"question":"What is the total cost of all round-trip fares from New York (JFK) to Los Angeles?","answer":"SELECT SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare WHERE fare.from_airport = 'JFK' AND fare.to_airport = 'LAX';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT SUM(f.round_trip_cost) AS total_round_trip_cost FROM public.fare f JOIN public.airport_service a ON f.from_airport = a.airport_code AND f.to_airport = a.airport_code WHERE a.city_code = 'JFK' AND a.city_code = 'LAX'"}
{"question":"What is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase?","answer":"SELECT CAST(COUNT(DISTINCT CASE WHEN keyphrase_count > 1 THEN subquery.paperid END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN keyphrase_count =1 THEN subquery.paperid END), 0) AS ratio FROM (SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid) AS subquery;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT CASE WHEN p.paperid IN (SELECT paperid FROM paperkeyphrase GROUP BY paperid HAVING COUNT(keyphraseid) > 1) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN p.paperid IN (SELECT paperid FROM paperkeyphrase GROUP BY paperid HAVING COUNT(keyphraseid) = 1) AS FLOAT), 0) AS ratio FROM paper p"}
{"question":"What is the name of the instructor who has taught the most courses, and how many courses have they taught?","answer":"SELECT instructor.name, count(offering_instructor.offering_id) AS num_courses FROM offering_instructor JOIN instructor ON offering_instructor.instructor_id = instructor.instructor_id GROUP BY instructor.name ORDER BY num_courses DESC LIMIT 1;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT i.name, COUNT(oi.offering_id) AS num_courses FROM public.instructor i JOIN offering_instructor oi ON i.instructor_id = oi.instructor_id GROUP BY i.name ORDER BY num_courses DESC LIMIT 1"}
{"question":"For each paper that cites other papers, how many other papers does it cite? Sort by the number of papers cited in descending order","answer":"SELECT cite.citingpaperid, COUNT(*) AS citation_count FROM cite GROUP BY cite.citingpaperid ORDER BY citation_count DESC NULLS LAST;SELECT p.paperid, p.numciting FROM paper p WHERE p.numciting > 0 ORDER BY p.numciting DESC;SELECT p.title, COUNT(c.citedpaperid) AS num_cited_papers FROM paper p JOIN cite c ON p.paperid = c.citingpaperid GROUP BY p.title ORDER BY num_cited_papers DESC;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT p.paperid, p.numcitedby FROM public.paper p WHERE p.numcitedby > 0 ORDER BY p.numcitedby DESC"}
{"question":"what is average age of all registered male patients with private insurance currently?","answer":"SELECT AVG(EXTRACT(YEAR FROM AGE(CURRENT_DATE, date_of_birth))) AS avg_age FROM patients WHERE gender = 'Male' AND ins_type = 'private';","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"date_functions","generation":"SELECT AVG(EXTRACT(YEAR FROM AGE(CURRENT_DATE, p.date_of_birth))) AS average_age FROM patients p WHERE p.gender = 'M' AND p.ins_type = 'private'"}
{"question":"Return the number of payments made on weekends to the vendor named 'Utility Company'","answer":"SELECT COUNT(*) AS weekend_payments FROM payments_made WHERE vendor_name = 'Utility Company' AND EXTRACT(DOW FROM payment_date) IN (0, 6);","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT COUNT(*) FROM payments_made p WHERE p.vendor_name ilike '%Utility Company%' AND EXTRACT(dow FROM p.payment_date) IN (0, 6)"}
{"question":"What are the top 3 diagnoses by maximum itch VAS score at day 100 and number of distinct patients? Return the diagnosis name, number of patients, and maximum itch score.","answer":"SELECT di.diag_name, COUNT(DISTINCT t.patient_id) AS num_patients, MAX(o.day100_itch_vas) AS max_itch_score FROM treatments t JOIN diagnoses di ON t.diag_id = di.diag_id JOIN outcomes o ON t.treatment_id = o.treatment_id GROUP BY di.diag_name ORDER BY max_itch_score DESC, num_patients DESC LIMIT 3","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_group_order_limit","generation":"SELECT d.diag_name, COUNT(DISTINCT o.patient_id) AS patient_count, MAX(o.day100_itch_vas) AS max_itch_score FROM diagnoses d JOIN treatments t ON d.diag_id = t.diag_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE o.day100_itch_vas IS NOT NULL GROUP BY d.diag_name ORDER BY max_itch_score DESC, patient_count DESC LIMIT 3"}
{"question":"How does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well.","answer":"SELECT publication.year, COUNT(DISTINCT publication.pid) AS num_publications, COUNT(DISTINCT publication.jid) AS num_journals, CAST(COUNT(DISTINCT publication.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio FROM publication GROUP BY publication.year ORDER BY publication.year;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"ratio","generation":"SELECT EXTRACT(YEAR FROM p.publication_date) AS YEAR, COUNT(DISTINCT p.pid) AS num_publications, COUNT(DISTINCT j.jid) AS num_journals, CAST(COUNT(DISTINCT p.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT j.jid), 0) AS ratio FROM publication p JOIN journal j ON p.jid = j.jid GROUP BY YEAR ORDER BY YEAR"}
{"question":"Return the drug IDs and names of drugs that have not been used in any treatments.","answer":"SELECT d.drug_id, d.drug_name FROM drugs d LEFT JOIN treatments t ON d.drug_id = t.drug_id WHERE t.drug_id IS NULL","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_left_join","generation":"SELECT d.drug_id, d.drug_name FROM drugs d WHERE d.drug_id NOT IN (SELECT t.drug_id FROM treatments t)"}
{"question":"Return the distinct list of ticker IDs that have daily price records on or after Apr 1, 2023.","answer":"SELECT DISTINCT tk.sbTickerId FROM sbTicker tk JOIN sbDailyPrice dp ON tk.sbTickerId = dp.sbDpTickerId WHERE dp.sbDpDate >= '2023-04-01'","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_distinct","generation":"SELECT DISTINCT s.sbTickerId FROM sbDailyPrice s WHERE s.sbDpDate >= '2023-04-01'"}
{"question":"What is the title of the publication that has received the highest number of citations?","answer":"SELECT publication.title FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 1;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT p.title FROM public.publication p WHERE p.citation_num = (SELECT MAX(c.citation_num) FROM public.publication c)"}
{"question":"What is the total population in cities by country?","answer":"SELECT city.country_name, SUM(city.population) AS total_population FROM city GROUP BY city.country_name ORDER BY total_population DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT c.country_name, SUM(c.population) AS total_population FROM public.city c GROUP BY c.country_name ORDER BY total_population DESC NULLS LAST"}
{"question":"What is the total number of check-ins for each day of the week for the business with ID \"abc123\"?","answer":"SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.business_id = 'abc123' GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT c.day, SUM(c.count) AS total_checkins FROM public.checkin c WHERE c.business_id = 'abc123' GROUP BY c.day ORDER BY total_checkins DESC NULLS LAST"}
{"question":"How many papers are associated with the keyphrase \"machine learning\" and were published in the journal named \"IEEE Transactions on Pattern Analysis and Machine Intelligence\"?","answer":"SELECT COUNT(DISTINCT paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%machine learning%' AND journal.journalname = 'IEEE Transactions on Pattern Analysis and Machine Intelligence';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT COUNT(DISTINCT p.paperid) AS number_of_papers FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid JOIN keyphrase k ON pk.keyphraseid = k.keyphraseid JOIN journal j ON p.journalid = j.journalid WHERE k.keyphrasename ilike '%machine%learning%' AND j.journalname = 'IEEE Transactions on Pattern Analysis and Machine Intelligence%'"}
{"question":"How many check-ins occurred on Mondays at businesses in the state of California?","answer":"SELECT SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' AND checkin.day ILIKE '%Monday%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT SUM(c.count) AS total_checkins FROM public.checkin c JOIN public.business b ON c.business_id = b.business_id WHERE b.state = 'California' AND c.day = 'Monday'"}
{"question":"What are the top 2 categories of businesses with the highest average rating?","answer":"SELECT {category.category_name, category.id} FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id) AS business_rating JOIN category ON business_rating.business_id = category.business_id GROUP BY {} ORDER BY AVG(business_rating.average_rating) DESC NULLS LAST LIMIT 2;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT c.category_name, AVG(r.rating) AS average_rating FROM public.review r JOIN public.category c ON r.business_id = c.business_id GROUP BY c.category_name ORDER BY average_rating DESC NULLS LAST LIMIT 2"}
{"question":"Return the name and average rating for each business in new york","answer":"SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%NEW YORK%' GROUP BY business.name;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT b.name, AVG(r.rating) AS average_rating FROM public.business b JOIN public.review r ON b.business_id = r.business_id WHERE b.city ilike '%New York%' GROUP BY b.name ORDER BY average_rating DESC NULLS LAST"}
{"question":"What is the ratio of papers published in the year 2020 to the total number of papers in the database?","answer":"SELECT CAST(COUNT(CASE WHEN paper.year = 2020 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(paper.paperid), 0) AS ratio FROM paper;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN p.year = 2020 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(p.paperid), 0) AS ratio FROM public.paper p"}
{"question":"Which airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops in ascending order?","answer":"SELECT {airline.airline_name, airline.airline_code}, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT a.airline_name, COUNT(f.stops) AS stop_count FROM public.airport a JOIN public.airline_service s ON a.airport_code = s.city_code JOIN public.flight f ON s.service_name = f.airline_flight WHERE a.airport_code IN ('ORD', 'JFK') GROUP BY a.airline_name ORDER BY stop_count ASC"}
{"question":"What are the top 5 combinations of customer state and ticker type by number of transactions? Return the customer state, ticker type and number of transactions.","answer":"SELECT c.sbCustState, t.sbTickerType, COUNT(*) AS num_transactions FROM sbTransaction tx JOIN sbCustomer c ON tx.sbTxCustId = c.sbCustId JOIN sbTicker t ON tx.sbTxTickerId = t.sbTickerId GROUP BY c.sbCustState, t.sbTickerType ORDER BY num_transactions DESC LIMIT 5","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_group_order_limit","generation":"SELECT c.sbCustState, t.sbTickerType, COUNT(t.sbTxId) AS transaction_count FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId GROUP BY c.sbCustState, t.sbTickerType ORDER BY transaction_count DESC NULLS LAST LIMIT 5"}
{"question":"List the restaurants starting from the best ratings to the lowest","answer":"SELECT {name, id}, rating FROM restaurant ORDER BY rating DESC;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT r.name, r.rating FROM public.restaurant r ORDER BY r.rating DESC NULLS LAST"}
{"question":"Return the distinct list of customer IDs who have made a 'buy' transaction.","answer":"SELECT DISTINCT c.sbCustId FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxType = 'buy'","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_distinct","generation":"SELECT DISTINCT st.sbTxCustId FROM sbTransaction st WHERE st.sbTxType = 'buy'"}
{"question":"How many restaurants are there in each city? Order the results by the number of restaurants in descending order.","answer":"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM LOCATION GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT l.city_name, COUNT(r.id) AS number_of_restaurants FROM public.restaurant r JOIN public.location l ON r.city_name = l.city_name GROUP BY l.city_name ORDER BY number_of_restaurants DESC"}
{"question":"What is the minimum amount of time required for a connecting flight at JFK Airport?","answer":"SELECT minimum_connect_time FROM airport WHERE airport_code = 'JFK';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"instruct","generation":"SELECT MIN(a.minimum_connect_time) AS min_minimum_connect_time FROM public.airport a WHERE a.airport_code = 'JFK'"}
{"question":"What is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco? Match food_type case insensitively","answer":"SELECT CAST(SUM(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant WHERE LOWER(restaurant.city_name) ILIKE '%san francisco%';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN r.food_type ILIKE '%vegan%' THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN r.food_type NOT ILIKE '%vegan%' THEN 1 END), 0) AS ratio FROM public.restaurant r JOIN public.location l ON r.id = l.restaurant_id WHERE l.city_name = 'San Francisco'"}
{"question":"Which courses have been taken by students in the Computer Science program?","answer":"SELECT DISTINCT {course.name, course.course_id, course.number} AS course_name FROM student JOIN student_record ON student.student_id = student_record.student_id JOIN program ON student.program_id = program.program_id JOIN course ON student_record.course_id = course.course_id WHERE program.name ILIKE '%Computer Science%';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT DISTINCT c.name FROM public.course c JOIN public.program_course pc ON c.course_id = pc.course_id JOIN public.program p ON pc.program_id = p.program_id WHERE p.name = 'Computer Science'"}
{"question":"What is the highest point in each state and what is the population density of that state?","answer":"SELECT highlow.state_name, highlow.highest_point, state.density FROM highlow JOIN state ON highlow.state_name = state.state_name;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT s.state_name, h.highest_point, s.density FROM public.state s JOIN public.highlow h ON s.state_name = h.state_name ORDER BY s.state_name NULLS LAST"}
{"question":"Which states have the highest population density in people per square kilometer, ordered from highest to lowest?","answer":"SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT s.state_name, s.density FROM state s ORDER BY s.density DESC NULLS LAST"}
{"question":"How many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications.","answer":"SELECT conference.name, COUNT(publication.pid) AS num_publications FROM publication JOIN conference ON publication.cid=conference.cid GROUP BY conference.name, conference.cid ORDER BY num_publications DESC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"table_join","generation":"SELECT c.name, COUNT(p.pid) AS publication_count FROM public.conference c JOIN public.publication p ON c.cid = p.cid GROUP BY c.name ORDER BY publication_count DESC"}
{"question":"Return users (user ID and username) who have not received any notifications","answer":"SELECT u.uid, u.username FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id WHERE n.id IS NULL","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_left_join","generation":"SELECT u.uid, u.username FROM consumer_div.users u WHERE u.uid NOT IN (SELECT n.user_id FROM consumer_div.notifications n) ORDER BY u.uid NULLS LAST"}
{"question":"How many rivers flow through each country?","answer":"SELECT river.country_name, COUNT(DISTINCT river.river_name) AS number_of_rivers FROM river GROUP BY river.country_name ORDER BY number_of_rivers DESC;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"group_by","generation":"SELECT r.country_name, COUNT(r.river_name) AS number_of_rivers FROM public.river r GROUP BY r.country_name ORDER BY number_of_rivers DESC NULLS LAST"}
{"question":"Return the distinct list of merchant IDs that have received money from a transaction. Consider all transaction types in the results you return, but only include the merchant ids in your final answer.","answer":"SELECT DISTINCT m.mid AS merchant_id FROM consumer_div.merchants m JOIN consumer_div.wallet_transactions_daily t ON m.mid = t.receiver_id WHERE t.receiver_type = 1","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"basic_join_distinct","generation":"SELECT DISTINCT m.mid FROM consumer_div.merchants m JOIN consumer_div.wallet_merchant_balance_daily w ON m.mid = w.merchant_id WHERE w.balance > 0"}
{"question":"What is the total count of restaurants in each city?","answer":"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS total_count FROM LOCATION GROUP BY location.city_name;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT r.city_name, COUNT(r.id) AS total_restaurants FROM public.restaurant r GROUP BY r.city_name ORDER BY total_restaurants DESC NULLS LAST"}
{"question":"What is the proportion of flights with stops out of all flights for each airline code?","answer":"SELECT flight.airline_code, CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(COUNT(*), 0) AS ratio FROM flight GROUP BY flight.airline_code;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT f.airline_code, CAST(SUM(CASE WHEN f.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(COUNT(f.flight_id), 0) AS proportion_of_flights_with_stops FROM flight f GROUP BY f.airline_code ORDER BY proportion_of_flights_with_stops DESC NULLS LAST"}
{"question":"Who were the top 3 sales representatives by total revenue in the past 3 months, inclusive of today's date? Return their first name, last name, total number of sales and total revenue. Note that revenue refers to the sum of sale_price in the sales table.","answer":"SELECT c.first_name, c.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM sales s JOIN salespersons c ON s.salesperson_id = c.id WHERE s.sale_date >= CURRENT_DATE - INTERVAL '3 months' GROUP BY c.first_name, c.last_name ORDER BY total_revenue DESC LIMIT 3","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_date_group_order_limit","generation":"SELECT sp.first_name, sp.last_name, COUNT(s.id) AS total_sales, SUM(s.sale_price) AS total_revenue FROM salespersons sp JOIN sales s ON sp.id = s.salesperson_id WHERE s.sale_date >= (CURRENT_DATE - INTERVAL '3 months') GROUP BY sp.first_name, sp.last_name ORDER BY total_revenue DESC NULLS LAST LIMIT 3"}
{"question":"Which authors belong to the same domain as Martin?","answer":"SELECT DISTINCT {a2.name, a2.aid} FROM author a1 JOIN domain_author da1 ON a1.aid = da1.aid JOIN domain_author da2 ON da1.did = da2.did JOIN author a2 ON da2.aid = a2.aid WHERE LOWER(a1.name) ILIKE '%martin%';","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT a.name FROM public.author a JOIN public.domain_author da ON a.aid = da.aid WHERE a.name ilike '%Martin%'"}
{"question":"Which authors have published the most papers, ordered by the number of papers they have published in descending order?","answer":"SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS number_of_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY number_of_papers DESC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT a.authorname, COUNT(p.paperid) AS paper_count FROM public.author a JOIN public.writes w ON a.authorid = w.authorid JOIN public.paper p ON w.paperid = p.paperid GROUP BY a.authorname ORDER BY paper_count DESC"}
{"question":"What are the longest rivers in meters, ordered from longest to shortest?","answer":"SELECT river.river_name, river.length FROM river ORDER BY river.length DESC NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"order_by","generation":"SELECT r.river_name, r.length FROM public.river r ORDER BY r.length DESC NULLS LAST"}
{"question":"show me the daily total amount of payments received in the whole of the previous ISO week not including the current week, split by the payment_method","answer":"SELECT payment_date, payment_method, SUM(payment_amount) AS total_amount FROM payments_received WHERE payment_date >= DATE_TRUNC('WEEK', CURRENT_DATE) - INTERVAL '1 week' AND payment_date < DATE_TRUNC('WEEK', CURRENT_DATE) GROUP BY payment_date, payment_method ORDER BY payment_date DESC, payment_method ASC;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT payments_received.payment_method, SUM(payments_received.payment_amount) AS total_payment_amount, DATE(payments_received.payment_date) AS payment_date FROM payments_received WHERE EXTRACT(YEAR FROM payments_received.payment_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(WEEK FROM payments_received.payment_date) = EXTRACT(WEEK FROM CURRENT_DATE) - 1 GROUP BY payments_received.payment_method, payments_received.payment_date ORDER BY payments_received.payment_method, payments_received.payment_date NULLS LAST"}
{"question":"Which flight ids to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order?","answer":"SELECT flight.flight_id, (flight.arrival_time - flight.departure_time) AS duration FROM flight WHERE to_airport = 'ORD' ORDER BY duration ASC NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT f.flight_id FROM public.flight f JOIN public.airport_service a ON f.from_airport = a.airport_code WHERE a.city_code = 'ORD' ORDER BY (f.arrival_time - f.departure_time) ASC NULLS LAST"}
{"question":"Return the distinct list of customer IDs that have made a purchase, based on joining the customers and sales tables.","answer":"SELECT DISTINCT c.id AS customer_id FROM customers c JOIN sales s ON c.id = s.customer_id","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_join_distinct","generation":"SELECT DISTINCT c.id FROM customers c JOIN sales s ON c.id = s.customer_id"}
{"question":"Get the ratio of population per area for each state","answer":"SELECT state_name, population \/ NULLIF(area, 0) AS population_density FROM state;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT s.state_name, s.population::FLOAT \/ NULLIF(s.area, 0) AS population_per_area_ratio FROM public.state s ORDER BY population_per_area_ratio DESC NULLS LAST"}
{"question":"What is the ratio of one-way trip costs to round-trip costs for each fare?","answer":"SELECT fare.fare_id, fare.one_direction_cost::float \/ NULLIF(fare.round_trip_cost, 0) AS cost_ratio FROM fare ORDER BY cost_ratio;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT f.fare_id, f.one_direction_cost::FLOAT \/ NULLIF(f.round_trip_cost, 0) AS ratio FROM public.fare f ORDER BY ratio NULLS LAST"}
{"question":"What was the average transaction daily and monthly limit for the earliest setting snapshot in 2023?","answer":"SELECT AVG(tx_limit_daily) AS avg_daily_limit, AVG(tx_limit_monthly) AS avg_monthly_limit FROM consumer_div.user_setting_snapshot WHERE snapshot_date = (SELECT MIN(snapshot_date) FROM consumer_div.user_setting_snapshot WHERE snapshot_date >= '2023-01-01' AND snapshot_date < '2024-01-01' );","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT AVG(s.tx_limit_daily) AS average_daily_limit, AVG(s.tx_limit_monthly) AS average_monthly_limit FROM consumer_div.user_setting_snapshot s WHERE EXTRACT(YEAR FROM s.snapshot_date) = 2023 ORDER BY s.snapshot_date ASC LIMIT 1"}
{"question":"How many reviews were posted for each business id in the year 2021?","answer":"SELECT review.business_id, COUNT(*) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.business_id ORDER BY review_count DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"instruct","generation":"SELECT r.business_id, COUNT(r.rid) AS review_count FROM public.review r WHERE r.year = 2021 GROUP BY r.business_id ORDER BY review_count DESC NULLS LAST"}
{"question":"How many papers cite each paper in the dataset named \"COVID-19 Research\"?","answer":"SELECT paperdataset.paperid, COUNT(cite.citedpaperid) AS citation_count FROM paperdataset JOIN cite ON paperdataset.paperid = cite.citedpaperid WHERE paperdataset.datasetid = (SELECT datasetid FROM dataset WHERE datasetname ILIKE '%COVID-19 Research%') GROUP BY paperdataset.paperid ORDER BY citation_count DESC;SELECT p.title, COUNT(c.citingpaperid) AS num_citing_papers FROM paper p JOIN paperdataset pd ON p.paperid = pd.paperid JOIN cite c ON p.paperid = c.citedpaperid JOIN dataset d ON pd.datasetid = d.datasetid WHERE d.datasetname = 'COVID-19 Research' GROUP BY p.title ORDER BY num_citing_papers DESC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"table_join","generation":"SELECT p.paperid, p.title, COUNT(c.citingpaperid) AS num_citations FROM public.paper p JOIN public.paperdataset ps ON p.paperid = ps.paperid JOIN public.cite c ON p.paperid = c.citedpaperid JOIN public.dataset d ON ps.datasetid = d.datasetid WHERE d.datasetname = 'COVID-19 Research' GROUP BY p.paperid, p.title ORDER BY num_citations DESC NULLS LAST"}
{"question":"What cities have more than one restaurants with the same name, and how many of them are there? Return the city name, restaurant name, and restaurant count","answer":"SELECT r.city_name, r.name, COUNT(r.id) AS restaurant_count FROM restaurant r GROUP BY r.city_name, r.name HAVING COUNT(r.id) > 1;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT l.city_name, r.name, COUNT(r.id) AS restaurant_count FROM public.restaurant r JOIN public.location l ON r.city_name = l.city_name GROUP BY l.city_name, r.name HAVING COUNT(r.id) > 1 ORDER BY restaurant_count DESC NULLS LAST"}
{"question":"What are the top 5 drugs by number of treatments and average drug amount per treatment? Return the drug name, number of treatments, and average drug amount.","answer":"SELECT d.drug_name, COUNT(*) AS num_treatments, AVG(t.tot_drug_amt) AS avg_drug_amt FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id GROUP BY d.drug_name ORDER BY num_treatments DESC, avg_drug_amt DESC LIMIT 5","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_group_order_limit","generation":"SELECT d.drug_name, COUNT(t.treatment_id) AS num_treatments, AVG(t.tot_drug_amt) AS avg_drug_amt FROM treatments t JOIN drugs d ON t.drug_id = d.drug_id GROUP BY d.drug_name ORDER BY num_treatments DESC, avg_drug_amt DESC LIMIT 5"}
{"question":"What is the average rating of restaurants in each region? Order the results by the region name.","answer":"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name GROUP BY geographic.region ORDER BY geographic.region NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT g.region, AVG(r.rating) AS average_rating FROM public.restaurant r JOIN public.location l ON r.id = l.restaurant_id JOIN public.geographic g ON l.city_name = g.city_name GROUP BY g.region ORDER BY g.region NULLS LAST"}
{"question":"How does the average ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers?","answer":"SELECT aircraft.manufacturer, AVG(CAST(aircraft.cruising_speed AS FLOAT) \/ NULLIF(aircraft.pay_load, 0)) AS speed_payload_ratio FROM aircraft GROUP BY aircraft.manufacturer ORDER BY speed_payload_ratio DESC NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"ratio","generation":"SELECT a.manufacturer, AVG(a.cruising_speed::FLOAT \/ NULLIF(a.pay_load, 0)) AS avg_ratio FROM aircraft a GROUP BY a.manufacturer ORDER BY avg_ratio DESC NULLS LAST"}
{"question":"What are the names of the businesses in the database, ordered alphabetically?","answer":"SELECT business.name FROM business ORDER BY business.name ASC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"order_by","generation":"SELECT b.name FROM public.business b ORDER BY b.name ASC"}
{"question":"What is the ratio of publications to authors in the database?","answer":"SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT author.aid), 0) AS publication_to_author_ratio FROM publication, author;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT p.pid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT a.aid), 0) AS ratio FROM public.publication p, public.author a"}
{"question":"Which restaurants serve Italian cuisine or are located in New York? Order the results by the restaurant name.","answer":"SELECT name FROM restaurant WHERE food_type ILIKE '%Italian%' OR city_name ILIKE '%New York%' ORDER BY name NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"order_by","generation":"SELECT DISTINCT r.name FROM public.restaurant r JOIN public.location l ON r.id = l.restaurant_id WHERE r.food_type ilike '%Italian%' OR l.city_name ilike '%New York%' ORDER BY r.name NULLS LAST"}
{"question":"What is the total number of check-ins for each business in the state of California?","answer":"SELECT {business.business_id, business.name, business.bid}, SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' GROUP BY {} ORDER BY total_checkins DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT b.business_id, SUM(c.count) AS total_checkins FROM public.business b JOIN public.checkin c ON b.business_id = c.business_id WHERE b.state = 'California' GROUP BY b.business_id ORDER BY total_checkins DESC NULLS LAST"}
{"question":"How many papers were published in the journal \"nature\" in the year 2020?","answer":"SELECT COUNT(paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid WHERE paper.year = 2020 AND journal.journalname ILIKE '%nature%';","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"instruct","generation":"SELECT COUNT(p.paperid) FROM public.paper p JOIN public.journal j ON p.journalid = j.journalid WHERE j.journalname ilike '%nature%' AND p.year = 2020"}
{"question":"How many meals are served in each compartment, sorted by the number of meals in descending order?","answer":"SELECT food_service.compartment, COUNT(food_service.meal_number) AS number_of_meals FROM food_service GROUP BY food_service.compartment ORDER BY number_of_meals DESC NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"group_by","generation":"SELECT f.compartment, COUNT(f.meal_code) AS number_of_meals FROM public.food_service f GROUP BY f.compartment ORDER BY number_of_meals DESC NULLS LAST"}
{"question":"What is the total number of citations received by each author?","answer":"SELECT {author.name, author.aid}, sum(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY {} ORDER BY total_citations DESC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"group_by","generation":"SELECT a.name, SUM(p.citation_num) AS total_citations FROM public.author a JOIN public.writes w ON a.aid = w.aid JOIN public.publication p ON w.pid = p.pid GROUP BY a.name ORDER BY total_citations DESC NULLS LAST"}
{"question":"What is the ratio of the number of courses with projects to the number of courses with exams in each semester id?","answer":"SELECT course_offering.semester, CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM course JOIN course_offering ON course.course_id = course_offering.course_id GROUP BY course_offering.semester ORDER BY course_offering.semester NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"ratio","generation":"SELECT c.semester, CAST(SUM(CASE WHEN c.has_projects THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN c.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM public.course c GROUP BY c.semester ORDER BY c.semester NULLS LAST"}
{"question":"What is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York?","answer":"SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM restaurant WHERE city_name ILIKE 'New York';","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"ratio","generation":"SELECT CAST(COUNT(CASE WHEN r.rating > 4 THEN 1 END) AS FLOAT) \/ NULLIF(COUNT(CASE WHEN r.rating < 4 THEN 1 END), 0) AS ratio FROM public.restaurant r JOIN public.location l ON r.id = l.restaurant_id JOIN public.geographic g ON l.city_name = g.city_name WHERE g.city_name = 'New York'"}
{"question":"What is the total number of publications in each journal, ordered by the number of publications in descending order?","answer":"SELECT {journal.name, journal.jid}, COUNT(publication.pid) AS total_publications FROM publication JOIN journal ON publication.jid=journal.jid GROUP BY {} ORDER BY total_publications DESC NULLS LAST;SELECT {journal.name, journal.jid}, COUNT(publication.pid) AS total_publications FROM journal LEFT JOIN publication ON journal.jid=publication.jid GROUP BY {} ORDER BY total_publications DESC NULLS LAST;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"table_join","generation":"SELECT j.name, COUNT(p.pid) AS total_publications FROM public.journal j JOIN public.publication p ON j.jid = p.jid GROUP BY j.name ORDER BY total_publications DESC"}
{"question":"What is the total count of check-ins for each business id?","answer":"SELECT checkin.business_id, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.business_id ORDER BY total_checkins DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"group_by","generation":"SELECT c.business_id, SUM(c.count) AS total_count FROM public.checkin c GROUP BY c.business_id ORDER BY total_count DESC NULLS LAST"}
{"question":"Return the salesperson ID, first name and last name for salespersons that have no sales records, by doing a left join from the salespersons to sales table.","answer":"SELECT s.id AS salesperson_id, s.first_name, s.last_name FROM salespersons s LEFT JOIN sales sa ON s.id = sa.salesperson_id WHERE sa.salesperson_id IS NULL","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_left_join","generation":"SELECT sp.id AS salesperson_id, sp.first_name, sp.last_name FROM salespersons sp LEFT JOIN sales s ON sp.id = s.salesperson_id WHERE s.salesperson_id IS NULL"}
{"question":"What are the easiness scores for courses in the \"Computer Science\" department? Show both courses and scores.","answer":"SELECT {course.name, course.course_id, course.number}, course.easiness_score FROM course WHERE course.department = 'Computer Science';","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"instruct","generation":"SELECT c.name, c.easiness_score FROM public.course c WHERE c.department ilike '%Computer%Science%' ORDER BY c.easiness_score NULLS LAST"}
{"question":"Which airlines offer flights with a stopover in Dallas?","answer":"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight_stop JOIN airport ON flight_stop.stop_airport = airport.airport_code JOIN flight ON flight_stop.flight_id = flight.flight_id JOIN airline ON flight.airline_code = airline.airline_code WHERE airport.airport_location ILIKE '%Dallas%';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT DISTINCT a.airline_name FROM public.airline a JOIN public.airport_service s ON a.airline_code = s.airport_code JOIN public.city c ON s.city_code = c.city_code WHERE c.city_name = 'Dallas'"}
{"question":"How many treatments for diagnoses containing 'psoriasis' (match with wildcards case-insensitively) involve drugs that have been FDA-approved and the treatments have ended within the last 6 months from today?","answer":"SELECT COUNT(*) FROM treatments t JOIN diagnoses d ON t.diag_id = d.diag_id JOIN drugs dr ON t.drug_id = dr.drug_id WHERE d.diag_name ILIKE '%psoriasis%' AND dr.fda_appr_dt IS NOT NULL AND t.end_dt >= CURRENT_DATE - INTERVAL '6 months';","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"date_functions","generation":"SELECT COUNT(DISTINCT t.treatment_id) FROM treatments t JOIN diagnoses d ON t.diag_id = d.diag_id JOIN drugs dg ON t.drug_id = dg.drug_id WHERE d.diag_name ilike '%psoriasis%' AND dg.fda_appr_dt IS NOT NULL AND t.end_dt >= (CURRENT_DATE - interval '6 months')"}
{"question":"What is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams?","answer":"SELECT SUM(CASE WHEN c.has_exams THEN c.num_enrolled ELSE 0 END)::FLOAT \/ SUM(CASE WHEN NOT c.has_exams THEN c.num_enrolled ELSE 0 END) AS ratio FROM course c;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"ratio","generation":"SELECT CAST(SUM(CASE WHEN c.has_exams THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN NOT c.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM public.course c"}
{"question":"What are the aircraft codes for all aircraft with a cruising speed of over 200 mph? sort the aircraft codes in ascending order.","answer":"SELECT aircraft.aircraft_code FROM aircraft WHERE aircraft.cruising_speed > 200 ORDER BY aircraft.aircraft_code ASC NULLS LAST;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"order_by","generation":"SELECT a.aircraft_code FROM public.aircraft a WHERE a.cruising_speed > 200 ORDER BY a.aircraft_code ASC"}
{"question":"What are the top 5 countries by total transaction amount in the past 30 days, inclusive of 30 days ago? Return the country name, number of transactions and total transaction amount.","answer":"SELECT c.sbCustCountry, COUNT(t.sbTxId) AS num_transactions, SUM(t.sbTxAmount) AS total_amount FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxDateTime >= CURRENT_DATE - INTERVAL '30 days' GROUP BY c.sbCustCountry ORDER BY total_amount DESC LIMIT 5","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_date_group_order_limit","generation":"SELECT c.sbCustCountry, COUNT(t.sbTxId) AS number_of_transactions, SUM(t.sbTxAmount) AS total_transaction_amount FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE t.sbTxDateTime >= (CURRENT_DATE - INTERVAL '30 days') GROUP BY c.sbCustCountry ORDER BY total_transaction_amount DESC NULLS LAST LIMIT 5"}
{"question":"How many restaurants are there in each region?","answer":"SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic LEFT JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"table_join","generation":"SELECT g.region, COUNT(r.id) AS number_of_restaurants FROM public.geographic g JOIN public.location l ON g.city_name = l.city_name JOIN public.restaurant r ON l.restaurant_id = r.id GROUP BY g.region ORDER BY number_of_restaurants DESC NULLS LAST"}
{"question":"Lowest daily closest price for symbol `VTI` in the past 7 days","answer":"SELECT MIN(sdp.sbDpClose) AS lowest_price FROM sbDailyPrice AS sdp JOIN sbTicker AS st ON sdp.sbDpTickerId = st.sbTickerId WHERE st.sbTickerSymbol = 'VTI' AND sdp.sbDpDate >= CURRENT_DATE - INTERVAL '7 days';","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"date_functions","generation":"SELECT MIN(sbDpLow) AS lowest_price FROM sbDailyPrice WHERE sbDpTickerId = 'VTI' AND sbDpDate >= (CURRENT_DATE - INTERVAL '7 days')"}
{"question":"Which states have fewer than a hundred thousand people?","answer":"SELECT state_name FROM state WHERE population < 100000;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT s.state_name FROM public.state s WHERE s.population < 100000"}
{"question":"List the last name, year of registration, and first treatment (date and id) by doctors who were registered 2 years ago.","answer":"WITH doc_first_treatment AS (SELECT d.doc_id, d.last_name, d.year_reg, t.treatment_id, t.start_dt, ROW_NUMBER() OVER (PARTITION BY d.doc_id ORDER BY t.start_dt ASC) AS rn FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE d.year_reg = EXTRACT(YEAR FROM CURRENT_DATE) - 2 ) SELECT last_name, year_reg, start_dt AS first_treatment_date, treatment_id AS first_treatment_id FROM doc_first_treatment WHERE rn = 1;","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"date_functions","generation":"SELECT d.last_name, d.year_reg, t.start_dt, t.treatment_id FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE d.year_reg >= EXTRACT(YEAR FROM CURRENT_DATE) - 2 ORDER BY d.last_name NULLS LAST"}
{"question":"What is the ratio of publications presented in conferences to publications published in journals?","answer":"SELECT CAST(COUNT(DISTINCT CASE WHEN cid IS NOT NULL THEN pid END) AS FLOAT) \/ NULLIF(COUNT(DISTINCT CASE WHEN jid IS NOT NULL THEN pid END), 0) AS ratio FROM publication;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"ratio","generation":"SELECT CAST(COUNT(DISTINCT p.cid) AS FLOAT) \/ NULLIF(COUNT(DISTINCT p.jid), 0) AS ratio FROM public.publication p"}
{"question":"What are the titles of the papers published in the year 2020, ordered alphabetically?","answer":"SELECT paper.title FROM paper WHERE paper.year = 2020 ORDER BY paper.title ASC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT p.title FROM public.paper p WHERE p.year = 2020 ORDER BY p.title ASC"}
{"question":"What is the ratio of helpfulness scores to clarity scores for each course ID?","answer":"SELECT course.course_id, CAST(course.helpfulness_score AS FLOAT) \/ NULLIF(course.clarity_score, 0) AS ratio FROM course;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"ratio","generation":"SELECT c.course_id, CAST(SUM(c.helpfulness_score) AS FLOAT) \/ NULLIF(SUM(c.clarity_score), 0) AS ratio FROM public.course c GROUP BY c.course_id ORDER BY ratio NULLS LAST"}
{"question":"What are the top 5 countries by number of customers? Return the country name and number of customers.","answer":"SELECT sbCustCountry, COUNT(*) AS num_customers FROM sbCustomer GROUP BY sbCustCountry ORDER BY num_customers DESC LIMIT 5","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_group_order_limit","generation":"SELECT c.sbCustCountry, COUNT(c.sbCustId) AS customer_count FROM sbCustomer c GROUP BY c.sbCustCountry ORDER BY customer_count DESC NULLS LAST LIMIT 5"}
{"question":"How many reviews were written for businesses located in California in the last 10 months?","answer":"SELECT count(*) AS review_count FROM review r JOIN business b ON r.business_id = b.business_id WHERE b.state = 'CA' AND (r.year * 12 + extract(MONTH FROM to_date(r.month, 'Month'))) >= (extract(YEAR FROM CURRENT_DATE) * 12 + extract(MONTH FROM CURRENT_DATE) - 10);","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT COUNT(r.rid) AS review_count FROM public.review r JOIN public.business b ON r.business_id = b.business_id WHERE b.state = 'California' AND TO_DATE(r.year::TEXT || r.month, 'YYYYMonth') >= (CURRENT_DATE - INTERVAL '10 months')"}
{"question":"What is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD) for each airline, sorted in descending order by average cost?","answer":"SELECT fare.fare_airline, AVG(fare.round_trip_cost) AS average_cost FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.fare_airline ORDER BY average_cost DESC NULLS LAST;SELECT airline.airline_name, AVG(fare.round_trip_cost) AS avg_round_trip_cost FROM fare JOIN airline ON fare.fare_airline = airline.airline_code WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY airline.airline_name ORDER BY avg_round_trip_cost DESC;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"group_by","generation":"SELECT a.airline_name, AVG(f.round_trip_cost) AS average_round_trip_cost FROM fare f JOIN airport_service a ON f.from_airport = a.airport_code AND f.to_airport = a.airport_code WHERE a.city_code = 'LAX' AND a.airport_code = 'ORD' GROUP BY a.airline_name ORDER BY average_round_trip_cost DESC NULLS LAST"}
{"question":"Count the number of flight departures for each month?","answer":"SELECT month.month_name, count(*) AS departure_count FROM flight JOIN month ON extract(MONTH FROM to_timestamp(flight.departure_time)) = month.month_number GROUP BY month.month_name, month.month_number ORDER BY month.month_number;SELECT date_trunc('month', to_timestamp(flight.departure_time)) AS month, COUNT(*) AS num_departures FROM flight GROUP BY MONTH ORDER BY MONTH;SELECT EXTRACT(MONTH FROM to_timestamp(flight.departure_time)) AS month, COUNT(*) AS num_departures FROM flight GROUP BY month ORDER BY month;SELECT TO_CHAR(TO_TIMESTAMP(flight.departure_time), 'YYYY-MM') AS month, COUNT(*) AS num_departures FROM flight GROUP BY month ORDER BY month;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT date_trunc('month', to_timestamp(f.departure_time)) AS MONTH, COUNT(*) AS num_departures FROM flight f GROUP BY MONTH ORDER BY MONTH"}
{"question":"Which users did not get a notification within the first year of signing up? Return their usernames, emails and signup dates.","answer":"SELECT u.username, u.email, u.created_at FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id AND n.created_at BETWEEN u.created_at AND u.created_at + INTERVAL '1 year' WHERE n.user_id IS NULL;","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT u.username, u.email, u.created_at FROM consumer_div.users u LEFT JOIN consumer_div.notifications n ON u.uid = n.user_id AND n.created_at BETWEEN u.created_at AND u.created_at + interval '1 year' WHERE n.user_id IS NULL"}
{"question":"What are the publications written by authors from the 'Sociology' domain and presented at conferences in the year 2020?","answer":"SELECT DISTINCT {publication.title, publication.pid} FROM DOMAIN JOIN domain_author ON domain.did = domain_author.did JOIN writes ON domain_author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_conference ON domain.did = domain_conference.did WHERE domain.name ILIKE '%Sociology%' AND publication.year = 2020 AND publication.cid = domain_conference.cid;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT p.title, p.year, a.name, c.name FROM publication p JOIN writes w ON p.pid = w.pid JOIN author a ON w.aid = a.aid JOIN domain_conference dc ON p.cid = dc.cid JOIN conference c ON dc.cid = c.cid WHERE p.year = 2020 AND dc.did = (SELECT did FROM domain WHERE name = 'Sociology')"}
{"question":"How many months between June 2021 and December 2021 had reviews?","answer":"SELECT COUNT(DISTINCT MONTH) AS num_months FROM review WHERE YEAR = 2021 AND CASE MONTH WHEN 'January' THEN 1 WHEN 'February' THEN 2 WHEN 'March' THEN 3 WHEN 'April' THEN 4 WHEN 'May' THEN 5 WHEN 'June' THEN 6 WHEN 'July' THEN 7 WHEN 'August' THEN 8 WHEN 'September' THEN 9 WHEN 'October' THEN 10 WHEN 'November' THEN 11 WHEN 'December' THEN 12 END BETWEEN 6 AND 12;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT COUNT(DISTINCT r.month) AS months_with_reviews FROM review r WHERE r.year = 2021 AND EXTRACT(MONTH FROM TO_DATE(r.month,'month')) BETWEEN 6 AND 12"}
{"question":"What are the top 10 ticker symbols by total transaction amount? Return the ticker symbol, number of transactions and total transaction amount.","answer":"SELECT tk.sbTickerSymbol, COUNT(tx.sbTxId) AS num_transactions, SUM(tx.sbTxAmount) AS total_amount FROM sbTicker tk JOIN sbTransaction tx ON tk.sbTickerId = tx.sbTxTickerId GROUP BY tk.sbTickerSymbol ORDER BY total_amount DESC LIMIT 10","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_join_group_order_limit","generation":"SELECT t.sbTickerSymbol, COUNT(t.sbTxId) AS number_of_transactions, SUM(t.sbTxAmount) AS total_transaction_amount FROM sbTransaction t GROUP BY t.sbTickerSymbol ORDER BY total_transaction_amount DESC LIMIT 10"}
{"question":"Which author had the most publications in the year 2021 and how many publications did he\/she have that year?","answer":"SELECT {author.name, author.aid}, COUNT(publication.pid) AS publication_count FROM writes JOIN author ON writes.aid = author.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY {} ORDER BY publication_count DESC NULLS LAST LIMIT 1;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"table_join","generation":"SELECT a.name, COUNT(p.pid) AS publication_count FROM public.author a JOIN public.publication p ON a.aid = p.aid WHERE p.year = 2021 GROUP BY a.name ORDER BY publication_count DESC NULLS LAST LIMIT 1"}
{"question":"What is the ratio of open businesses to closed businesses in the city of San Francisco?","answer":"SELECT CAST(SUM(CASE WHEN business.is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN business.is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM business WHERE LOWER(business.city) ILIKE '%san francisco%';","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT CAST(SUM(CASE WHEN b.is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN b.is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM public.business b WHERE b.city ilike '%San%Francisco%'"}
{"question":"What is the total cost of round-trip fares for each airline code?","answer":"SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare GROUP BY fare.fare_airline ORDER BY total_round_trip_cost DESC;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"group_by","generation":"SELECT f.airline_code, SUM(f.round_trip_cost) AS total_round_trip_cost FROM fare f GROUP BY f.airline_code ORDER BY total_round_trip_cost DESC NULLS LAST"}
{"question":"Get the cities in the United States and their population","answer":"SELECT city_name, population FROM city WHERE country_name ILIKE '%United States%';","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"instruct","generation":"SELECT c.city_name, c.population FROM public.city c WHERE c.country_name = 'United States' ORDER BY c.population DESC NULLS LAST"}
{"question":"What is the total number of papers associated with each dataset?","answer":"SELECT paperdataset.datasetid, COUNT(DISTINCT paperdataset.paperid) AS total_papers FROM paperdataset GROUP BY paperdataset.datasetid;SELECT dataset.datasetname, COUNT(paperdataset.paperid) AS total_papers FROM paperdataset JOIN dataset ON paperdataset.datasetid = dataset.datasetid GROUP BY dataset.datasetname;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT d.datasetname, COUNT(p.paperid) AS total_papers FROM public.dataset d JOIN public.paperdataset pd ON d.datasetid = pd.datasetid JOIN public.paper p ON pd.paperid = p.paperid GROUP BY d.datasetname ORDER BY total_papers DESC NULLS LAST"}
{"question":"Return the customer who made the most sell transactions on 2023-04-01. Return the id, name and number of transactions.","answer":"WITH SellTransactions AS (SELECT sbTxCustId, COUNT(*) AS num_tx FROM sbTransaction WHERE sbTxDateTime::date = '2023-04-01' AND sbTxType = 'sell' GROUP BY sbTxCustId) SELECT c.sbCustId, c.sbCustName, st.num_tx FROM sbCustomer c JOIN SellTransactions st ON c.sbCustId = st.sbTxCustId ORDER BY st.num_tx DESC LIMIT 1;","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"date_functions","generation":"SELECT c.sbCustId, c.sbCustName, COUNT(t.sbTxId) AS transaction_count FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId WHERE t.sbTxDateTime = '2023-04-01' GROUP BY c.sbCustId, c.sbCustName ORDER BY transaction_count DESC LIMIT 1"}
{"question":"What is the average clarity score for each instructor who taught a course?","answer":"SELECT {i.name, i.instructor_id}, AVG(c.clarity_score) FROM course c JOIN course_offering co ON c.course_id = co.course_id JOIN offering_instructor oi ON co.offering_id = oi.offering_id JOIN instructor i ON oi.instructor_id = i.instructor_id GROUP BY {};","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT i.instructor_id, AVG(c.clarity_score) AS average_clarity_score FROM public.instructor i JOIN public.course_offering co ON i.instructor_id = co.instructor_id JOIN public.course c ON co.course_id = c.course_id GROUP BY i.instructor_id ORDER BY average_clarity_score DESC NULLS LAST"}
{"question":"What are the top 3 transaction statuses by number of transactions? Return the status and number of transactions.","answer":"SELECT sbTxStatus, COUNT(*) AS num_transactions FROM sbTransaction GROUP BY sbTxStatus ORDER BY num_transactions DESC LIMIT 3","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"basic_group_order_limit","generation":"SELECT sbTransaction.sbTxStatus, COUNT(sbTransaction.sbTxId) AS number_of_transactions FROM sbTransaction GROUP BY sbTransaction.sbTxStatus ORDER BY number_of_transactions DESC NULLS LAST LIMIT 3"}
{"question":"What is the total number of publications presented in each conference?","answer":"SELECT {conference.name, conference.cid}, COUNT(publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY {} ORDER BY total_publications DESC;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"table_join","generation":"SELECT c.name, COUNT(p.pid) AS total_publications FROM public.conference c JOIN public.publication p ON c.cid = p.cid GROUP BY c.name ORDER BY total_publications DESC NULLS LAST"}
{"question":"How does the ratio of enrolled students to the number of reviews vary across different courses?","answer":"SELECT {course.course_id, course.name, course.number}, CAST(course.num_enrolled AS FLOAT) \/ NULLIF(course.num_reviews, 0) AS student_review_ratio FROM course ORDER BY student_review_ratio NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"ratio","generation":"SELECT c.name, CAST(c.num_enrolled AS FLOAT) \/ NULLIF(c.num_reviews, 0) AS ratio FROM public.course c ORDER BY ratio NULLS LAST"}
{"question":"For treatments that ended in the year 2022 (from Jan 1st to Dec 31st inclusive), what is the average PASI score at day 100 and number of distinct patients per insurance type? Return the top 5 insurance types sorted by lowest average PASI score first.","answer":"SELECT p.ins_type, COUNT(DISTINCT t.patient_id) AS num_patients, AVG(o.day100_pasi_score) AS avg_pasi_score FROM treatments t JOIN patients p ON t.patient_id = p.patient_id JOIN outcomes o ON t.treatment_id = o.treatment_id WHERE t.end_dt BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY p.ins_type ORDER BY avg_pasi_score LIMIT 5","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_date_group_order_limit","generation":"SELECT p.ins_type, AVG(o.day100_pasi_score) AS average_pasi_score, COUNT(DISTINCT t.patient_id) AS patient_count FROM treatments t JOIN outcomes o ON t.treatment_id = o.treatment_id JOIN patients p ON t.patient_id = p.patient_id WHERE EXTRACT(YEAR FROM t.start_dt) = 2022 AND EXTRACT(YEAR FROM t.end_dt) = 2022 AND o.day100_pasi_score IS NOT NULL GROUP BY p.ins_type ORDER BY average_pasi_score ASC, patient_count DESC LIMIT 5"}
{"question":"What are the total number of customer signups for the top 2 states? Return the state and total signups, starting from the top.","answer":"SELECT state, COUNT(*) AS total_signups FROM customers GROUP BY state ORDER BY total_signups DESC LIMIT 2","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"basic_group_order_limit","generation":"SELECT c.state, COUNT(c.id) AS total_signups FROM customers c GROUP BY c.state ORDER BY total_signups DESC NULLS LAST LIMIT 2"}
{"question":"Return the treatment id, treatment start date, adverse event date and description of all adverse events that occured within 10 days after starting treatment","answer":"SELECT t.treatment_id, t.start_dt, ae.reported_dt, ae.description FROM adverse_events ae JOIN treatments t ON ae.treatment_id = t.treatment_id WHERE ae.reported_dt BETWEEN t.start_dt AND t.start_dt + INTERVAL '10 days';","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"date_functions","generation":"SELECT t.treatment_id, t.start_dt, a.reported_dt, a.description FROM treatments t JOIN adverse_events a ON t.treatment_id = a.treatment_id WHERE a.reported_dt BETWEEN t.start_dt AND t.start_dt + interval '10 days'"}
{"question":"How many courses are offered for each semester id?","answer":"SELECT course_offering.semester, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM course_offering GROUP BY course_offering.semester ORDER BY course_offering.semester;SELECT semester.semester_id, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM semester LEFT JOIN course_offering ON semester.semester_id = course_offering.semester GROUP BY semester.semester_id;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT c.semester, COUNT(c.course_id) AS num_courses FROM public.course_offering c GROUP BY c.semester ORDER BY c.semester NULLS LAST"}
{"question":"What is the total number of students who found the instructor to be hilarious per course id?","answer":"SELECT course_tags_count.course_id, SUM(course_tags_count.hilarious) AS total_hilarious FROM course_tags_count GROUP BY course_tags_count.course_id;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"group_by","generation":"SELECT c.course_id, COUNT(DISTINCT(ci.student_id)) AS total_students FROM public.comment_instructor ci JOIN public.course_tags_count ct ON ci.instructor_id = ct.course_id WHERE ct.hilarious > 0 GROUP BY c.course_id ORDER BY total_students DESC NULLS LAST"}
{"question":"What's the earliest flight departure time in the day in HH:MM?","answer":"SELECT to_char(to_timestamp(departure_time)::TIME, 'HH24:MI') AS earliest_departure_time FROM flight ORDER BY earliest_departure_time LIMIT 1;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"date_functions","generation":"SELECT TO_CHAR(TO_TIMESTAMP(MIN(f.departure_time)), 'HH24:MI') AS earliest_departure_time FROM flight f"}
{"question":"what was the average user session duration in seconds split by device_type?","answer":"SELECT device_type, AVG(EXTRACT(EPOCH FROM (session_end_ts - session_start_ts))) AS avg_session_duration_seconds FROM consumer_div.user_sessions WHERE session_end_ts IS NOT NULL GROUP BY device_type;","db_name":"ewallet","context":"CREATE SCHEMA IF NOT EXISTS consumer_div;\n\nCREATE TABLE consumer_div.users (uid BIGINT PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, phone_number VARCHAR(20), created_at TIMESTAMP NOT NULL, last_login_at TIMESTAMP, user_type VARCHAR(20) NOT NULL, status VARCHAR(20) NOT NULL, country VARCHAR(2), address_billing TEXT, address_delivery TEXT, kyc_status VARCHAR(20), kyc_verified_at TIMESTAMP);\n\nCREATE TABLE consumer_div.merchants (mid BIGINT PRIMARY KEY, name VARCHAR(100) NOT NULL, description TEXT, website_url VARCHAR(200), logo_url VARCHAR(200), created_at TIMESTAMP NOT NULL, country VARCHAR(2), state VARCHAR(50), city VARCHAR(50), postal_code VARCHAR(20), address TEXT, status VARCHAR(20) NOT NULL, category VARCHAR(50), sub_category VARCHAR(50), mcc INT, contact_name VARCHAR(100), contact_email VARCHAR(100), contact_phone VARCHAR(20));\n\nCREATE TABLE consumer_div.coupons (cid BIGINT PRIMARY KEY, merchant_id BIGINT NOT NULL REFERENCES consumer_div.merchants(mid), code VARCHAR(20) NOT NULL, description TEXT, start_date DATE NOT NULL, end_date DATE NOT NULL, discount_type VARCHAR(20) NOT NULL, discount_value DECIMAL(10,2) NOT NULL, min_purchase_amount DECIMAL(10,2), max_discount_amount DECIMAL(10,2), redemption_limit INT, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, updated_at TIMESTAMP);\n\nCREATE TABLE consumer_div.wallet_transactions_daily (txid SERIAL PRIMARY KEY, sender_id BIGINT NOT NULL, sender_type INT NOT NULL, receiver_id BIGINT NOT NULL, receiver_type INT NOT NULL, amount DECIMAL(10,2) NOT NULL, status VARCHAR(20) NOT NULL, type VARCHAR(20) NOT NULL, description TEXT, coupon_id BIGINT, created_at TIMESTAMP NOT NULL, completed_at TIMESTAMP, transaction_ref VARCHAR(36) NOT NULL, gateway_name VARCHAR(50), gateway_ref VARCHAR(50), device_id VARCHAR(50), ip_address VARCHAR(50), user_agent TEXT);\n\nCREATE TABLE consumer_div.wallet_user_balance_daily (user_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.wallet_merchant_balance_daily (merchant_id BIGINT, balance DECIMAL(10,2) NOT NULL, updated_at TIMESTAMP NOT NULL);\n\nCREATE TABLE consumer_div.notifications (id SERIAL PRIMARY KEY, user_id INT NOT NULL REFERENCES consumer_div.users(uid), message TEXT NOT NULL, type VARCHAR(50) NOT NULL, status VARCHAR(20) NOT NULL, created_at TIMESTAMP NOT NULL, read_at TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36), action_url TEXT);\n\nCREATE TABLE consumer_div.user_sessions (user_id BIGINT NOT NULL, session_start_ts TIMESTAMP NOT NULL, session_end_ts TIMESTAMP, device_type VARCHAR(10), device_id VARCHAR(36));\n\nCREATE TABLE consumer_div.user_setting_snapshot (user_id BIGINT NOT NULL, snapshot_date DATE NOT NULL, tx_limit_daily DECIMAL(10,2), tx_limit_monthly DECIMAL(10,2), membership_status INTEGER, password_hash VARCHAR(255), api_key VARCHAR(255), verified_devices TEXT, verified_ips TEXT, mfa_enabled BOOLEAN, marketing_opt_in BOOLEAN, created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (user_id, snapshot_date));","query_category":"date_functions","generation":"SELECT n.device_type, AVG(n.session_end_ts - n.session_start_ts) AS average_duration FROM consumer_div.user_sessions n GROUP BY n.device_type"}
{"question":"Which course has the highest number of enrolled students, and what is the enrollment number?","answer":"SELECT {course.name, course.course_id, course.number}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT c.name, c.num_enrolled FROM course c ORDER BY c.num_enrolled DESC NULLS LAST LIMIT 1"}
{"question":"Which airlines offer flights from LAX to ORD?","answer":"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD';","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"table_join","generation":"SELECT DISTINCT f.airline_code, f.airline_name FROM public.flight f JOIN public.airport_service a ON f.from_airport = a.airport_code AND f.to_airport = a.city_code WHERE a.city_code = 'LAX' AND a.city_code = 'ORD' ORDER BY f.airline_name NULLS LAST"}
{"question":"What is the total number of reviews for each business category?","answer":"SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT c.category_name, COUNT(r.rid) AS total_reviews FROM public.review r JOIN public.category c ON r.business_id = c.business_id GROUP BY c.category_name ORDER BY total_reviews DESC NULLS LAST"}
{"question":"How many students have declared a major in each program?","answer":"SELECT {program.name, program.program_id}, COUNT(student.student_id) AS number_of_students FROM student JOIN program ON student.program_id = program.program_id WHERE student.declare_major IS NOT NULL GROUP BY {} ORDER BY number_of_students DESC;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT p.name, COUNT(s.student_id) AS number_of_students FROM public.program p JOIN public.student s ON p.program_id = s.program_id GROUP BY p.name ORDER BY number_of_students DESC NULLS LAST"}
{"question":"What are the top 5 domains with the highest number of authors associated with them?","answer":"SELECT {d.name, d.did}, COUNT(DISTINCT a.aid) AS author_count FROM author a JOIN domain_author da ON a.aid = da.aid JOIN domain d ON da.did = d.did GROUP BY {} ORDER BY author_count DESC LIMIT 5;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"order_by","generation":"SELECT d.name, COUNT(a.aid) AS author_count FROM public.domain d JOIN public.domain_author a ON d.did = a.did GROUP BY d.name ORDER BY author_count DESC NULLS LAST LIMIT 5"}
{"question":"Which lakes have a name that starts with \"Lake\"? They should be located in states with an area greater than 1000 square kilometers.","answer":"SELECT lake.lake_name FROM lake JOIN state ON lake.state_name = state.state_name WHERE state.area > 1000 AND lake.lake_name ilike 'Lake%' ORDER BY lake.lake_name NULLS LAST;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"table_join","generation":"SELECT l.lake_name FROM public.lake l JOIN public.state s ON l.state_name = s.state_name WHERE l.lake_name ilike 'Lake%' AND s.area > 1000"}
{"question":"What is the ratio of the number of businesses in each state to the total number of businesses in the database?","answer":"SELECT business.state, COUNT(business.business_id) \/ NULLIF(CAST((SELECT COUNT(*) FROM business) AS FLOAT), 0) AS ratio FROM business GROUP BY business.state;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"ratio","generation":"SELECT b.state, COUNT(b.bid)::FLOAT \/ (SELECT COUNT(b2.bid) FROM public.business b2) AS ratio FROM public.business b GROUP BY b.state"}
{"question":"How many authors have published more than 2 papers?","answer":"SELECT COUNT(*) AS number_of_authors FROM (SELECT writes.authorid FROM writes GROUP BY writes.authorid HAVING COUNT(writes.paperid) > 2) AS subquery;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT a.authorname FROM public.author a JOIN (SELECT w.authorid FROM public.writes w GROUP BY w.authorid HAVING COUNT(w.paperid) > 2) AS m ON a.authorid = m.authorid"}
{"question":"What are the top 3 doctor specialties by total drug amount prescribed for treatments started in the past 6 calendar months? Return the specialty, number of treatments, and total drug amount.","answer":"SELECT d.specialty, COUNT(*) AS num_treatments, SUM(t.tot_drug_amt) AS total_drug_amt FROM treatments t JOIN doctors d ON t.doc_id = d.doc_id WHERE t.start_dt >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '6 months') GROUP BY d.specialty ORDER BY total_drug_amt DESC LIMIT 3","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_date_group_order_limit","generation":"SELECT d.specialty, COUNT(t.treatment_id) AS num_treatments, SUM(t.tot_drug_amt) AS total_drug_amount FROM doctors d JOIN treatments t ON d.doc_id = t.doc_id WHERE t.start_dt >= (CURRENT_DATE - INTERVAL '6 months') GROUP BY d.specialty ORDER BY total_drug_amount DESC NULLS LAST LIMIT 3"}
{"question":"What is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course id?","answer":"SELECT course_tags_count.course_id, CAST(course_tags_count.clear_grading AS FLOAT) \/ NULLIF(course_tags_count.good_feedback, 0) AS ratio FROM course_tags_count ORDER BY course_tags_count.course_id NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"ratio","generation":"SELECT c.course_id, CAST(SUM(CASE WHEN cp.clear_grading = 1 AND cp.good_feedback = 1 THEN 1 ELSE 0 END) AS FLOAT) \/ NULLIF(SUM(CASE WHEN cp.good_feedback = 1 THEN 1 ELSE 0 END), 0) AS ratio FROM public.course c JOIN public.course_prerequisite cp ON c.course_id = cp.pre_course_id GROUP BY c.course_id ORDER BY ratio DESC NULLS LAST"}
{"question":"What is the total number of restaurants serving each type of food?","answer":"SELECT restaurant.food_type, COUNT(DISTINCT restaurant.id) AS total_number_of_restaurants FROM restaurant GROUP BY restaurant.food_type;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT r.food_type, COUNT(r.id) AS total_restaurants FROM public.restaurant r GROUP BY r.food_type ORDER BY total_restaurants DESC NULLS LAST"}
{"question":"Which authors are not part of any organization?","answer":"SELECT DISTINCT {name, aid} FROM author WHERE oid IS NULL","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"instruct","generation":"SELECT a.name FROM public.author a WHERE a.oid IS NULL"}
{"question":"How many publications were published in journals whose names start with the letter \"J\"?","answer":"SELECT count(DISTINCT publication.pid) FROM publication JOIN journal ON publication.jid = journal.jid WHERE journal.name ilike 'J%'","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"table_join","generation":"SELECT COUNT(p.pid) FROM public.publication p JOIN public.journal j ON p.jid = j.jid WHERE j.name ilike 'J%'"}
{"question":"What was the message that came with the tip made exactly 2 months after March 2021?","answer":"SELECT text AS message FROM tip WHERE MONTH ILIKE '%May%' AND YEAR = 2021 LIMIT 1;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"date_functions","generation":"SELECT t.text FROM public.tip t WHERE t.year = 2021 AND t.month = 'May'"}
{"question":"How many flights depart from each airport code, excluding departures with connections?","answer":"SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport LEFT JOIN flight ON airport.airport_code = flight.from_airport AND flight.connections=0 GROUP BY airport.airport_code;SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport JOIN flight ON airport.airport_code = flight.from_airport WHERE flight.connections=0 GROUP BY airport.airport_code;","db_name":"atis","context":"CREATE TABLE public.aircraft (aircraft_code TEXT, aircraft_description TEXT, manufacturer TEXT, basic_type TEXT, engines BIGINT, propulsion TEXT, wide_body TEXT, wing_span BIGINT, length BIGINT, weight BIGINT, capacity BIGINT, pay_load BIGINT, cruising_speed BIGINT, range_miles BIGINT, pressurized TEXT);\nCREATE TABLE public.airline (airline_code TEXT, airline_name TEXT, note TEXT);\nCREATE TABLE public.airport (airport_code TEXT, airport_name TEXT, airport_location TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT, minimum_connect_time BIGINT);\nCREATE TABLE public.airport_service (city_code TEXT, airport_code TEXT, miles_distant BIGINT, direction TEXT, minutes_distant BIGINT);\nCREATE TABLE public.city (city_code TEXT, city_name TEXT, state_code TEXT, country_name TEXT, time_zone_code TEXT);\nCREATE TABLE public.class_of_service (booking_class TEXT DEFAULT ''::TEXT NOT NULL, rank BIGINT, class_description TEXT);\nCREATE TABLE public.code_description (code TEXT DEFAULT ''::TEXT NOT NULL, description TEXT);\nCREATE TABLE public.compartment_class (compartment TEXT, class_type TEXT);\nCREATE TABLE public.days (days_code TEXT, day_name TEXT);\nCREATE TABLE public.dual_carrier (main_airline TEXT, low_flight_number BIGINT, high_flight_number BIGINT, dual_airline TEXT, service_name TEXT);\nCREATE TABLE public.equipment_sequence (aircraft_code_sequence TEXT, aircraft_code TEXT);\nCREATE TABLE public.fare (fare_id BIGINT DEFAULT '0'::BIGINT NOT NULL, from_airport TEXT, to_airport TEXT, fare_basis_code TEXT, fare_airline TEXT, restriction_code TEXT, one_direction_cost BIGINT, round_trip_cost BIGINT, round_trip_required TEXT);\nCREATE TABLE public.fare_basis (fare_basis_code TEXT, booking_class TEXT, class_type TEXT, premium TEXT, economy TEXT, discounted TEXT, night TEXT, season TEXT, basis_days TEXT);\nCREATE TABLE public.flight (flight_id BIGINT DEFAULT '0'::BIGINT NOT NULL, flight_days TEXT, from_airport TEXT, to_airport TEXT, departure_time BIGINT, arrival_time BIGINT, airline_flight TEXT, airline_code TEXT, flight_number TEXT, aircraft_code_sequence TEXT, meal_code TEXT, stops BIGINT, connections BIGINT, dual_carrier TEXT, time_elapsed BIGINT);\nCREATE TABLE public.flight_fare (flight_id BIGINT, fare_id BIGINT);\nCREATE TABLE public.flight_leg (flight_id BIGINT, leg_number BIGINT, leg_flight BIGINT);\nCREATE TABLE public.flight_stop (flight_id BIGINT, stop_number BIGINT, stop_days TEXT, stop_airport TEXT, arrival_time BIGINT, arrival_airline TEXT, arrival_flight_number TEXT, departure_time BIGINT, departure_airline TEXT, departure_flight_number TEXT, stop_time BIGINT);\nCREATE TABLE public.food_service (meal_code TEXT, meal_number BIGINT, compartment TEXT, meal_description TEXT);\nCREATE TABLE public.ground_service (city_code TEXT, airport_code TEXT, transport_type TEXT, ground_fare BIGINT);\nCREATE TABLE public.month (month_number BIGINT, month_name TEXT);\nCREATE TABLE public.restriction (restriction_code TEXT, advance_purchase BIGINT, stopovers TEXT, saturday_stay_required TEXT, minimum_stay BIGINT, maximum_stay BIGINT, application TEXT, no_discounts TEXT);\nCREATE TABLE public.state (state_code TEXT, state_name TEXT, country_name TEXT);\nCREATE TABLE public.time_interval (period TEXT, begin_time BIGINT, end_time BIGINT);\nCREATE TABLE public.time_zone (time_zone_code TEXT, time_zone_name TEXT, hours_from_gmt BIGINT);","query_category":"group_by","generation":"SELECT f.from_airport, COUNT(f.flight_id) AS num_flights FROM flight f WHERE f.connections = 0 GROUP BY f.from_airport ORDER BY num_flights DESC NULLS LAST"}
{"question":"What is the total number of students who have taken a course with a final project or exam?","answer":"SELECT COUNT(DISTINCT student_record.student_id) AS total_students FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.has_final_project = true OR course_offering.has_final_exam = true;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"table_join","generation":"SELECT COUNT(DISTINCT s.student_id) AS total_students FROM student_record s JOIN course_offering co ON s.course_id = co.course_id WHERE co.has_final_project = TRUE OR co.has_final_exam = TRUE"}
{"question":"How many restaurants serve Italian food in each city?","answer":"SELECT restaurant.city_name, COUNT(*) AS number_of_restaurants FROM restaurant WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY restaurant.city_name ORDER BY number_of_restaurants DESC NULLS LAST;","db_name":"restaurants","context":"CREATE TABLE public.geographic (city_name text, county text, region text);\n\nCREATE TABLE public.location (restaurant_id bigint, house_number bigint, street_name text, city_name text);\n\nCREATE TABLE public.restaurant (id bigint, name text, food_type text, city_name text, rating real);","query_category":"group_by","generation":"SELECT r.city_name, COUNT(r.id) AS number_of_restaurants FROM public.restaurant r WHERE r.food_type ilike '%Italian%' GROUP BY r.city_name ORDER BY number_of_restaurants DESC NULLS LAST"}
{"question":"What are the top 2 specialties by number of doctors? Return the specialty and number of doctors.","answer":"SELECT specialty, COUNT(*) AS num_doctors FROM doctors GROUP BY specialty ORDER BY num_doctors DESC LIMIT 2","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_group_order_limit","generation":"SELECT d.specialty, COUNT(d.doc_id) AS num_doctors FROM doctors d GROUP BY d.specialty ORDER BY num_doctors DESC NULLS LAST LIMIT 2"}
{"question":"Which papers have the highest number of authors, ordered by the number of authors in descending order?","answer":"SELECT {paper.paperid, paper.title}, COUNT(DISTINCT writes.authorid) AS num_authors FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY {} ORDER BY num_authors DESC;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT p.title, COUNT(DISTINCT a.authorid) AS num_authors FROM public.paper p JOIN public.writes a ON p.paperid = a.paperid GROUP BY p.title ORDER BY num_authors DESC"}
{"question":"What is the total number of reviews for each category in the state of \"California\"?","answer":"SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id WHERE business.state = 'CA' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;","db_name":"yelp","context":"CREATE TABLE public.business (bid bigint, business_id text, name text, full_address text, city text, latitude text, longitude text, review_count bigint, is_open bigint, state text);\n\nCREATE TABLE public.category (id bigint, business_id text, category_name text);\n\nCREATE TABLE public.checkin (cid bigint, business_id text, count bigint, day text);\n\nCREATE TABLE public.neighbourhood (id bigint, business_id text, neighbourhood_name text);\n\nCREATE TABLE public.review (rid bigint, business_id text, user_id text, rating real, text text, year bigint, month text);\n\nCREATE TABLE public.tip (tip_id bigint, business_id text, text text, user_id text, likes bigint, year bigint, month text);\n\nCREATE TABLE public.users (uid bigint, user_id text, name text);","query_category":"table_join","generation":"SELECT c.category_name, COUNT(r.rid) AS total_reviews FROM public.review r JOIN public.category c ON r.business_id = c.business_id JOIN public.business b ON c.business_id = b.business_id WHERE b.state = 'California' GROUP BY c.category_name ORDER BY total_reviews DESC NULLS LAST"}
{"question":"Return the distinct list of patient IDs, first names and last names that have outcome assessments.","answer":"SELECT DISTINCT p.patient_id, p.first_name, p.last_name FROM outcomes o JOIN treatments t ON o.treatment_id = t.treatment_id JOIN patients p ON t.patient_id = p.patient_id","db_name":"derm_treatment","context":"CREATE TABLE doctors (doc_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), specialty TEXT, year_reg INT, med_school_name VARCHAR(100), loc_city VARCHAR(50), loc_state CHAR(2), loc_zip VARCHAR(10), bd_cert_num VARCHAR(20));\nCREATE TABLE patients (patient_id SERIAL PRIMARY KEY, first_name VARCHAR(50), last_name VARCHAR(50), date_of_birth DATE, date_of_registration DATE, gender VARCHAR(10), email VARCHAR(100), phone VARCHAR(20), addr_street VARCHAR(100), addr_city VARCHAR(50), addr_state CHAR(2), addr_zip VARCHAR(10), ins_type TEXT, ins_policy_num VARCHAR(20), height_cm FLOAT, weight_kg FLOAT);\nCREATE TABLE drugs (drug_id SERIAL PRIMARY KEY, drug_name VARCHAR(100), manufacturer VARCHAR(100), drug_type TEXT, moa TEXT, fda_appr_dt DATE, admin_route TEXT, dos_amt DECIMAL(10,2), dos_unit VARCHAR(20), dos_freq_hrs INT, ndc VARCHAR(20));\nCREATE TABLE diagnoses (diag_id SERIAL PRIMARY KEY, diag_code VARCHAR(10), diag_name VARCHAR(100), diag_desc TEXT);\nCREATE TABLE treatments (treatment_id SERIAL PRIMARY KEY, patient_id INT REFERENCES patients(patient_id), doc_id INT REFERENCES doctors(doc_id), drug_id INT REFERENCES drugs(drug_id), diag_id INT REFERENCES diagnoses(diag_id), start_dt DATE, end_dt DATE, is_placebo BOOLEAN, tot_drug_amt DECIMAL(10,2), drug_unit TEXT);\nCREATE TABLE outcomes (outcome_id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), assess_dt DATE, day7_lesion_cnt INT, day30_lesion_cnt INT, day100_lesion_cnt INT, day7_pasi_score DECIMAL(4,1), day30_pasi_score DECIMAL(4,1), day100_pasi_score DECIMAL(4,1), day7_tewl DECIMAL(5,2), day30_tewl DECIMAL(5,2), day100_tewl DECIMAL(5,2), day7_itch_vas INT, day30_itch_vas INT, day100_itch_vas INT, day7_hfg DECIMAL(4,1), day30_hfg DECIMAL(4,1), day100_hfg DECIMAL(4,1));\nCREATE TABLE adverse_events (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), reported_dt DATE, description TEXT);\nCREATE TABLE concomitant_meds (id SERIAL PRIMARY KEY, treatment_id INT REFERENCES treatments(treatment_id), med_name VARCHAR(100), start_dt TEXT, end_dt TEXT, dose_amt DECIMAL(10,2), dose_unit TEXT, freq_hrs INT);","query_category":"basic_join_distinct","generation":"SELECT DISTINCT p.patient_id, p.first_name, p.last_name FROM patients p JOIN outcomes o ON p.patient_id = o.treatment_id"}
{"question":"How does the ratio of authors to organizations differ by continent?","answer":"SELECT organization.continent, COUNT(DISTINCT author.aid)::float \/ NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM organization LEFT JOIN author ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;WITH author_counts AS (SELECT o.continent, COUNT(DISTINCT a.aid) AS author_count FROM author AS a JOIN organization AS o ON a.oid = o.oid GROUP BY o.continent), organization_counts AS (SELECT o.continent, COUNT(DISTINCT o.oid) AS organization_count FROM organization AS o GROUP BY o.continent) SELECT ac.continent, CAST(ac.author_count AS FLOAT) \/ NULLIF(oc.organization_count, 0) AS author_to_organization_ratio FROM author_counts AS ac JOIN organization_counts AS oc ON ac.continent = oc.continent ORDER BY author_to_organization_ratio DESC;","db_name":"academic","context":"CREATE TABLE public.author (aid BIGINT NOT NULL, homepage TEXT, name TEXT, oid BIGINT);\nCREATE TABLE public.cite (cited BIGINT, citing BIGINT);\nCREATE TABLE public.conference (cid BIGINT NOT NULL, homepage TEXT, name TEXT);\nCREATE TABLE public.domain (did BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.domain_author (aid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_conference (cid BIGINT NOT NULL, did BIGINT NOT NULL);\nCREATE TABLE public.domain_journal (did BIGINT NOT NULL, jid BIGINT NOT NULL);\nCREATE TABLE public.domain_keyword (did BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.domain_publication (did BIGINT NOT NULL, pid BIGINT NOT NULL);\nCREATE TABLE public.journal (homepage TEXT, jid BIGINT NOT NULL, name TEXT);\nCREATE TABLE public.keyword (keyword TEXT, kid BIGINT NOT NULL);\nCREATE TABLE public.organization (continent TEXT, homepage TEXT, name TEXT, oid BIGINT NOT NULL);\nCREATE TABLE public.publication (abstract TEXT, cid BIGINT, citation_num BIGINT, jid BIGINT, pid BIGINT NOT NULL, reference_num BIGINT, title TEXT, year BIGINT);\nCREATE TABLE public.publication_keyword (pid BIGINT NOT NULL, kid BIGINT NOT NULL);\nCREATE TABLE public.writes (aid BIGINT NOT NULL, pid BIGINT NOT NULL);","query_category":"ratio","generation":"SELECT o.continent, COUNT(DISTINCT a.aid)::FLOAT \/ NULLIF(COUNT(DISTINCT o.oid), 0) AS ratio FROM public.author a JOIN public.organization o ON a.oid = o.oid GROUP BY o.continent ORDER BY ratio DESC NULLS LAST"}
{"question":"What is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order?","answer":"SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS total_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY paperkeyphrase.paperid ASC NULLS LAST;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"order_by","generation":"SELECT p.paperid, COUNT(k.keyphraseid) AS total_keyphrases FROM paper p JOIN paperkeyphrase k ON p.paperid = k.paperid GROUP BY p.paperid ORDER BY p.paperid NULLS LAST"}
{"question":"number of transactions by users who joined in the past 70 days","answer":"SELECT COUNT(t.sbTxCustId) AS transaction_count FROM sbTransaction t JOIN sbCustomer c ON t.sbTxCustId = c.sbCustId WHERE c.sbCustJoinDate >= CURRENT_DATE - INTERVAL '70' DAY;","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"date_functions","generation":"SELECT COUNT(DISTINCT sbT.sbTxId) AS number_of_transactions FROM sbCustomer sc JOIN sbTransaction sbT ON sc.sbCustId = sbT.sbTxCustId WHERE sc.sbCustJoinDate >= (CURRENT_DATE - INTERVAL '70 days')"}
{"question":"What is the total number of students who participated actively for each course id, ordered from highest to lowest participants?","answer":"SELECT course_tags_count.course_id, course_tags_count.participation FROM course_tags_count ORDER BY course_tags_count.participation DESC NULLS LAST;","db_name":"advising","context":"CREATE TABLE public.area (course_id BIGINT, area TEXT);\nCREATE TABLE public.comment_instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, student_id BIGINT DEFAULT '0'::BIGINT NOT NULL, score BIGINT, comment_text TEXT);\nCREATE TABLE public.course (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, department TEXT, number TEXT, credits TEXT, advisory_requirement TEXT, enforced_requirement TEXT, description TEXT, num_semesters BIGINT, num_enrolled BIGINT, has_discussion BOOLEAN, has_lab BOOLEAN, has_projects BOOLEAN, has_exams BOOLEAN, num_reviews BIGINT, clarity_score BIGINT, easiness_score BIGINT, helpfulness_score BIGINT);\nCREATE TABLE public.course_offering (offering_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT, semester BIGINT, section_number BIGINT, start_time TIME, end_time TIME, monday TEXT, tuesday TEXT, wednesday TEXT, thursday TEXT, friday TEXT, saturday TEXT, sunday TEXT, has_final_project BOOLEAN, has_final_exam BOOLEAN, textbook TEXT, class_address TEXT, allow_audit TEXT DEFAULT 'false'::TEXT);\nCREATE TABLE public.course_prerequisite (pre_course_id BIGINT NOT NULL, course_id BIGINT NOT NULL);\nCREATE TABLE public.course_tags_count (course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, clear_grading BIGINT DEFAULT '0'::BIGINT, pop_quiz BIGINT DEFAULT '0'::BIGINT, group_projects BIGINT DEFAULT '0'::BIGINT, inspirational BIGINT DEFAULT '0'::BIGINT, long_lectures BIGINT DEFAULT '0'::BIGINT, extra_credit BIGINT DEFAULT '0'::BIGINT, few_tests BIGINT DEFAULT '0'::BIGINT, good_feedback BIGINT DEFAULT '0'::BIGINT, tough_tests BIGINT DEFAULT '0'::BIGINT, heavy_papers BIGINT DEFAULT '0'::BIGINT, cares_for_students BIGINT DEFAULT '0'::BIGINT, heavy_assignments BIGINT DEFAULT '0'::BIGINT, respected BIGINT DEFAULT '0'::BIGINT, participation BIGINT DEFAULT '0'::BIGINT, heavy_reading BIGINT DEFAULT '0'::BIGINT, tough_grader BIGINT DEFAULT '0'::BIGINT, hilarious BIGINT DEFAULT '0'::BIGINT, would_take_again BIGINT DEFAULT '0'::BIGINT, good_lecture BIGINT DEFAULT '0'::BIGINT, no_skip BIGINT DEFAULT '0'::BIGINT);\nCREATE TABLE public.instructor (instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, name TEXT, uniqname TEXT);\nCREATE TABLE public.offering_instructor (offering_instructor_id BIGINT DEFAULT '0'::BIGINT NOT NULL, offering_id BIGINT, instructor_id BIGINT);\nCREATE TABLE public.program (program_id BIGINT NOT NULL, name TEXT, college TEXT, introduction TEXT);\nCREATE TABLE public.program_course (program_id BIGINT DEFAULT '0'::BIGINT NOT NULL, course_id BIGINT DEFAULT '0'::BIGINT NOT NULL, workload BIGINT, category TEXT DEFAULT ''::TEXT NOT NULL);\nCREATE TABLE public.program_requirement (program_id BIGINT NOT NULL, category TEXT NOT NULL, min_credit BIGINT, additional_req TEXT);\nCREATE TABLE public.semester (semester_id BIGINT NOT NULL, semester TEXT, year BIGINT);\nCREATE TABLE public.student (student_id BIGINT NOT NULL, lastname TEXT, firstname TEXT, program_id BIGINT, declare_major TEXT, total_credit BIGINT, total_gpa NUMERIC, entered_as TEXT DEFAULT 'firstyear'::TEXT, admit_term DATE, predicted_graduation_semester DATE, degree TEXT, minor TEXT, internship TEXT);\nCREATE TABLE public.student_record (student_id BIGINT NOT NULL, course_id BIGINT NOT NULL, semester BIGINT NOT NULL, grade TEXT, how TEXT, transfer_source TEXT, earn_credit TEXT DEFAULT 'y'::TEXT NOT NULL, repeat_term TEXT, test_id TEXT, offering_id BIGINT);","query_category":"order_by","generation":"SELECT c.course_id, COUNT(DISTINCT s.student_id) AS total_students FROM public.course c JOIN public.student_record s ON c.course_id = s.course_id WHERE s.how = 'active' GROUP BY c.course_id ORDER BY total_students DESC NULLS LAST"}
{"question":"What is the ratio of the altitude of 'Mount Everest' to the altitude of 'Dhaulagiri'? Match strings exactly","answer":"SELECT (CAST(everest.mountain_altitude AS FLOAT) \/ NULLIF(dhaulagiri.mountain_altitude, 0)) AS altitude_ratio FROM (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Mount Everest') AS everest, (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Dhaulagiri') AS dhaulagiri;","db_name":"geography","context":"CREATE TABLE public.border_info (state_name text, border text);\n\nCREATE TABLE public.city (city_name text, population bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.highlow (state_name text, highest_elevation text, lowest_point text, highest_point text, lowest_elevation text);\n\nCREATE TABLE public.lake (lake_name text, area double precision, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.mountain (mountain_name text, mountain_altitude bigint, country_name text DEFAULT ''::text NOT NULL, state_name text);\n\nCREATE TABLE public.river (river_name text, length bigint, country_name text DEFAULT ''::text NOT NULL, traverse text);\n\nCREATE TABLE public.state (state_name text, population bigint, area double precision, country_name text DEFAULT ''::text NOT NULL, capital text, density double precision);","query_category":"ratio","generation":"SELECT CAST(m.mountain_altitude AS FLOAT) \/ NULLIF(h.highest_elevation, '0') AS ratio FROM mountain m JOIN highlow h ON m.state_name = h.state_name WHERE m.mountain_name = 'Mount Everest' AND h.highest_point = 'Dhaulagiri'"}
{"question":"Return the customer id and the difference between their time from joining to their first transaction. Ignore customers who haven't made any transactions.","answer":"SELECT c.sbCustId, MIN(t.sbTxDateTime) - c.sbCustJoinDate AS DaysFromJoinToFirstTransaction FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId","db_name":"broker_context","context":"CREATE TABLE sbCustomer (sbCustId VARCHAR(20) PRIMARY KEY, sbCustName VARCHAR(100) NOT NULL, sbCustEmail VARCHAR(100) NOT NULL, sbCustPhone VARCHAR(20), sbCustAddress1 VARCHAR(200), sbCustAddress2 VARCHAR(200), sbCustCity VARCHAR(50), sbCustState VARCHAR(20), sbCustCountry VARCHAR(50), sbCustPostalCode VARCHAR(20), sbCustJoinDate DATE NOT NULL, sbCustStatus VARCHAR(20) NOT NULL);\nCREATE TABLE sbTicker (sbTickerId VARCHAR(20) PRIMARY KEY, sbTickerSymbol VARCHAR(10) NOT NULL, sbTickerName VARCHAR(100) NOT NULL, sbTickerType VARCHAR(20) NOT NULL, sbTickerExchange VARCHAR(50) NOT NULL, sbTickerCurrency VARCHAR(10) NOT NULL, sbTickerDb2x VARCHAR(20), sbTickerIsActive BOOLEAN NOT NULL);\nCREATE TABLE sbDailyPrice (sbDpTickerId VARCHAR(20) NOT NULL, sbDpDate DATE NOT NULL, sbDpOpen NUMERIC(10,2) NOT NULL, sbDpHigh NUMERIC(10,2) NOT NULL, sbDpLow NUMERIC(10,2) NOT NULL, sbDpClose NUMERIC(10,2) NOT NULL, sbDpVolume BIGINT NOT NULL, sbDpEpochMs BIGINT NOT NULL, sbDpSource VARCHAR(50));\nCREATE TABLE sbTransaction (sbTxId VARCHAR(50) PRIMARY KEY, sbTxCustId VARCHAR(20) NOT NULL, sbTxTickerId VARCHAR(20) NOT NULL, sbTxDateTime TIMESTAMP NOT NULL, sbTxType VARCHAR(20) NOT NULL, sbTxShares NUMERIC(10,2) NOT NULL, sbTxPrice NUMERIC(10,2) NOT NULL, sbTxAmount NUMERIC(10,2) NOT NULL, sbTxCcy VARCHAR(10), sbTxTax NUMERIC(10,2) NOT NULL, sbTxCommission NUMERIC(10,2) NOT NULL, sbTxKpx VARCHAR(10), sbTxSettlementDateStr VARCHAR(25), sbTxStatus VARCHAR(10) NOT NULL);","query_category":"date_functions","generation":"SELECT c.sbCustId, c.sbCustJoinDate, MIN(t.sbTxDateTime) AS earliest_transaction_date, (MIN(t.sbTxDateTime) - c.sbCustJoinDate) AS time_difference FROM sbCustomer c JOIN sbTransaction t ON c.sbCustId = t.sbTxCustId GROUP BY c.sbCustId, c.sbCustJoinDate HAVING COUNT(t.sbTxId) > 0 ORDER BY time_difference NULLS LAST"}
{"question":"Return the name and phone number of the salesperson with the shortest time from being hired to getting fired. Return the number of days he\/she was employed for.","answer":"SELECT s.first_name, s.last_name, s.phone, s.termination_date - s.hire_date AS days_employed FROM salespersons s ORDER BY days_employed ASC LIMIT 1;","db_name":"car_dealership","context":"CREATE TABLE cars (id SERIAL PRIMARY KEY, make TEXT NOT NULL, model TEXT NOT NULL, year INTEGER NOT NULL, color TEXT NOT NULL, vin_number VARCHAR(17) NOT NULL UNIQUE, engine_type TEXT NOT NULL, transmission TEXT NOT NULL, cost NUMERIC(10, 2) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE salespersons (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, hire_date DATE NOT NULL, termination_date DATE, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE customers (id SERIAL PRIMARY KEY, first_name TEXT NOT NULL, last_name TEXT NOT NULL, email VARCHAR(255) NOT NULL UNIQUE, phone VARCHAR(20) NOT NULL, address TEXT NOT NULL, city TEXT NOT NULL, state TEXT NOT NULL, zip_code VARCHAR(10) NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE sales (id SERIAL PRIMARY KEY, car_id INTEGER NOT NULL REFERENCES cars(id), salesperson_id INTEGER NOT NULL REFERENCES salespersons(id), customer_id INTEGER NOT NULL REFERENCES customers(id), sale_price NUMERIC(10, 2) NOT NULL, sale_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE inventory_snapshots (id SERIAL PRIMARY KEY, snapshot_date DATE NOT NULL, car_id INTEGER NOT NULL REFERENCES cars(id), is_in_inventory BOOLEAN NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_received (id SERIAL PRIMARY KEY, sale_id INTEGER NOT NULL REFERENCES sales(id), payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());\nCREATE TABLE payments_made (id SERIAL PRIMARY KEY, vendor_name TEXT NOT NULL, payment_date DATE NOT NULL, payment_amount NUMERIC(10, 2) NOT NULL, payment_method TEXT NOT NULL, invoice_number VARCHAR(50) NOT NULL, invoice_date DATE NOT NULL, due_date DATE NOT NULL, crtd_ts TIMESTAMP NOT NULL DEFAULT NOW());","query_category":"date_functions","generation":"SELECT s.first_name, s.last_name, (s.termination_date - s.hire_date) AS days_employed FROM salespersons s ORDER BY (s.termination_date - s.hire_date) ASC LIMIT 1"}
{"question":"What is the total number of papers published in each year?","answer":"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year;","db_name":"scholar","context":"CREATE TABLE public.author (authorid bigint NOT NULL, authorname text);\n\nCREATE TABLE public.cite (citingpaperid bigint NOT NULL, citedpaperid bigint NOT NULL);\n\nCREATE TABLE public.dataset (datasetid bigint NOT NULL, datasetname text);\n\nCREATE TABLE public.field (fieldid bigint);\n\nCREATE TABLE public.journal (journalid bigint NOT NULL, journalname text);\n\nCREATE TABLE public.keyphrase (keyphraseid bigint NOT NULL, keyphrasename text);\n\nCREATE TABLE public.paper (paperid bigint NOT NULL, title text, venueid bigint, year bigint, numciting bigint, numcitedby bigint, journalid bigint);\n\nCREATE TABLE public.paperdataset (paperid bigint, datasetid bigint);\n\nCREATE TABLE public.paperfield (fieldid bigint, paperid bigint);\n\nCREATE TABLE public.paperkeyphrase (paperid bigint, keyphraseid bigint);\n\nCREATE TABLE public.venue (venueid bigint NOT NULL, venuename text);\n\nCREATE TABLE public.writes (paperid bigint, authorid bigint);","query_category":"group_by","generation":"SELECT p.year, COUNT(p.paperid) AS total_papers FROM public.paper p GROUP BY p.year ORDER BY p.year"}
